!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/js/",r(r.s=290)}([function(e,t,r){"use strict";let n;"undefined"==typeof browser&&"undefined"!=typeof chrome?(n=new ChromePromise,n.alarms=chrome.alarms,n.browserAction=chrome.browserAction,n.i18n=chrome.i18n):n=browser,t.a=n},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c}));r(16);var n=r(14),o=r(2);const i=r(35),a=["data:","javascript:","about:","chrome:"];class s{constructor({id:e,parentId:t,url:r,title:n}){if(this.type="bookmark",this.id=e,this.parentId=t,this.title=n,a.some(e=>0===r.indexOf(e)))this.url=r;else try{let e=new URL(r);this.url=e.href}catch(e){o.a.log("Failed to normalize",r),this.url=r}}canMergeWith(e){return this.type===e.type&&this.url===e.url}async hash(){return this.hashValue||(this.hashValue=await n.a.sha256(JSON.stringify({title:this.title,url:this.url}))),this.hashValue}clone(){return new s(this)}createIndex(){return{[this.id]:this}}inspect(e){return Array(e).fill("  ").join("")+`- #${this.id}[${this.title}](${this.url}) parentId: ${this.parentId}`}visitCreate(e,...t){return e.createBookmark(...t)}visitUpdate(e,...t){return e.updateBookmark(...t)}visitRemove(e,...t){return e.removeBookmark(...t)}static hydrate(e){return new s(e)}}class c{constructor({id:e,parentId:t,title:r,children:n,hashValue:o}){this.type="folder",this.id=e,this.parentId=t,this.title=r,this.children=n||[],this.hashValue=o||{}}findFolder(e){return this.id===e?this:this.index?this.index.folders[e]:this.children.filter(e=>e instanceof c).map(t=>t.findFolder(e)).filter(e=>!!e)[0]}findBookmark(e){if(this.index)return this.index.bookmarks[e];const t=this.children.filter(e=>e instanceof s).filter(t=>String(t.id)===String(e))[0];return t||this.children.filter(e=>e instanceof c).map(t=>t.findBookmark(e)).filter(e=>!!e)[0]}findItem(e,t){return"folder"===e?this.findFolder(t):this.findBookmark(t)}async traverse(e){await i.each(this.children,async t=>{await e(t,this),"folder"===t.type&&await t.traverse(e)})}canMergeWith(e){return this.type===e.type&&this.title===e.title}async hash(e){if(this.hashValue&&this.hashValue[e])return this.hashValue[e];let t=this.children.slice();return e||t.sort((e,t)=>e.title<t.title?-1:t.title<e.title?1:0),this.hashValue||(this.hashValue={}),this.hashValue[e]=await n.a.sha256(JSON.stringify({title:this.title,children:await i.map(this.children,t=>t.hash(e),1)})),this.hashValue[e]}clone(e){return new c({...this,...!e&&{hashValue:{}},children:this.children.map(t=>t.clone(e))})}count(){return this.index||this.createIndex(),Object.keys(this.index.bookmarks).length}countFolders(){return this.index||this.createIndex(),Object.keys(this.index.folders).length}createIndex(){return this.index={folders:{[this.id]:this},bookmarks:Object.assign({},this.children.filter(e=>e instanceof s).reduce((e,t)=>(e[t.id]=t,e),{}))},this.children.filter(e=>e instanceof c).map(e=>e.createIndex()).forEach(e=>{Object.assign(this.index.folders,e.folders),Object.assign(this.index.bookmarks,e.bookmarks)}),this.index}inspect(e){return Array(e).fill("  ").join("")+`+ #${this.id}[${this.title}] parentId: ${this.parentId}, hash: ${this.hashValue[!0]||this.hashValue[!1]}\n`+this.children.map(t=>t&&t.inspect?t.inspect(e+1):String(t)).join("\n")}visitCreate(e,...t){return e.createFolder(...t)}visitUpdate(e,...t){return e.updateFolder(...t)}visitRemove(e,...t){return e.removeFolder(...t)}static hydrate(e){return new c({...e,children:e.children?e.children.map(e=>e.url?s.hydrate(e):c.hydrate(e)):null})}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(20),o=r(57),i=r(45),a=r.n(i);const s=r(42);class c{static log(){const e=[(new Date).toISOString(),...arguments];console.log.apply(console,e),this.messages.push(a.a.format.apply(a.a,e)),this.persistThrottled()}static async persist(){await n.a.changeEntry("log",e=>e.concat(this.messages).slice(-1e3),[])}static async getLogs(){return n.a.getEntry("log")}static async downloadLogs(){const e=await this.getLogs();console.log(e);let t=new Blob([e.join("\n")],{type:"text/plain",endings:"native"});this.download("floccus-"+s.version+"-"+(new Date).toISOString().slice(0,10)+".log",t)}static download(e,t){const r=document.createElement("a");let n=URL.createObjectURL(t);r.setAttribute("href",n),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.click(),URL.revokeObjectURL(n),document.body.removeChild(r)}}c.messages=[],c.persistThrottled=Object(o.throttle)(500,!1,()=>c.persist())},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));r(16);var n=r(20),o=r(39);class i extends o.a{static register(e,t){this.registry||(this.registry={}),this.registry[e]=t}static factory(e){const t=this.registry[e.type];let r;if(!t)throw new Error("Unknown account type");return r=new t(e),r}constructor(){if(super(),this.constructor===i)throw new Error("Cannot instantiate abstract class")}setAccountData(e){throw new Error("Not implemented")}getAccountData(){throw new Error("Not implemented")}getLabel(){throw new Error("Not implemented")}static getDefaultValues(){throw new Error("Not implemented")}acceptsBookmark(e){return!0}async onSyncStart(){}async onSyncComplete(){}async onSyncFail(){}}class a{serialize(e){throw new Error("Not implemented")}deserialize(e){throw new Error("Not implemented")}}var s=r(1);var c=new class extends a{serialize(e){return this._serializeFolder(e,"")}_serializeFolder(e,t){return e.children.map(e=>{if(e instanceof s.a)return t+"<DT>"+`<A HREF="${e.url}" TAGS="">${e.title}</A>`;if(e instanceof s.b){const r=t+"  ";return`${t}<DT><h3>${e.title}</h3>\n${t}<DL><p>${this._serializeFolder(e,r)}</p></DL>`}}).join("\n")}},u=r(2),l=r(19),f=r(17),h=r.n(f),d=r(0);const p=r(35),v=r(38),g=r(31),m=r(40);var y=r(12);const b=r(35),w=r(38),_=r(31),k=r(40);class I extends i{constructor(e){super(),this.server=e,this.fetchQueue=new _({concurrency:12}),this.bookmarkLock=new h.a}static getDefaultValues(){return{type:"nextcloud",url:"https://example.org",username:"bob",password:"s3cret",serverRoot:""}}setData(e){this.server={...e}}getData(){return{...this.server}}getLabel(){let e=this.getData();return e.username+"@"+w.parse(e.url).hostname}acceptsBookmark(e){return~["https:","http:","ftp:"].indexOf(w.parse(e.url).protocol)}normalizeServerURL(e){let t=w.parse(e),r=t.pathname.indexOf("index.php");return w.format({protocol:t.protocol,auth:t.auth,host:t.host,port:t.port,pathname:t.pathname.substr(0,~r?r:void 0)+(~r||"/"===t.pathname[t.pathname.length-1]?"":"/")})}async getBookmarksList(){if(this.list)return this.list;u.a.log("Fetching bookmarks");let e,t=0,r=[];do{if(e=await this.sendRequest("GET",`index.php/apps/bookmarks/public/rest/v2/bookmark?page=${t}&limit=300`),!Array.isArray(e.data))throw new Error(d.a.i18n.getMessage("Error015"));r=r.concat(e.data),t++}while(300===e.data.length);let n=r.reduce((e,t)=>{let r=new s.a({id:t.id,url:t.url,title:t.title});return this.getPathsFromServerMark(t).forEach(t=>{if(this.server.serverRoot){if(0!==t.indexOf(this.server.serverRoot))return;t=t.substr(this.server.serverRoot.length)}let n=r.clone();n.parentId=t,n.id+=";"+t,e.push(n)}),e},[]);return u.a.log("Received bookmarks from server",n),this.list=n,this.list.raw=e.data,n}async getBookmarksTree(){this.list=null;let e=await this.getBookmarksList();e.sort((e,t)=>e<t?-1:e>t?1:0);let t=new s.b({id:""});return e.forEach(e=>{let r=y.a.pathToArray(e.parentId),n=t;r.forEach((e,t)=>{let o;0!==t&&(o=n.children.filter(e=>e instanceof s.b).filter(t=>t.title===e)[0],o||(o=new s.b({parentId:n.id,id:y.a.arrayToPath(r.slice(0,t+1)),title:e}),n.children.push(o)),n=o)}),n.children.push(e)}),this.tree=t,t.clone()}async createFolder(e,t){u.a.log("(nextcloud)CREATEFOLDER",{parentId:e,title:t},"(noop)");let r=y.a.arrayToPath(y.a.pathToArray(e).concat([t])),n=new s.b({title:t,parentId:e,id:r}),o=this.tree.findFolder(e);if(!o)throw new Error(d.a.i18n.getMessage("Error001"));return o.children.push(n),this.tree.createIndex(),r}async updateFolder(e,t){u.a.log("(nextcloud)UPDATEFOLDER",{id:e,title:t});let r=this.tree.findFolder(e);if(!r)throw new Error(d.a.i18n.getMessage("Error006"));r.title=t;let n=y.a.arrayToPath(y.a.pathToArray(r.parentId).concat([t]));r.id=n,await b.each(r.children,async e=>{e instanceof s.b?await this.moveFolder(e.id,n):(e.parentId=n,await this.updateBookmark(e))},1),this.tree.createIndex()}async moveFolder(e,t){u.a.log("(nextcloud)MOVEFOLDER",{id:e,parentId:t});let r=this.tree.findFolder(e);if(!r)throw new Error(d.a.i18n.getMessage("Error007"));let n=this.tree.findFolder(r.parentId);if(!n)throw new Error(d.a.i18n.getMessage("Error008"));n.children.splice(n.children.indexOf(r),1);let o=this.tree.findFolder(t);if(!o)throw new Error(d.a.i18n.getMessage("Error009"));o.children.push(r),r.parentId=t;let i=y.a.arrayToPath(y.a.pathToArray(t).concat([r.title]));r.id=i,await b.each(r.children,async e=>{e instanceof s.b?await this.moveFolder(e.id,i):(e.parentId=i,await this.updateBookmark(e))},1),this.tree.createIndex()}async removeFolder(e){u.a.log("(nextcloud)REMOVEFOLDER",e);let t=this.tree.findFolder(e);if(!t)return;await b.each(t.children,async e=>{e instanceof s.b?await this.removeFolder(e.id):await this.removeBookmark(e.id)},1);let r=this.tree.findFolder(t.parentId);if(!r)throw new Error(d.a.i18n.getMessage("Error014"));r.children.splice(r.children.indexOf(t),1),this.tree.createIndex()}async _getBookmark(e){u.a.log("Fetching single bookmark");let t=(await this.sendRequest("GET","index.php/apps/bookmarks/public/rest/v2/bookmark/"+e)).item;return{bookmarks:this.getPathsFromServerMark(t).map(e=>{let r=new s.a({id:t.id+";"+e,url:t.url,title:t.title,parentId:e});return r.tags=I.filterPathTagsFromTags(t.tags),r}),tags:I.filterPathTagsFromTags(t.tags)}}async getExistingBookmark(e){u.a.log("Fetching bookmarks to find existing bookmark");const t=await this.getBookmarksList();let r=k.find(t.raw,t=>t.url===e);if(r)return r.id}async createBookmark(e){return u.a.log("(nextcloud)CREATE",e),this.bookmarkLock.acquire(e.url,async()=>{let t=await this.getExistingBookmark(e.url);if(t)e.id=t+";"+e.parentId,await this.updateBookmark(e);else{let t=new FormData;t.append("url",e.url),t.append("title",e.title);const r=this.server.serverRoot?this.server.serverRoot+e.parentId:e.parentId;t.append("item[tags][]",I.convertPathToTag(r));const n=await this.sendRequest("POST","index.php/apps/bookmarks/public/rest/v2/bookmark",t);e.id=n.item.id+";"+e.parentId,this.list.raw.push({id:n.item.id,url:e.url})}return this.list.push(e),e.id})}async updateBookmark(e){u.a.log("(nextcloud)UPDATE",e);const t=e.id.split(";")[0];return this.bookmarkLock.acquire(t,async()=>{let{bookmarks:r,tags:n}=await this._getBookmark(t),o=new URLSearchParams;o.append("url",e.url),o.append("title",e.title);const i=this.server.serverRoot?this.server.serverRoot+e.parentId:e.parentId;let a=e.id.split(";")[1];this.server.serverRoot&&(a=this.server.serverRoot+a),console.log(r,n,"-",a);let s=r.map(e=>e.parentId).filter(e=>e!==a).map(e=>I.convertPathToTag(e)).concat([I.convertPathToTag(i)]).concat(n);return console.log("newTags",s),s.forEach(e=>o.append("item[tags][]",e)),await this.sendRequest("PUT","index.php/apps/bookmarks/public/rest/v2/bookmark/"+t,o),e.id.split(";")[0]+";"+e.parentId})}async removeBookmark(e){u.a.log("(nextcloud)REMOVE",{id:e});const t=e.split(";")[0];return this.bookmarkLock.acquire(t,async()=>{let{bookmarks:r,tags:n}=await this._getBookmark(t);if(1!==r.length){let o=new URLSearchParams;o.append("url",r[0].url),o.append("title",r[0].title);let i=e.split(";")[1];this.server.serverRoot&&(i=this.server.serverRoot+i),r.map(e=>e.parentId).filter(e=>e!==i).map(e=>I.convertPathToTag(e)).concat(n).forEach(e=>o.append("item[tags][]",e)),console.log(r,n,"-",i),await this.sendRequest("PUT","index.php/apps/bookmarks/public/rest/v2/bookmark/"+t,o)}else{await this.sendRequest("DELETE","index.php/apps/bookmarks/public/rest/v2/bookmark/"+t);const e=await this.getBookmarksList();let r=k.findIndex(e.raw,e=>e.id===t);e.raw.splice(r,1)}const o=await this.getBookmarksList();let i=k.findIndex(o,t=>t.id===e);o.splice(i,1)})}async sendRequest(e,t,r){const n=this.normalizeServerURL(this.server.url)+t;let o,i,a=l.Base64.encode(this.server.username+":"+this.server.password);try{o=await this.fetchQueue.add(()=>Promise.race([fetch(n,{method:e,credentials:"omit",headers:{Authorization:"Basic "+a},body:r}),new Promise((e,t)=>setTimeout(()=>{const e=new Error(d.a.i18n.getMessage("Error016"));e.pass=!0,t(e)},6e4))]))}catch(e){if(e.pass)throw e;throw new Error(d.a.i18n.getMessage("Error017"))}if(401===o.status)throw new Error(d.a.i18n.getMessage("Error018"));if(200!==o.status)throw new Error(d.a.i18n.getMessage("Error019",[o.status,e]));try{i=await o.json()}catch(e){throw new Error(d.a.i18n.getMessage("Error020")+"\n"+e.message)}if("success"!==i.status)throw new Error("Nextcloud API error: \n"+JSON.stringify(i));return i}getPathsFromServerMark(e){return I.getPathTagsFromTags(e.tags).map(e=>I.convertTagToPath(e))}static filterPathTagsFromTags(e){return(e||[]).filter(e=>0!==e.indexOf("floccus:"))}static getPathTagsFromTags(e){return(e||[]).filter(e=>0===e.indexOf("floccus:"))}static convertPathToTag(e){return"floccus:"+e.replace(/[/]/g,">").replace(/%2C/g,"%252C").replace(/,/g,"%2C")}static convertTagToPath(e){return e.substr("floccus:".length).replace(/>/g,"/").replace(/%2C/g,",").replace(/%252C/g,"%2C")}}const E=r(38);class T extends i{constructor(e){super(),this.highestId=0,this.bookmarksCache=new s.b({id:0,title:"root"})}getLabel(){let e=this.getData();return e.username+"@"+E.parse(e.url).hostname}async getBookmarksTree(){return this.bookmarksCache.clone()}acceptsBookmark(e){return"data:"!==e.url&&~["https:","http:","ftp:","data:","javascript:"].indexOf(E.parse(e.url).protocol)}async createBookmark(e){u.a.log("CREATE",e),e.id=++this.highestId;const t=this.bookmarksCache.findFolder(e.parentId);if(!t)throw new Error(d.a.i18n.getMessage("Error001"));return t.children.push(e),this.bookmarksCache.createIndex(),e.id}async updateBookmark(e){u.a.log("UPDATE",e);const t=this.bookmarksCache.findBookmark(e.id);if(!t)throw new Error(d.a.i18n.getMessage("Error002"));if(t.url=e.url,t.title=e.title,t.parentId!==e.parentId){const r=this.bookmarksCache.findFolder(t.parentId);if(!r)throw new Error(d.a.i18n.getMessage("Error003"));const n=this.bookmarksCache.findFolder(e.parentId);if(!n)throw new Error(d.a.i18n.getMessage("Error004"));r.children.splice(r.children.indexOf(t),1),n.children.push(t),t.parentId=e.parentId,this.bookmarksCache.createIndex()}}async removeBookmark(e){u.a.log("REMOVE",{id:e});const t=this.bookmarksCache.findBookmark(e);if(!t)return;const r=this.bookmarksCache.findFolder(t.parentId);r&&(r.children.splice(r.children.indexOf(t),1),this.bookmarksCache.createIndex())}async createFolder(e,t){u.a.log("CREATEFOLDER",{parentId:e,title:t});const r=new s.b({parentId:e,title:t});r.id=++this.highestId;const n=this.bookmarksCache.findFolder(e);if(!n)throw new Error(d.a.i18n.getMessage("Error005"));return n.children.push(r),this.bookmarksCache.createIndex(),r.id}async updateFolder(e,t){u.a.log("UPDATEFOLDER",{id:e,title:t});const r=this.bookmarksCache.findFolder(e);if(!r)throw new Error(d.a.i18n.getMessage("Error006"));r.title=t}async moveFolder(e,t){u.a.log("MOVEFOLDER",{id:e,newParentId:t});const r=this.bookmarksCache.findFolder(e);if(!r)throw new Error(d.a.i18n.getMessage("Error007"));const n=this.bookmarksCache.findFolder(r.parentId);if(!n)throw new Error(d.a.i18n.getMessage("Error008"));const o=this.bookmarksCache.findFolder(t);if(!o)throw new Error(d.a.i18n.getMessage("Error009"));n.children.splice(n.children.indexOf(r),1),o.children.push(r),r.parentId=t,this.bookmarksCache.createIndex()}async orderFolder(e,t){u.a.log("ORDERFOLDER",{id:e,order:t});let r=this.bookmarksCache.findFolder(e);if(!r)throw new Error(d.a.i18n.getMessage("Error010"));if(t.forEach(e=>{let t;if(t="folder"===e.type?r.findFolder(e.id):r.findBookmark(e.id),!t||t.parentId!==r.id)throw new Error(d.a.i18n.getMessage("Error011",JSON.stringify(e)))}),t.length!==r.children.length)throw new Error(d.a.i18n.getMessage("Error012"));const n=[];t.forEach(e=>{let t;t="folder"===e.type?r.findFolder(e.id):r.findBookmark(e.id),n.push(t)}),r.children=n}async removeFolder(e){u.a.log("REMOVEFOLDER",{id:e});const t=this.bookmarksCache.findFolder(e);if(!t)throw new Error(d.a.i18n.getMessage("Error013"));const r=this.bookmarksCache.findFolder(t.parentId);if(!r)throw new Error(d.a.i18n.getMessage("Error014"));r.children.splice(r.children.indexOf(t),1),this.bookmarksCache.createIndex()}async bulkImportFolder(e,t){u.a.log("BULKIMPORT",{id:e,folder:t});const r=this.bookmarksCache.findFolder(e);if(!r)throw new Error(d.a.i18n.getMessage("Error005"));const n=t.clone();return n.id=e,await n.traverse(async(e,t)=>{e.id=++this.highestId,e.parentId=t.id}),r.children=n.children,this.bookmarksCache.createIndex(),n}setData(e){this.server={...e}}getData(){return{...this.server}}}var x=new class extends a{serialize(e){return this._serializeFolder(e,"")}deserialize(e){const t=(new window.DOMParser).parseFromString(e,"application/xml"),r=t.getElementsByTagName("xbel");if(!r.length)throw new Error("Parse Error: "+(new XMLSerializer).serializeToString(t));const n=new s.b({id:0,title:"root"});return this._parseFolder(r[0],n),n}_parseFolder(e,t){e.childNodes.forEach(e=>{let r;if(e.tagName&&"bookmark"===e.tagName)r=new s.a({id:parseInt(e.id),parentId:t.id,url:e.getAttribute("href"),title:e.firstElementChild.textContent});else{if(!e.tagName||"folder"!==e.tagName)return;r=new s.b({id:parseInt(e.getAttribute("id")),title:e.firstElementChild.textContent,parentId:t.id}),this._parseFolder(e,r)}t.children.push(r)})}_serializeFolder(e,t){const r=(new DOMParser).parseFromString("<xml></xml>","application/xml");return e.children.map(e=>{if(e instanceof s.a){const t=r.createElement("bookmark");t.setAttribute("href",e.url),t.setAttribute("id",e.id);const n=r.createElement("title");return n.textContent=e.title,t.appendChild(n),(new XMLSerializer).serializeToString(t,"application/xml")}if(e instanceof s.b){const n=r.createElement("folder");"id"in e&&n.setAttribute("id",e.id);const o=r.createElement("title");return o.textContent=e.title,n.appendChild(o),n.innerHTML+=this._serializeFolder(e,t+"    "),(new XMLSerializer).serializeToString(n,"application/xml")}}).join("\r\n"+t)}};const S=r(38);var O=r(15),C=r(28);class R extends C.a{async _syncTree({localItem:e,cacheItem:t,serverItem:r,localOrder:n,serverOrder:o}){if(this.canceled)throw new Error("Sync cancelled");u.a.log("COMPARE",{localItem:e,cacheItem:t,serverItem:r});let i=this.mappings.getSnapshot(),a=t||e||r;if(!e&&!t&&r)return a.visitCreate(this,{mapping:i.ServerToLocal,toTree:this.localTreeRoot,toResource:this.localTree,toOrder:n,item:r});if(e&&!t&&!r)return a.visitRemove(this,{reverseMapping:i.LocalToServer,fromTree:this.serverTreeRoot,toTree:this.localTreeRoot,toResource:this.localTree,toOrder:n,item:e});if(e&&t&&r||e&&!t&&r)await a.visitUpdate(this,e,t,r);else{if(!e&&t&&r)return a.visitCreate(this,{mapping:i.ServerToLocal,toTree:this.localTreeRoot,toResource:this.localTree,toOrder:n,item:r});if(e&&t&&!r)return a.visitRemove(this,{reverseMapping:i.LocalToServer,fromTree:this.serverTreeRoot,toTree:this.localTreeRoot,toResource:this.localTree,toOrder:n,item:e});e||!t||r||(t instanceof s.a?await this.mappings.removeBookmark({localId:t.id}):await this.mappings.removeFolder({localId:t.id}))}}async syncFolderProperties(e,t,r){const{changed:n}=await this.folderHasChanged(e,t,r);if(e!==this.localTreeRoot&&n){const t=this.mappings.getSnapshot();await this.updateFolderProperties({mapping:t.ServerToLocal,fromFolder:r,toFolder:e,toResource:this.localTree})}}async syncChildOrder({localItem:e,cacheItem:t,serverItem:r,localOrder:n,serverOrder:o}){if(this.preserveOrder&&o.length>1){const t=this.mappings.getSnapshot();await this.localTree.orderFolder(e.id,o.map(e=>({id:t.ServerToLocal[e.type+"s"][e.id],type:e.type})))}}async updateBookmark(e,t,r){const{changed:n}=await this.bookmarkHasChanged(e,t,r);await this.mappings.addBookmark({localId:e.id,remoteId:r.id}),this.done++,n?(await this.localTree.updateBookmark(new s.a({id:e.id,parentId:this.mappings.folders.ServerToLocal[r.parentId],title:r.title,url:r.url})),await this.mappings.addBookmark({localId:e.id,remoteId:r.id})):u.a.log("Bookmark unchanged")}}class A extends C.a{async _syncTree({localItem:e,cacheItem:t,serverItem:r,localOrder:n,serverOrder:o}){if(this.canceled)throw new Error("Sync cancelled");u.a.log("COMPARE",{localItem:e,cacheItem:t,serverItem:r});let i=this.mappings.getSnapshot(),a=e||r||t;if(!e&&!t&&r)return a.visitRemove(this,{reverseMapping:i.ServerToLocal,fromTree:this.localTreeRoot,toTree:this.serverTreeRoot,toResource:this.server,toOrder:o,item:r});if(e&&!t&&!r)return a.visitCreate(this,{mapping:i.LocalToServer,toTree:this.serverTreeRoot,toResource:this.server,toOrder:o,item:e});if(e&&t&&r||e&&!t&&r)await a.visitUpdate(this,e,t,r);else{if(!e&&t&&r)return a.visitRemove(this,{reverseMapping:i.ServerToLocal,fromTree:this.localTreeRoot,toTree:this.serverTreeRoot,toResource:this.server,toOrder:o,item:r});if(e&&t&&!r)return a.visitCreate(this,{mapping:i.LocalToServer,toTree:this.serverTreeRoot,toResource:this.server,toOrder:o,item:e});e||!t||r||(t instanceof s.a?await this.mappings.removeBookmark({localId:t.id}):await this.mappings.removeFolder({localId:t.id}))}}async syncFolderProperties(e,t,r){const{changed:n}=await this.folderHasChanged(e,t,r);if(e!==this.localTreeRoot&&n){const t=this.mappings.getSnapshot();await this.updateFolderProperties({mapping:t.LocalToServer,fromFolder:e,toFolder:r,toResource:this.server})}}async syncChildOrder({localItem:e,cacheItem:t,serverItem:r,localOrder:n,remoteOrder:o}){if(this.preserveOrder&&n.length>1){const e=this.mappings.getSnapshot();await this.server.orderFolder(r.id,n.map(t=>({id:e.LocalToServer[t.type+"s"][t.id],type:t.type})))}}async updateBookmark(e,t,r){const{changed:n}=await this.bookmarkHasChanged(e,t,r);await this.mappings.addBookmark({localId:e.id,remoteId:r.id}),this.done++,n?(await this.server.updateBookmark(new s.a({id:r.id,parentId:this.mappings.getSnapshot().LocalToServer.folders[e.parentId],title:e.title,url:e.url})),await this.mappings.addBookmark({localId:e.id,remoteId:r.id})):u.a.log("Bookmark unchanged")}}i.register("nextcloud",I),i.register("nextcloud-legacy",I),i.register("nextcloud-folders",class extends i{constructor(e){super(),this.server=e,this.fetchQueue=new g({concurrency:12}),this.bookmarkLock=new h.a,this.hasFeatureHashing=!1,this.hasFeatureExistanceCheck=!1}static getDefaultValues(){return{type:"nextcloud-folders",url:"https://example.org",username:"bob",password:"s3cret",serverRoot:""}}setData(e){this.server={...e}}getData(){return{...this.server}}getLabel(){let e=this.getData();return e.username+"@"+v.parse(e.url).hostname}acceptsBookmark(e){return~["https:","http:","ftp:"].indexOf(v.parse(e.url).protocol)}normalizeServerURL(e){let t=v.parse(e),r=t.pathname.indexOf("index.php");return v.format({protocol:t.protocol,auth:t.auth,host:t.host,port:t.port,pathname:t.pathname.substr(0,~r?r:void 0)+(~r||"/"===t.pathname[t.pathname.length-1]?"":"/")})}async getBookmarksList(){if(this.list)return this.list;u.a.log("Fetching bookmarks");let e,t=0,r=[];do{if(e=await this.sendRequest("GET",`index.php/apps/bookmarks/public/rest/v2/bookmark?page=${t}&limit=300`),!Array.isArray(e.data))throw new Error(d.a.i18n.getMessage("Error015"));r=r.concat(e.data),t++}while(300===e.data.length);let n=m.flatten(r.map(e=>{let t=new s.a({id:e.id,url:e.url,title:e.title});return e.folders.map(e=>{let r=t.clone();return r.parentId=e,r})}));return u.a.log("Received bookmarks from server",n),this.list=n,n}async getBookmarksTree(e){this.list=null;const t=await this.sendRequest("GET","index.php/apps/bookmarks/public/rest/v2/folder/-1/hash",null,null,!0);let r;try{r=await t.json()}catch(e){}return!e&&(200===t.status&&r&&"success"===r.status||504===t.status)?this.getSparseBookmarksTree():(this.hasFeatureHashing=!1,this.getCompleteBookmarksTree())}async _getChildOrder(e,t){const r=await this.sendRequest("GET",`index.php/apps/bookmarks/public/rest/v2/folder/${e}/childorder`+(t?"?layers="+t:""));if(!Array.isArray(r.data))throw new Error(d.a.i18n.getMessage("Error015"));return r.data}async _getChildFolders(e,t=0){const r=await this.sendRequest("GET",`index.php/apps/bookmarks/public/rest/v2/folder?root=${e}&layers=${t}`);if(!Array.isArray(r.data))throw new Error(d.a.i18n.getMessage("Error015"));return r.data}async _findServerRoot(e){let t=new s.b({id:"-1"});return await p.each(this.server.serverRoot.split("/").slice(1),async r=>{let n=m.find(e,e=>e.title===r);if(!n){let e=JSON.stringify({parent_folder:t.id,title:r});const o=await this.sendRequest("POST","index.php/apps/bookmarks/public/rest/v2/folder","application/json",e);if("object"!=typeof o.item)throw new Error(d.a.i18n.getMessage("Error015"));n={id:o.item.id,children:[]}}t=new s.b({id:n.id}),e=n.children||await this._getChildFolders(n.id)},1),{tree:t,childFolders:e}}async getCompleteBookmarksTree(){let e=await this.getBookmarksList();let t=await this._getChildFolders(-1,2);u.a.log("Received initial folders from server (may be incomplete)",t);let r=new s.b({id:"-1"});this.server.serverRoot&&({tree:r,childFolders:t}=await this._findServerRoot(t));let n=await this._getChildOrder(r.id,2);u.a.log("Received initial children order from server (may be incomplete)",n);const o=async(t,r,n)=>{const i=await p.map(n,async n=>{if("folder"===n.type){let e=r.find(e=>e.id===n.id);if(!e)throw new Error(d.a.i18n.getMessage("Error021"));let o=new s.b({id:n.id,title:e.title,parentId:t.id});return t.children.push(o),[o,n,e]}{let r=m.find(e,e=>parseInt(e.id)===parseInt(n.id)&&parseInt(e.parentId)===parseInt(t.id));if(!r)throw new Error(d.a.i18n.getMessage("Error022",[`#${t.id}[${t.title}]`,n.id]));r=r.clone(),r.id=r.id+";"+t.id,r.parentId=t.id,t.children.push(r)}},1);await p.each(i.filter(Boolean),async([e,t,r])=>(void 0===t.children&&(t.children=await this._getChildOrder(t.id,2)),void 0===r.children&&(r.children=await this._getChildFolders(r.id,2)),o(e,r.children,t.children)),3)};return await o(r,t,n),this.tree=r,r.clone()}async getSparseBookmarksTree(){this.hasFeatureHashing=!0,this.hasFeatureExistanceCheck=!0;let e=await this._getChildFolders(-1,0),t=new s.b({id:"-1"});this.server.serverRoot&&({tree:t,childFolders:e}=await this._findServerRoot(e)),u.a.log("Received initial folders from server",e);const r=(e,t)=>{t.forEach(t=>{let n=new s.b({id:t.id,title:t.title,parentId:e.id});return e.children.push(n),r(n,t.children||[])})};return this.list=null,t.hashValue={true:await this._getFolderHash(-1)},r(t,e),this.tree=t.clone(!0),t}async _getFolderHash(e){return this.sendRequest("GET",`index.php/apps/bookmarks/public/rest/v2/folder/${e}/hash`).catch(e=>({data:"0"})).then(e=>e.data)}async _getChildren(e,t){let r;if(void 0===this.hasFeatureChildren||this.hasFeatureChildren)try{r=await this.sendRequest("GET",`index.php/apps/bookmarks/public/rest/v2/folder/${e}/children?layers=${t}`),this.hasFeatureChildren=!0}catch(e){this.hasFeatureChildren=!1}if(this.hasFeatureChildren){const t=r.data,n=(e,t)=>t.map(t=>{if("bookmark"===t.type)return new s.a({id:t.id+";"+e,title:t.title,parentId:e,url:t.url});if("folder"===t.type){const r=new s.b({id:t.id,parentId:e,title:t.title});return r.loaded=Boolean(t.children),r.children=n(t.id,t.children||[]),r}});return n(e,t)}{const[t,r,n]=await Promise.all([this._getChildOrder(e),this._getChildFolders(e),Promise.resolve().then(()=>this.list||this.sendRequest("GET",`index.php/apps/bookmarks/public/rest/v2/bookmark?folder=${e}&page=-1`).then(e=>e.data))]),o=(e,t)=>t?t.map(t=>{if(t instanceof s.b)return t;const r=new s.b({id:t.id,parentId:e,title:t.title});return r.children=o(t.id,t.children),r}):[],i=new s.b({children:o(e,r)});return t.map(t=>{if("bookmark"===t.type){const r=m.find(n,e=>parseInt(e.id)===parseInt(t.id));return r instanceof s.a?r:new s.a({id:r.id+";"+e,title:r.title,parentId:e,url:r.url})}if("folder"===t.type)return i.findFolder(t.id)})}}async loadFolderChildren(e){if(!this.hasFeatureHashing)return;const t=this.tree.findFolder(e);if(t.loaded)return t.clone(!0).children;const r=await this._getChildren(e,1),n=async e=>p.each(e,async e=>{if(e instanceof s.b&&!e.loaded){const t=await this._getFolderHash(e.id);e.hashValue={true:t}}await n(e.children)});return await n(r),t.children=r,t.clone(!0).children}async createFolder(e,t){let r;if(u.a.log("(nextcloud-folders)CREATEFOLDER",{parentId:e,title:t}),"-1"!==e)r=this.tree;else if(r=this.tree.findFolder(e),!r)throw new Error(d.a.i18n.getMessage("Error005"));let n=JSON.stringify({parent_folder:e,title:t});const o=await this.sendRequest("POST","index.php/apps/bookmarks/public/rest/v2/folder","application/json",n);if("object"!=typeof o.item)throw new Error(d.a.i18n.getMessage("Error015"));return r.children.push(new s.b({id:o.item.id,title:t,parentId:e})),this.tree.createIndex(),o.item.id}async bulkImportFolder(e,t){if(!1===this.hasFeatureBulkImport)throw new Error("Current server does not support bulk import");if(t.count()>300)throw new Error("Refusing to bulk import more than 1000 bookmarks");u.a.log("(nextcloud-folders)BULKIMPORT",{parentId:e,folder:t});const r=new Blob(["<!DOCTYPE NETSCAPE-Bookmark-file-1>\n",'<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">\n',c.serialize(t)],{type:"text/html"}),n=new FormData;let o;n.append("bm_import",r);try{o=await this.sendRequest("POST",`index.php/apps/bookmarks/public/rest/v2/folder/${e}/import`,null,n)}catch(e){this.hasFeatureBulkImport=!1}const i=(e,t,r,n)=>new s.b({id:t,title:r,parentId:n,children:e.map(e=>{if("bookmark"===e.type)return new s.a({id:e.id+";"+t,title:e.title,url:e.url,parentId:t});if("folder"===e.type)return i(e.children,e.id,e.title,t);throw console.log("PEBCAK",e),new Error("PEBKAC")})});return i(o.data,e,t.title)}async updateFolder(e,t){u.a.log("(nextcloud-folders)UPDATEFOLDER",{id:e,title:t});let r=this.tree.findFolder(e);if(!r)throw new Error(d.a.i18n.getMessage("Error006"));let n=JSON.stringify({parent_folder:r.parentId,title:t});await this.sendRequest("PUT","index.php/apps/bookmarks/public/rest/v2/folder/"+e,"application/json",n),r.title=t,this.tree.createIndex()}async moveFolder(e,t){u.a.log("(nextcloud-folders)MOVEFOLDER",{id:e,parentId:t});let r=this.tree.findFolder(e);if(!r)throw new Error(d.a.i18n.getMessage("Error007"));let n=JSON.stringify({parent_folder:t,title:r.title});await this.sendRequest("PUT","index.php/apps/bookmarks/public/rest/v2/folder/"+e,"application/json",n);let o=this.tree.findFolder(r.parentId);o.children=o.children.filter(t=>parseInt(t.id)!==parseInt(e));let i=this.tree.findFolder(t);r.parentId=t,i.children.push(r),this.tree.createIndex()}async orderFolder(e,t){u.a.log("(nextcloud-folders)ORDERFOLDER",{id:e,order:t});const r={data:t.map(e=>({id:String(e.id).split(";")[0],type:e.type}))};await this.sendRequest("PATCH",`index.php/apps/bookmarks/public/rest/v2/folder/${e}/childorder`,"application/json",JSON.stringify(r))}async removeFolder(e){u.a.log("(nextcloud-folders)REMOVEFOLDER",e);let t=this.tree.findFolder(e);if(!t)return;await this.sendRequest("DELETE","index.php/apps/bookmarks/public/rest/v2/folder/"+e);let r=this.tree.findFolder(t.parentId);r.children=r.children.filter(t=>parseInt(t.id)!==parseInt(e)),this.tree.createIndex()}async _getBookmark(e){u.a.log("Fetching single bookmark");const t=await this.sendRequest("GET","index.php/apps/bookmarks/public/rest/v2/bookmark/"+e);if("object"!=typeof t.item)throw new Error(d.a.i18n.getMessage("Error015"));let r=t.item;return r.folders.length||(r.folders=[null]),r.folders.map(e=>{let t=new s.a({id:r.id+";"+e,url:r.url,title:r.title,parentId:e});return t.tags=r.tags,t})}async getExistingBookmark(e){if(this.hasFeatureExistanceCheck){const t=await this.sendRequest("GET","index.php/apps/bookmarks/public/rest/v2/bookmark?url="+encodeURIComponent(e));return!!t.data.length&&t.data[0].id}{await this.getBookmarksList();let t=m.find(this.list,t=>t.url===e);return!!t&&t.id}}async createBookmark(e){return u.a.log("(nextcloud-folders)CREATE",e),this.bookmarkLock.acquire(e.url,async()=>{let t=await this.getExistingBookmark(e.url);if(t)e.id=t+";"+e.parentId,await this.updateBookmark(e);else{let t=JSON.stringify({url:e.url,title:e.title,folders:[e.parentId]});const r=await this.sendRequest("POST","index.php/apps/bookmarks/public/rest/v2/bookmark","application/json",t);if("object"!=typeof r.item)throw new Error(d.a.i18n.getMessage("Error015"));e.id=r.item.id+";"+e.parentId}let r=e.clone();return r.id=e.id.split(";")[0],this.list&&this.list.push(r),e.id})}async updateBookmark(e){u.a.log("(nextcloud-folders)UPDATE",e);let[t,r]=e.id.split(";");return this.bookmarkLock.acquire(t,async()=>{let n=await this._getBookmark(t),o=JSON.stringify({url:e.url,title:e.title,folders:n.map(e=>e.parentId).filter(e=>e&&parseInt(e)!==parseInt(r)).concat([e.parentId]),tags:n[0].tags});return await this.sendRequest("PUT","index.php/apps/bookmarks/public/rest/v2/bookmark/"+t,"application/json",o),t+";"+e.parentId})}async removeBookmark(e){u.a.log("(nextcloud-folders)REMOVE",{id:e});let[t,r]=e.split(";");return this.bookmarkLock.acquire(t,async()=>{await this.sendRequest("DELETE",`index.php/apps/bookmarks/public/rest/v2/folder/${r}/bookmarks/${t}`);const e=await this.getBookmarksList();let n=m.findIndex(e,e=>parseInt(e.id)===parseInt(t));e.splice(n,1)})}async sendRequest(e,t,r,n,o){const i=this.normalizeServerURL(this.server.url)+t;let a,s,c=l.Base64.encode(this.server.username+":"+this.server.password);try{a=await this.fetchQueue.add(()=>Promise.race([fetch(i,{method:e,credentials:"omit",headers:{...r&&{"Content-type":r},Authorization:"Basic "+c},...n&&{body:n}}),new Promise((e,t)=>setTimeout(()=>{const e=new Error(d.a.i18n.getMessage("Error016"));e.pass=!0,t(e)},18e4))]))}catch(e){if(e.pass)throw e;throw new Error(d.a.i18n.getMessage("Error017"))}if(o)return a;if(401===a.status||403===a.status)throw new Error(d.a.i18n.getMessage("Error018"));if(503===a.status)throw new Error(d.a.i18n.getMessage("Error019",[a.status,e]));try{s=await a.json()}catch(e){throw new Error(d.a.i18n.getMessage("Error020")+"\n"+e.message)}if("success"!==s.status)throw new Error("Nextcloud API error: \n"+JSON.stringify(s));return s}}),i.register("webdav",class extends T{constructor(e){super(e),this.server=e}static getDefaultValues(){return{type:"webdav",url:"https://example.org/",username:"bob",password:"s3cret",bookmark_file:"bookmarks.xbel"}}normalizeServerURL(e){let t=S.parse(e);return t.pathname||(t.pathname=""),S.format({protocol:t.protocol,auth:t.auth,host:t.host,port:t.port,pathname:t.pathname+("/"!==t.pathname[t.pathname.length-1]?"/":"")})}getBookmarkURL(){return this.normalizeServerURL(this.server.url)+this.server.bookmark_file}getBookmarkLockURL(){return this.getBookmarkURL()+".lock"}async downloadFile(e){let t,r=l.Base64.encode(this.server.username+":"+this.server.password);try{t=await fetch(e,{method:"GET",credentials:"omit",headers:{Authorization:"Basic "+r}})}catch(e){throw new Error(d.a.i18n.getMessage("Error017"))}if(401===t.status)throw new Error(d.a.i18n.getMessage("Error018"));if(!t.ok&&404!==t.status)throw new Error(d.a.i18n.getMessage("Error019",[t.status,"GET"]));return t}async checkLock(){let e=this.getBookmarkLockURL();return u.a.log(e),(await this.downloadFile(e)).status}timeout(e){return new Promise(t=>setTimeout(t,e))}async uploadFile(e,t,r){let n=l.Base64.encode(this.server.username+":"+this.server.password);try{var o=await fetch(e,{method:"PUT",credentials:"omit",headers:{"Content-Type":t,Authorization:"Basic "+n},body:r})}catch(e){throw u.a.log("Error Caught"),u.a.log(e),new Error(d.a.i18n.getMessage("Error017"))}if(401===o.status)throw new Error(d.a.i18n.getMessage("Error018"));if(!o.ok)throw new Error(d.a.i18n.getMessage("Error019",[o.status,"PUT"]))}async obtainLock(){let e,t=0;for(t=0;t<26;t+=1.25)if(e=await this.checkLock(),200===e)await this.timeout(1.25**t*1e3);else if(404===e)break;if(200===e)throw new Error(d.a.i18n.getMessage("Error023",this.server.bookmark_file+".lock"));if(404!==e)throw new Error(d.a.i18n.getMessage("Error024",[e,this.server.bookmark_file+".lock"]));{let e=this.getBookmarkLockURL();u.a.log(e),await this.uploadFile(e,"text/html","<html><body>I am a lock file</body></html>")}}async freeLock(){let e=this.getBookmarkLockURL(),t=l.Base64.encode(this.server.username+":"+this.server.password);try{await fetch(e,{method:"DELETE",credentials:"omit",headers:{Authorization:"Basic "+t}})}catch(e){u.a.log("Error Caught"),u.a.log(e)}}async pullFromServer(){let e=this.getBookmarkURL(),t=await this.downloadFile(e);if(401===t.status)throw new Error(d.a.i18n.getMessage("Error018"));if(404===t.status)return t;if(200===t.status){let e=await t.text();e.split("\n").forEach(e=>{if(e.indexOf("\x3c!--- highestId :")>=0){let t=e.indexOf(":")+1,r=e.lastIndexOf(":");this.highestId=parseInt(e.substring(t,r))}}),this.bookmarksCache=x.deserialize(e)}return t}async onSyncStart(){if(u.a.log("onSyncStart: begin"),"/"===this.server.bookmark_file[0])throw new Error(d.a.i18n.getMessage("Error025"));await this.obtainLock();let e=await this.pullFromServer();if(200!==e.status&&404!==e.status)throw new Error(d.a.i18n.getMessage("Error026",e.status));this.initialTreeHash=await this.bookmarksCache.hash(!0),u.a.log("onSyncStart: completed")}async onSyncFail(){u.a.log("onSyncFail"),await this.freeLock()}async onSyncComplete(){if(u.a.log("onSyncComplete"),this.bookmarksCache=this.bookmarksCache.clone(),await this.bookmarksCache.hash(!0)!==this.initialTreeHash){let e=this.getBookmarkURL(),t=function(e,t){let r='<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE xbel PUBLIC "+//IDN python.org//DTD XML Bookmark Exchange Language 1.0//EN//XML" "http://pyxml.sourceforge.net/topics/dtds/xbel.dtd">\n<xbel version="1.0">\n';return r+="\x3c!--- highestId :"+t+": for Floccus bookmark sync browser extension --\x3e\n",r+=x.serialize(e),r+="\n</xbel>",r}(this.bookmarksCache,this.highestId);await this.uploadFile(e,"application/xml",t)}else u.a.log("No changes to the server version necessary");await this.freeLock()}}),i.register("fake",class extends T{constructor(e){super(),this.server=e}static getDefaultValues(){return{type:"fake"}}setData(e){this.server=e}getData(){return JSON.parse(JSON.stringify(this.server))}getLabel(){return"Fake account (floccus)"}});class F{static async get(e){if(this.cache||(this.cache={}),this.cache[e])return await this.cache[e].updateFromStorage(),this.cache[e];let t=new n.a(e),r=await d.a.runtime.getBackgroundPage(),o=await t.getAccountData(r.controller.key),a=new O.a(t,o.localRoot),s=new F(e,t,i.factory(o),a);return this.cache[e]=s,s}static async create(e){let t=""+Date.now()+Math.random(),r=new n.a(t),o=await d.a.runtime.getBackgroundPage();return await r.setAccountData(e,o.controller.key),new F(t,r,i.factory(e))}static getDefaultValues(e){return{...i.factory({type:e}).constructor.getDefaultValues(),enabled:!0}}constructor(e,t,r,n){this.server=r,this.id=e,this.storage=t,this.localTree=n}async delete(){await this.storage.deleteAccountData()}getLabel(){return this.server.getLabel()}getData(){return{localRoot:null,strategy:"default",syncInterval:15,nestedSync:!1,...this.server.getData()}}async setData(e){let t=await d.a.runtime.getBackgroundPage();await this.storage.setAccountData(e,t.controller.key),this.server.setData(e)}async updateFromStorage(){let e=await d.a.runtime.getBackgroundPage(),t=await this.storage.getAccountData(e.controller.key);this.server.setData(t),this.localTree=new O.a(this.storage,t.localRoot)}async tracksBookmark(e){if(!await this.isInitialized())return!1;let t=await this.storage.getMappings();return Object.keys(t.bookmarks.LocalToServer).some(t=>e===t)}renderOptions(e,t){return this.server.renderOptions(e,t)}async init(){console.log("initializing account "+this.id);const e=this.getData();try{await d.a.bookmarks.getSubTree(e.localRoot)}catch(t){let r=(await d.a.bookmarks.getTree())[0].children[0],n=await d.a.bookmarks.create({title:"Floccus ("+this.getLabel()+")",parentId:r.id});e.localRoot=n.id,e.rootPath=await O.a.getPathFromLocalId(n.id),await this.setData(e)}await this.storage.initMappings(),await this.storage.initCache(),this.localTree=new O.a(this.storage,e.localRoot)}async isInitialized(){try{let e=this.getData().localRoot;return await d.a.bookmarks.getSubTree(e),!0}catch(e){return console.log("Apparently not initialized, because:",e),!1}}async sync(){let e;try{if(this.getData().syncing||this.syncing)return;let t;switch(u.a.log("Starting sync process for account "+this.getLabel()),this.syncing=!0,await this.setData({...this.getData(),syncing:.05,error:null}),await this.isInitialized()||await this.init(),this.server.onSyncStart&&await this.server.onSyncStart(),e=await this.storage.getMappings(),this.getData().strategy){case"slave":u.a.log("Using slave strategy"),t=R;break;case"overwrite":u.a.log("Using overwrite strategy"),t=A;break;default:u.a.log("Using normal strategy"),t=C.a}this.syncing=new t(e,this.localTree,await this.storage.getCache(),this.server,this.getData().parallel,e=>{this.setData({...this.getData(),syncing:e})}),await this.syncing.sync(),await this.storage.setCache(await this.localTree.getBookmarksTree()),this.server.onSyncComplete&&await this.server.onSyncComplete(),await this.setData({...this.getData(),error:null,syncing:!1,lastSync:Date.now()}),this.syncing=!1,u.a.log("Successfully ended sync process for account "+this.getLabel()),e&&await e.persist()}catch(t){console.log(t);const r=F.stringifyError(t);console.error("Syncing failed with",r),u.a.log("Syncing failed with",r),await this.setData({...this.getData(),error:r,syncing:!1}),this.syncing=!1,this.server.onSyncFail&&await this.server.onSyncFail(),e&&await e.persist()}await u.a.persist()}static stringifyError(e){return e.list?e.list.map(e=>(u.a.log(e),this.stringifyError(e))).join("\n"):e.message}async cancelSync(){if(this.syncing)return this.syncing.cancel()}static async getAllAccounts(){return Promise.all((await n.a.getAllAccounts()).map(e=>F.get(e)))}static async getAccountsContainingLocalId(e,t,r){t=t||await O.a.getIdPathFromLocalId(e);const n=(r=r||await this.getAllAccounts()).filter(e=>-1!==t.indexOf(e.getData().localRoot)).reverse(),o=n.findIndex(e=>!e.getData().nestedSync);return n.slice(0,o)}}},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{static reverseStr(e){return e.split("").reverse().join("")}static pathToArray(e){return this.reverseStr(e).split(/[/](?![\\])|[/](?=\\\\)/).map(e=>this.reverseStr(e)).map(e=>e.replace(/\\[/]/g,"/")).map(e=>e.replace(/\\\\/g,"\\")).reverse()}static arrayToPath(e){return e.map(e=>e.replace(/\\/g,"\\\\")).map(e=>e.replace(/[/]/g,"\\/")).join("/")}}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{static async sha256(e){const t=new TextEncoder("utf-8").encode(e),r=await crypto.subtle.digest("SHA-256",t);return this.bufferToHexstr(r)}static bufferToHexstr(e){return Array.from(new Uint8Array(e)).map(e=>("00"+e.toString(16)).slice(-2)).join("")}static hexstrToBuffer(e){for(var t=new Uint8Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=parseInt(e.substr(r,2),16);return t}static async prepareKey(e){const t=await crypto.subtle.digest("SHA-256",new TextEncoder("utf-8").encode(e));return await crypto.subtle.importKey("raw",t,{name:"AES-CBC"},!1,["decrypt","encrypt"])}static async decryptAES(e,t,r){return(new TextDecoder).decode(await crypto.subtle.decrypt({name:"AES-CBC",iv:Uint8Array.from(n.iv)},await this.prepareKey(e),this.hexstrToBuffer(r)))}static async encryptAES(e,t,r){return this.bufferToHexstr(await crypto.subtle.encrypt({name:"AES-CBC",iv:Uint8Array.from(n.iv)},await this.prepareKey(e),(new TextEncoder).encode(r)))}static getRandomBytes(e){let t=new Int8Array(e);return crypto.getRandomValues(t),t}}n.iv=[58,14,9,204,174,93,77,98,12,248,11,160,143,24,119,20]},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));r(16);var n=r(0),o=r(2),i=r(1),a=r(39),s=r(31),c=r.n(s),u=r(7);class l extends a.a{constructor(e,t){super(),this.rootId=t,this.storage=e,this.queue=new c.a({concurrency:10})}async getBookmarksTree(){const[e]=await n.a.bookmarks.getTree(),t=(await n.a.bookmarks.getSubTree(this.rootId))[0],r=await u.a.getAllAccounts(),a=(t,n)=>{if(r.some(e=>e.getData().localRoot===t.id&&t.id!==this.rootId&&!e.getData().nestedSync))return;let s,c;if(t.parentId===e.id){switch(t.id){case"1":case"toolbar_____":s="Bookmarks Bar";break;case"2":case"unfiled_____":s="Other Bookmarks";break;case"menu________":s="Bookmarks Menu"}s&&o.a.log("Overriding title of built-in node",t.id,t.title,"=>",s)}if(t.id===e.id&&(c=!0),t.children){let e=new i.b({id:t.id,parentId:n,title:n?s||t.title:void 0,children:t.children.map(e=>a(e,t.id)).filter(e=>!!e)});return e.isRoot=c,e}return new i.a({id:t.id,parentId:n,title:t.title,url:t.url})};return a(t)}async createBookmark(e){return o.a.log("(local)CREATE",e),(await this.queue.add(()=>n.a.bookmarks.create({parentId:e.parentId,title:e.title,url:e.url}))).id}async updateBookmark(e){o.a.log("(local)UPDATE",e),await this.queue.add(()=>n.a.bookmarks.update(e.id,{title:e.title,url:e.url})),await this.queue.add(()=>n.a.bookmarks.move(e.id,{parentId:e.parentId}))}async removeBookmark(e){o.a.log("(local)REMOVE",e),await this.queue.add(()=>n.a.bookmarks.remove(e))}async createFolder(e,t){return o.a.log("(local)CREATEFOLDER",t),(await this.queue.add(()=>n.a.bookmarks.create({parentId:e,title:t}))).id}async orderFolder(e,t){o.a.log("(local)ORDERFOLDER",{id:e,order:t});for(let e=0;e<t.length;e++)await n.a.bookmarks.move(t[e].id,{index:e})}async updateFolder(e,t){o.a.log("(local)UPDATEFOLDER",t),await this.queue.add(()=>n.a.bookmarks.update(e,{title:t}))}async moveFolder(e,t){o.a.log("(local)MOVEFOLDER",{id:e,parentId:t}),await this.queue.add(()=>n.a.bookmarks.move(e,{parentId:t}))}async removeFolder(e,t){o.a.log("(local)REMOVEFOLDER",e);let[r]=await n.a.bookmarks.getSubTree(e);!r.children.length||t?await this.queue.add(()=>n.a.bookmarks.removeTree(e)):o.a.log("Won't remove non-empty folder. Moving on.")}static async getPathFromLocalId(e,t,r){return t=t||await l.getIdPathFromLocalId(e),r&&(t=t.slice(t.indexOf(r)+1)),(await Promise.all(t.map(async e=>{try{return(await n.a.bookmarks.get(e))[0].title.replace(/[/]/g,"\\/")}catch(e){return"Error!"}}))).join("/")}static async getIdPathFromLocalId(e,t){if(t=t||[],!e)return t;t.unshift(e);let r=(await n.a.bookmarks.get(e))[0];return r.parentId===e?t:this.getIdPathFromLocalId(r.parentId,t)}}},function(e,t,r){for(var n=r(90),o=r(69),i=r(55),a=r(24),s=r(27),c=r(53),u=r(32),l=u("iterator"),f=u("toStringTag"),h=c.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=o(d),v=0;v<p.length;v++){var g,m=p[v],y=d[m],b=a[m],w=b&&b.prototype;if(w&&(w[l]||s(w,l,h),w[f]||s(w,f,m),c[m]=h,y))for(g in n)w[g]||i(w,g,n[g],!0)}},function(e,t,r){"use strict";e.exports=r(113)},,function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(e,t){module.exports=t(e)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this,(function(global){"use strict";global=global||{};var _Base64=global.Base64,version="2.5.2",buffer;if(module.exports)try{buffer=eval("require('buffer').Buffer")}catch(e){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},r=0,n=e.length;r<n;r++)t[e.charAt(r)]=r;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],r=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[b64chars.charAt(r>>>18),b64chars.charAt(r>>>12&63),t>=2?"=":b64chars.charAt(r>>>6&63),t>=1?"=":b64chars.charAt(63&r)].join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)?e.toString("base64"):btoa(utob(String(e)))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,""):_encode(e)},encodeURI=function(e){return encode(e,!0)},re_btou=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,cb_btou=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return fromCharCode(55296+(t>>>10))+fromCharCode(56320+(1023&t));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,r=t%4,n=(t>0?b64tab[e.charAt(0)]<<18:0)|(t>1?b64tab[e.charAt(1)]<<12:0)|(t>2?b64tab[e.charAt(2)]<<6:0)|(t>3?b64tab[e.charAt(3)]:0),o=[fromCharCode(n>>>16),fromCharCode(n>>>8&255),fromCharCode(255&n)];return o.length-=[0,0,2,1][r],o.join("")},_atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/\S{1,4}/g,cb_decode)},atob=function(e){return _atob(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(_atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum((function(){return decode(this)}))),Object.defineProperty(String.prototype,"toBase64",noEnum((function(e){return encode(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",noEnum((function(){return encode(this,!0)})))}}return global.Meteor&&(Base64=global.Base64),module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}}))}).call(this,__webpack_require__(25))},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));r(16);var n=r(0),o=r(14);class i{constructor(e,t){this.storage=e,this.folders=t.folders,this.bookmarks=t.bookmarks}getSnapshot(){return{ServerToLocal:{bookmarks:this.bookmarks.ServerToLocal,folders:this.folders.ServerToLocal},LocalToServer:{bookmarks:this.bookmarks.LocalToServer,folders:this.folders.LocalToServer}}}async addFolder({localId:e,remoteId:t}){this.folders=i.add(this.folders,{localId:e,remoteId:t})}async removeFolder({localId:e,remoteId:t}){this.folders=i.remove(this.folders,{localId:e,remoteId:t})}async addBookmark({localId:e,remoteId:t}){this.bookmarks=i.add(this.bookmarks,{localId:e,remoteId:t})}async removeBookmark({localId:e,remoteId:t}){this.bookmarks=i.remove(this.bookmarks,{localId:e,remoteId:t})}async persist(){await this.storage.setMappings({folders:this.folders,bookmarks:this.bookmarks})}static add(e,{localId:t,remoteId:r}){if(void 0===t||void 0===r)throw new Error("Cannot add empty mapping");return{LocalToServer:{...e.LocalToServer,[t]:r},ServerToLocal:{...e.ServerToLocal,[r]:t}}}static remove(e,{localId:t,remoteId:r}){return t&&r&&e.LocalToServer[t]!==r?(e=this.remove(e,{localId:t}),this.remove(e,{remoteId:r})):t?{LocalToServer:{...e.LocalToServer,[t]:void 0},ServerToLocal:{...e.ServerToLocal,[e.LocalToServer[t]]:void 0}}:{LocalToServer:{...e.LocalToServer,[e.ServerToLocal[r]]:void 0},ServerToLocal:{...e.ServerToLocal,[r]:void 0}}}}var a=r(1),s=r(17);const c=new(r.n(s).a);class u{constructor(e){this.accountId=e}static async changeEntry(e,t,r){await c.acquire(e,async()=>{let o=await u.getEntry(e,r);o=t(o),await n.a.storage.local.set({[e]:JSON.stringify(o)})})}static async getEntry(e,t){let r=await n.a.storage.local.get(e);if(r[e]){for(;"string"==typeof r[e];)r[e]=JSON.parse(r[e]);return r[e]}return t}static deleteEntry(e){return n.a.storage.local.remove(e)}static async getAllAccounts(){let e=await u.getEntry("accounts",{});return Object.keys(e)}async getAccountData(e){let t=(await u.getEntry("accounts",{}))[this.accountId];return e&&(t.password=await o.a.decryptAES(e,t.iv,t.password)),t}async setAccountData(e,t){let r=e;return t&&(e.iv||(e.iv=Array.from(o.a.getRandomBytes(16))),r={...e,password:await o.a.encryptAES(t,e.iv,e.password)}),u.changeEntry("accounts",e=>(e[this.accountId]=r,e),{})}async deleteAccountData(){await u.changeEntry("accounts",e=>(delete e[this.accountId],e)),await this.deleteCache(),await this.deleteMappings()}async initCache(){await u.changeEntry(`bookmarks[${this.accountId}].cache`,()=>({}))}async getCache(){const e=await u.getEntry(`bookmarks[${this.accountId}].cache`);return a.b.hydrate(e&&Object.keys(e).length?e:{})}async setCache(e){await u.changeEntry(`bookmarks[${this.accountId}].cache`,()=>e)}async deleteCache(){await u.deleteEntry(`bookmarks[${this.accountId}].cache`)}async initMappings(){await u.changeEntry(`bookmarks[${this.accountId}].mappings`,()=>({}))}async getMappings(){const e=await u.getEntry(`bookmarks[${this.accountId}].mappings`);return new i(this,e&&Object.keys(e).length?e:{bookmarks:{ServerToLocal:{},LocalToServer:{}},folders:{ServerToLocal:{},LocalToServer:{}}})}async setMappings(e){await u.changeEntry(`bookmarks[${this.accountId}].mappings`,()=>e)}async deleteMappings(){await u.deleteEntry(`bookmarks[${this.accountId}].mappings`)}}},,,,function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},,function(e,t,r){var n=r(50),o=r(67);e.exports=r(36)?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return d}));r(16);var n=r(1),o=r(2),i=r(0),a=r(29),s=r(17),c=r.n(s);const u=r(40),l=r(35),f=r(31),{throttle:h}=r(57);class d{constructor(e,t,r,n,o,i){this.mappings=e,this.localTree=t,this.server=n,this.cacheTreeRoot=r,this.preserveOrder="orderFolder"in this.server,this.progressCb=h(250,!0,i),this.done=0,this.canceled=!1,this.moveFolderLock=new c.a,this.queue=new f({concurrency:20}),this.concurrency=o?10:4}updateProgress(){this.progressCb(Math.max(.05,Math.min(1,this.done/Math.max(this.localTreeRoot.count(),this.serverTreeRoot.count()))))}async cancel(){this.canceled||(this.canceled=!0)}async sync(){if(this.localTreeRoot=await this.localTree.getBookmarksTree(),this.serverTreeRoot=await this.server.getBookmarksTree(),this.filterOutUnacceptedBookmarks(this.localTreeRoot),await this.filterOutDuplicatesInTheSameFolder(this.localTreeRoot),"loadFolderChildren"in this.server&&(o.a.log("Loading sparse tree as necessary"),await this.loadChildren(this.serverTreeRoot,this.mappings.getSnapshot())),this.localTreeRoot.createIndex(),this.cacheTreeRoot.createIndex(),this.serverTreeRoot.createIndex(),await this.syncTree({localItem:this.localTreeRoot,cacheItem:this.cacheTreeRoot,serverItem:this.serverTreeRoot}),this.canceled)throw new Error(i.a.i18n.getMessage("Error027"))}filterOutUnacceptedBookmarks(e){e.children=e.children.filter(e=>e instanceof n.a?this.server.acceptsBookmark(e):(this.filterOutUnacceptedBookmarks(e),!0))}async filterOutDuplicatesInTheSameFolder(e){const t={},r=[];e.children=e.children.filter(e=>{if(e instanceof n.a){if(t[e.url])return r.push(e),!1;t[e.url]=e}else this.filterOutDuplicatesInTheSameFolder(e);return!0}),r.length&&o.a.log("Filtered out the following duplicates before syncing",r),await Promise.all(r.map(e=>this.localTree.removeBookmark(e.id)))}async syncTree({localItem:t,cacheItem:r,serverItem:o,localOrder:i,serverOrder:a}){if(await new Promise(t=>e(t)),this.updateProgress(),this.canceled)throw new Error("Sync cancelled");return(t||o||r)instanceof n.b?this._syncTree({localItem:t,cacheItem:r,serverItem:o,localOrder:i,serverOrder:a}):this.queue.add(()=>this._syncTree({localItem:t,cacheItem:r,serverItem:o,localOrder:i,serverOrder:a}))}async _syncTree({localItem:e,cacheItem:t,serverItem:r,localOrder:i,serverOrder:a}){if(this.canceled)throw new Error("Sync cancelled");o.a.log("COMPARE",{localItem:e,cacheItem:t,serverItem:r});let s=this.mappings.getSnapshot(),c=e||r||t;return e||t||!r?!e||t||r?e&&t&&r||e&&!t&&r?c.visitUpdate(this,e,t,r):!e&&t&&r?c.visitRemove(this,{reverseMapping:s.ServerToLocal,fromTree:this.localTreeRoot,toTree:this.serverTreeRoot,toResource:this.server,toOrder:a,item:r}):e&&t&&!r?c.visitRemove(this,{reverseMapping:s.LocalToServer,fromTree:this.serverTreeRoot,toTree:this.localTreeRoot,toResource:this.localTree,toOrder:i,item:e}):void(e||!t||r||(t instanceof n.a?await this.mappings.removeBookmark({localId:t.id}):await this.mappings.removeFolder({localId:t.id}))):c.visitCreate(this,{mapping:s.LocalToServer,toTree:this.serverTreeRoot,toResource:this.server,toOrder:a,item:e}):c.visitCreate(this,{mapping:s.ServerToLocal,toTree:this.localTreeRoot,toResource:this.localTree,toOrder:i,item:r})}async loadChildren(e,t){if(this.canceled)throw new Error(i.a.i18n.getMessage("Error027"));if(e instanceof n.a)return;if(!this.server.hasFeatureHashing)return;let r,a;if(e===this.serverTreeRoot)r=this.localTreeRoot,a=this.cacheTreeRoot;else{const n=t.ServerToLocal.folders[e.id];r=this.localTreeRoot.findFolder(n),a=this.cacheTreeRoot.findFolder(n)}if(r&&!(await this.folderHasChanged(r,a,e)).changed)return void(this.done+=r.count());o.a.log("LOADCHILDREN",e);const s=await this.server.loadFolderChildren(e.id);s&&(e.children=s,await l.each(e.children,e=>this.loadChildren(e,t),this.concurrency),e.hashValue={},await e.hash(!0))}async createFolder({mapping:e,toTree:t,toResource:r,toOrder:n,item:i}){const s=t.findFolder(e.folders[i.parentId]);if(s&&s.isRoot)return void o.a.log("We're not allowed to change any direct children of the absolute root folder. Skipping.");let c;if(c=t.findFolder(e.folders[i.id])){const r=t===this.localTreeRoot?c:i;return this.moveFolderLock.isBusy(r.id)&&c.findFolder(e.folders[i.parentId])?void o.a.log("create branch: Detected hierarchy inversion. Stopping recursion / dead-lock"):void await this.moveFolderLock.acquire(r.id,async()=>{if(c.moved)o.a.log("create branch: This folder was moved here in fromTree and concurrently moved somewhere else in toTree, but it has been dealt with");else{if(i.moved||(i.moved=!0),o.a.log("create branch: This folder was moved here in fromTree"),t===this.localTreeRoot){const e=this.cacheTreeRoot.findFolder(c.id);await this.syncTree({localItem:c,cacheItem:e,serverItem:i})}else{const e=this.cacheTreeRoot.findFolder(i.id);await this.syncTree({localItem:i,cacheItem:e,serverItem:c})}"function"==typeof i.moved&&i.moved(),n.insert("folder",i.id,c.id)()}})}const u=await r.createFolder(e.folders[i.parentId],i.title),f=t===this.localTreeRoot?u:i.id,h=t===this.localTreeRoot?i.id:u;await this.mappings.addFolder({localId:f,remoteId:h});let d,p=!1;if(await i.traverse(async r=>{t.findItem(r.type,e[r.type+"s"][r.id])&&(p=!0)}),r.bulkImportFolder&&!p)try{d=await r.bulkImportFolder(u,i),d.parentId=e.folders[i.parentId]}catch(e){o.a.log("Bulk import failed"),o.a.log(e)}if(d)o.a.log("Imported folder:",d),t===this.localTreeRoot?await this.syncTree({localItem:d,serverItem:i}):await this.syncTree({localItem:i,serverItem:d});else{const e=new a.a({fromFolder:i});await l.each(i.children,async r=>{t===this.localTreeRoot?await this.syncTree({serverItem:r,localOrder:e}):await this.syncTree({localItem:r,serverOrder:e})},this.concurrency),this.preserveOrder&&await r.orderFolder(u,await e.getOrder())}n.insert("folder",i.id,u)()}async folderHasChanged(e,t,r){const n=e?await e.hash(this.preserveOrder):null,o=t?await t.hash(this.preserveOrder):null,i=r?await r.hash(this.preserveOrder):null,a=!t,s=n===i,c=n!==o&&n!==i||t&&e.parentId!==t.parentId,u=o!==i&&n!==i||t&&t.parentId!==this.mappings.folders.ServerToLocal[r.parentId];return{changedLocally:c,changedUpstream:u,changed:c||u||a,reconciled:a,enPar:s}}async updateFolder(e,t,r){const{changed:n}=await this.folderHasChanged(e,t,r);if(await this.syncFolderProperties(e,t,r),await this.mappings.addFolder({localId:e.id,remoteId:r.id}),!n)return o.a.log("Skipping subtree"),void(this.done+=e.count());o.a.log("Checking subtree");let i=this.mappings.getSnapshot(),s=new a.a({fromFolder:r,toFolder:e}),c=new a.a({fromFolder:e,toFolder:r}),f=e.children.filter(e=>r.children.some(t=>i.ServerToLocal[e.type+"s"][t.id]===e.id)),h=e.children.filter(e=>!(t&&t.children.some(t=>e.id===t.id)||f.includes(e))),d=t?t.children.filter(t=>!e.children.some(e=>e.id===t.id)):[],p=r.children.filter(r=>!(t||e).children.some(e=>i.ServerToLocal[r.type+"s"][r.id]===e.id)&&!f.some(e=>i.LocalToServer[r.type+"s"][e.id]===r.id)),v=t?t.children.filter(e=>!r.children.some(t=>i.ServerToLocal[e.type+"s"][t.id]===e.id)):[],g=h.filter(e=>p.some(t=>t.canMergeWith(e)&&!i.ServerToLocal[t.type+"s"][t.id]&&!i.LocalToServer[e.type+"s"][e.id]));await l.each(g,async e=>{const t=u.find(p,t=>t.canMergeWith(e)&&!t.merged);t&&(e.merged=!0,t.merged=!0,o.a.log("New locally and upstream (merging):",{serverChild:t,localChild:e}),await this.syncTree({localItem:e,serverItem:t,localOrder:s,serverOrder:c}))},1),await Promise.all([(async()=>{await l.each(h,async e=>{e.merged||(o.a.log("New locally:",{localChild:e}),await this.syncTree({localItem:e,localOrder:s,serverOrder:c}))},this.concurrency)})(),(async()=>{await l.each(d,async e=>{const t=this.serverTreeRoot.findItem(e.type,i.LocalToServer[e.type+"s"][e.id]);o.a.log("Absent locally:",{serverChild:t,cacheChild:e}),await this.syncTree({cacheItem:e,serverItem:t,serverOrder:c,localOrder:s})},this.concurrency)})(),(async()=>{await l.each(p,async e=>{e.merged||(o.a.log("New upstream:",{serverChild:e}),await this.syncTree({serverItem:e,localOrder:s,serverOrder:c}))},this.concurrency)})(),(async()=>{await l.each(v,async e=>{const t=this.localTreeRoot.findItem(e.type,e.id);o.a.log("Absent upstream:",{cacheChild:e,localChild:t}),await this.syncTree({localItem:t,cacheItem:e,localOrder:s,serverOrder:c})},this.concurrency)})(),(async()=>{await l.each(f,async e=>{const r=this.serverTreeRoot.findItem(e.type,i.LocalToServer[e.type+"s"][e.id]),n=t?u.find(t.children,t=>t.id===e.id):null;o.a.log("Present upstream and locally:",{localChild:e,cacheChild:n,serverChild:r}),await this.syncTree({localItem:e,cacheItem:n,serverItem:r,localOrder:s,serverOrder:c})},this.concurrency)})()]),await this.syncChildOrder({localItem:e,cacheItem:t,serverItem:r,localOrder:s,serverOrder:c})}async syncChildOrder({localItem:e,cacheItem:t,serverItem:r,localOrder:n,serverOrder:o}){const{changedLocally:i,reconciled:a,enPar:s}=await this.folderHasChanged(e,t,r);if(!this.preserveOrder)return;if(e.isRoot)return;if(s)return;await n.onFinished(),await o.onFinished();const c=this.mappings.getSnapshot();if(i||a){const t=(await n.getOrder()).filter(e=>void 0===c.LocalToServer[e.type+"s"][e.id]);if(t.length)throw new Error(`Cannot find mapped children of ${e.id} / ${r.id} for `+JSON.stringify(t));await this.server.orderFolder(r.id,(await n.getOrder()).map(e=>({id:c.LocalToServer[e.type+"s"][e.id],type:e.type})))}else{const t=(await o.getOrder()).filter(e=>void 0===c.ServerToLocal[e.type+"s"][e.id]);if(t.length)throw new Error(`Cannot find mapped children of ${e.id} / ${r.id} for `+JSON.stringify(t));await this.localTree.orderFolder(e.id,(await o.getOrder()).map(e=>({id:c.ServerToLocal[e.type+"s"][e.id],type:e.type})))}}async syncFolderProperties(e,t,r){const{changed:n,changedLocally:o,reconciled:i}=await this.folderHasChanged(e,t,r),a=this.mappings.getSnapshot();e!==this.localTreeRoot&&n&&(o||i?await this.updateFolderProperties({mapping:a.LocalToServer,fromFolder:e,toFolder:r,toResource:this.server}):await this.updateFolderProperties({mapping:a.ServerToLocal,fromFolder:r,toFolder:e,toResource:this.localTree}))}async updateFolderProperties({mapping:e,fromFolder:t,toFolder:r,toResource:n}){r.title!==t.title&&await n.updateFolder(r.id,t.title),r.parentId!==e.folders[t.parentId]&&await n.moveFolder(r.id,e.folders[t.parentId])}async removeFolder({reverseMapping:e,fromTree:t,toTree:r,toResource:n,toOrder:i,item:s}){const c=r.findFolder(s.parentId);if(c&&c.isRoot)return void o.a.log("We're not allowed to change any direct children of the absolute root folder. Skipping.");if(s.moved)return o.a.log("remove branch: This folder was removed in fromTree and concurrently moved somewhere else in toTree -- moves take precedence to preserve data"),void i.remove("folder",s.id)();let u;if(u=t.findFolder(e.folders[s.id])){const t=r===this.localTreeRoot?s:u;return this.moveFolderLock.isBusy(t.id)&&u.findFolder(e.folders[s.parentId])?void o.a.log("remove branch: Detected Folder hierarchy inversion. Stopping recursion / dead lock."):void await this.moveFolderLock.acquire(t.id,async()=>{u.moved?(o.a.log("remove branch: This folder was moved in fromTree and has been dealt with"),i.remove("folder",s.id)()):(o.a.log("remove branch: This folder was moved away from here in fromTree to somewhere else in fromTree"),u.moved=i.remove("folder",s.id))})}await l.each(s.children,async e=>{let t,n,i;r===this.serverTreeRoot?(t=e,i=this.cacheTreeRoot.findItem(t.type,this.mappings.getSnapshot().ServerToLocal[t.type+"s"][t.id])):(n=e,i=this.cacheTreeRoot.findItem(n.type,n.id)),i||(o.a.log(`Child of folder ${s.id} is new, yet we're deleting the folder: ${e}`),i=e),await this.syncTree({localItem:n,cacheItem:i,serverItem:t,localOrder:new a.a({toFolder:s}),serverOrder:new a.a({toFolder:s})})}),await n.removeFolder(s.id);const f=r===this.localTreeRoot?s.id:null,h=r===this.localTreeRoot?null:s.id;await this.mappings.removeFolder({localId:f,remoteId:h}),i.remove("folder",s.id)()}async createBookmark({mapping:e,toTree:t,toResource:r,toOrder:i,item:a}){const s=t.findFolder(e.folders[a.parentId]);if(s&&s.isRoot)return void o.a.log("We're not allowed to change any direct children of the absolute root folder. Skipping.");let c;if(c=t.findBookmark(e.bookmarks[a.id])){if(c.moved)return void o.a.log("create branch: This bookmark was moved here in fromTree and concurrently moved somewhere else in toTree, but it has been dealt with");const e=this.localTreeRoot.findBookmark(c.id)?c:a;return void await this.moveFolderLock.acquire(e.id,async()=>{if(o.a.log("create branch: This bookmark was moved here from somewhere else in from tree"),a.moved||(a.moved=!0),t===this.localTreeRoot){const e=this.cacheTreeRoot.findBookmark(c.id);await this.syncTree({localItem:c,cacheItem:e,serverItem:a})}else{const e=this.cacheTreeRoot.findBookmark(a.id);await this.syncTree({localItem:a,cacheItem:e,serverItem:c})}"function"==typeof a.moved&&a.moved(),i.insert("bookmark",a.id,c.id)()})}const u=await r.createBookmark(new n.a({parentId:e.folders[a.parentId],title:a.title,url:a.url})),l=t===this.localTreeRoot?u:a.id,f=t===this.localTreeRoot?a.id:u;await this.mappings.addBookmark({localId:l,remoteId:f}),i.insert("bookmark",a.id,u)(),this.done++}async bookmarkHasChanged(e,t,r){const n=e?await e.hash():null,o=t?await t.hash():null,i=r?await r.hash():null,a=n!==i&&n!==o||t&&e.parentId!==t.parentId,s=n!==i&&o!==i||t&&t.parentId!==this.mappings.folders.ServerToLocal[r.parentId],c=!t&&n!==i;return{changed:a||s||c,changedLocally:a,changedUpstream:s,reconciled:c}}async updateBookmark(e,t,r){const{changed:i,changedLocally:a,reconciled:s}=await this.bookmarkHasChanged(e,t,r);if(await this.mappings.addBookmark({localId:e.id,remoteId:r.id}),this.done++,!i)return void o.a.log("Bookmark unchanged");let c;a||s?c=await this.server.updateBookmark(new n.a({id:r.id,parentId:this.mappings.folders.LocalToServer[e.parentId],title:e.title,url:e.url})):await this.localTree.updateBookmark(new n.a({id:e.id,parentId:this.mappings.folders.ServerToLocal[r.parentId],title:r.title,url:r.url})),await this.mappings.addBookmark({localId:e.id,remoteId:c||r.id})}async removeBookmark({reverseMapping:e,fromTree:t,toTree:r,toResource:n,toOrder:i,item:a}){const s=r.findFolder(a.parentId);if(s&&s.isRoot)return void o.a.log("We're not allowed to change any direct children of the absolute root folder. Skipping.");if(a.moved)return o.a.log("remove branch: This bookmark was removed in fromTree and concurrently moved somewhere else in toTree -- moves take precedence"),void i.remove("bookmark",a.id)();let c;if(c=t.findBookmark(e.bookmarks[a.id])){const e=this.localTreeRoot.findBookmark(c.id)?c:a;await this.moveFolderLock.acquire(e.id,async()=>{c.moved?(o.a.log("remove branch: This bookmark was moved away from here in fromTree and has been dealt with"),i.remove("bookmark",a.id)()):(o.a.log("remove branch: This bookmark was moved away to somewhere else in fromTree"),c.moved=i.remove("bookmark",a.id))})}else await n.removeBookmark(a.id),await this.mappings.removeBookmark({[n===this.localTreeRoot?"localId":"remoteId"]:a.id}),i.remove("bookmark",a.id)(),this.done++}}}).call(this,r(83).setImmediate)},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor({fromFolder:e,toFolder:t}){this.fromFolder=e,this.toFolder=t,this.order=t?t.children.map(e=>({type:e.type,id:e.id})):[],this.pendingOps=0}insert(e,t,r){return this.pendingOps++,()=>{const n={type:e,id:r};if(!n.id)throw new Error(`Trying to insert an item without id: ${e}:${t}:${r}`);if(~this.order.findIndex(e=>e.id===n.id&&e.type===n.type))throw new Error(`Trying to insert an already existing item into OrderTracker: ${n.type}:${n.id}`);this.order.splice(this.fromFolder.children.findIndex(r=>r.id===t&&r.type===e),0,n),this.pendingOps--,this.checkFinished()}}remove(e,t){return this.pendingOps++,()=>{const r=this.order.findIndex(r=>r.id===t&&r.type===e);if(-1===r)throw new Error(`Trying to remove a non-existing item from OrderTracker: ${e}:${t}`);this.order.splice(r,1),this.pendingOps--,this.checkFinished()}}async getOrder(){return await this.onFinished(),this.order}isFinished(){return 0===this.pendingOps}onFinished(){return new Promise(e=>{this.finishedCb=e,this.checkFinished()})}checkFinished(){this.isFinished()&&this.finishedCb&&this.finishedCb()}}},,function(e,t,r){"use strict";const n=r(119);class o{constructor(){this._queue=[]}enqueue(e,t){const r={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);const n=function(e,t,r){let n=0,o=e.length;for(;o>0;){const i=o/2|0;let a=n+i;r(e[a],t)<=0?(n=++a,o-=i+1):o=i}return n}(this._queue,r,(e,t)=>t.priority-e.priority);this._queue.splice(n,0,r)}dequeue(){return this._queue.shift().run}get size(){return this._queue.length}}e.exports=class extends n{constructor(e){if(super(),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:o,...e}).concurrency&&e.concurrency>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e.concurrency}\` (${typeof e.concurrency})`);if(!("number"==typeof e.intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap}\` (${typeof e.intervalCap})`);if(!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCount=0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._intervalId=null,this._intervalEnd=0,this._timeoutId=null,this.queue=new e.queueClass,this._queueClass=e.queueClass,this._pendingCount=0,this._concurrency=e.concurrency,this._isPaused=!1===e.autoStart,this._resolveEmpty=()=>{},this._resolveIdle=()=>{}}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother()}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=()=>{},0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=()=>{})}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=null}_intervalPaused(){const e=Date.now();if(null===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return null===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this.queue.size)return clearInterval(this._intervalId),this._intervalId=null,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._intervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother)return this.emit("active"),this.queue.dequeue()(),e&&this._initializeIntervalIfNeeded(),!0}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||null!==this._intervalId||(this._intervalId=setInterval(()=>this._onInterval(),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){for(0===this._intervalCount&&0===this._pendingCount&&(clearInterval(this._intervalId),this._intervalId=null),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;this._tryToStartAnother(););}async add(e,t){return new Promise((r,n)=>{this.queue.enqueue(async()=>{this._pendingCount++,this._intervalCount++;try{r(await e())}catch(e){n(e)}this._next()},t),this._tryToStartAnother()})}async addAll(e,t){return Promise.all(e.map(e=>this.add(e,t)))}start(){if(this._isPaused)for(this._isPaused=!1;this._tryToStartAnother(););}pause(){this._isPaused=!0}clear(){this.queue=new this._queueClass}async onEmpty(){if(0!==this.queue.size)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(0!==this._pendingCount||0!==this.queue.size)return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this.queue.size}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}}},function(e,t,r){var n=r(63)("wks"),o=r(49),i=r(24).Symbol,a="function"==typeof i;(e.exports=function(e){return n[e]||(n[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=n},,,function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(a,s)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});class o extends Error{constructor(e){super(e.length+" errors"),this.list=e}}function i(e,t){return n(this,void 0,void 0,(function*(){var r=0,n=!1,i=[];return new Promise((a,s)=>{!function c(){for(;r<e&&!n;)r+=1,t().then(e=>{0!=--r||!n&&e?e?c():n=!0:0===i.length?a():s(new o(i))}).catch(e=>{i.push(e),n=!0,0==--r&&s(new o(i))})}()})}))}function a(e){return"number"==typeof e?{concurrency:e}:"object"==typeof e?Object.assign({concurrency:t.concurrency},e):{concurrency:t.concurrency}}t.MultiError=o,t.concurrency=0,t.setConcurrency=function(e){t.concurrency=e},t.each=function(e,t,r){return n(this,void 0,void 0,(function*(){if(e&&e.length>0){e=e.slice(0);var o=a(r).concurrency||e.length;yield i(o,()=>n(this,void 0,void 0,(function*(){return e.length>0&&(yield t(e.shift())),e.length>0})))}}))},t.every=function(e,t,r){return n(this,void 0,void 0,(function*(){var o=!0;if(e&&e.length>0){e=e.slice(0);var s=a(r).concurrency||e.length,c=0;yield i(s,()=>n(this,void 0,void 0,(function*(){return e.length>0&&((yield t(e.shift(),c++,e))||(o=!1)),!o||e.length>0})))}return o}))},t.filter=function(e,t,r){return n(this,void 0,void 0,(function*(){var o=[];if(e&&e.length>0){var s=e.slice(0),c=a(r).concurrency||e.length,u=0;yield i(c,()=>n(this,void 0,void 0,(function*(){if(s.length>0){var e=u++,r=s.shift();(yield t(r,u,s))&&(o[e]=r)}return s.length>0})))}return o.filter(e=>void 0!==e)}))},t.invoke=function(e,t){return n(this,void 0,void 0,(function*(){if(e&&e.length>0){e=e.slice(0);var r=a(t).concurrency||e.length;yield i(r,()=>n(this,void 0,void 0,(function*(){return e.length>0&&(yield e.shift().call(this)),e.length>0})))}}))},t.map=function(e,t,r){return n(this,void 0,void 0,(function*(){var o=[];if(e&&e.length>0){e=e.slice(0);var s=a(r).concurrency||e.length,c=0;yield i(s,()=>n(this,void 0,void 0,(function*(){if(e.length>0){var r=c++;o[r]=yield t(e.shift(),r,e)}return e.length>0})))}return o}))},t.pool=i,t.reduce=function(e,t,r,o){return n(this,void 0,void 0,(function*(){var s=r;if(e&&e.length>0){e=e.slice(0);var c=a(o).concurrency||e.length,u=0;yield i(c,()=>n(this,void 0,void 0,(function*(){return e.length>0&&(s=yield t(s,e.shift(),u++,e)),e.length>0})))}return s}))},t.sleep=function(e){return n(this,void 0,void 0,(function*(){return new Promise(t=>setTimeout(()=>t(),e))}))},t.some=function(e,t,r){return n(this,void 0,void 0,(function*(){var o=!1;if(e&&e.length>0){e=e.slice(0);var s=a(r).concurrency||e.length,c=0;yield i(s,()=>n(this,void 0,void 0,(function*(){return e.length>0&&(yield t(e.shift(),c++,e))&&(o=!0),o||e.length>0})))}return o}))}},function(e,t,r){e.exports=!r(65)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){"use strict";var n=r(114),o=r(115);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){o.isString(e)&&(e=b(e));return e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(u),f=["%","/","?",";","#"].concat(l),h=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=r(116);function b(e,t,r){if(e&&o.isObject(e)&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}i.prototype.parse=function(e,t,r){if(!o.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),s=-1!==i&&i<e.indexOf("#")?"?":"#",u=e.split(s);u[0]=u[0].replace(/\\/g,"/");var b=e=u.join(s);if(b=b.trim(),!r&&1===e.split("#").length){var w=c.exec(b);if(w)return this.path=b,this.href=b,this.pathname=w[1],w[2]?(this.search=w[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var _=a.exec(b);if(_){var k=(_=_[0]).toLowerCase();this.protocol=k,b=b.substr(_.length)}if(r||_||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var I="//"===b.substr(0,2);!I||_&&g[_]||(b=b.substr(2),this.slashes=!0)}if(!g[_]&&(I||_&&!m[_])){for(var E,T,x=-1,S=0;S<h.length;S++){-1!==(O=b.indexOf(h[S]))&&(-1===x||O<x)&&(x=O)}-1!==(T=-1===x?b.lastIndexOf("@"):b.lastIndexOf("@",x))&&(E=b.slice(0,T),b=b.slice(T+1),this.auth=decodeURIComponent(E)),x=-1;for(S=0;S<f.length;S++){var O;-1!==(O=b.indexOf(f[S]))&&(-1===x||O<x)&&(x=O)}-1===x&&(x=b.length),this.host=b.slice(0,x),b=b.slice(x),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var R=this.hostname.split(/\./),A=(S=0,R.length);S<A;S++){var F=R[S];if(F&&!F.match(d)){for(var j="",L=0,B=F.length;L<B;L++)F.charCodeAt(L)>127?j+="x":j+=F[L];if(!j.match(d)){var D=R.slice(0,S),P=R.slice(S+1),M=F.match(p);M&&(D.push(M[1]),P.unshift(M[2])),P.length&&(b="/"+P.join(".")+b),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=n.toASCII(this.hostname));var N=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+N,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!v[k])for(S=0,A=l.length;S<A;S++){var z=l[S];if(-1!==b.indexOf(z)){var q=encodeURIComponent(z);q===z&&(q=escape(z)),b=b.split(z).join(q)}}var $=b.indexOf("#");-1!==$&&(this.hash=b.substr($),b=b.slice(0,$));var W=b.indexOf("?");if(-1!==W?(this.search=b.substr(W),this.query=b.substr(W+1),t&&(this.query=y.parse(this.query)),b=b.slice(0,W)):t&&(this.search="",this.query={}),b&&(this.pathname=b),m[k]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){N=this.pathname||"";var V=this.search||"";this.path=N+V}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,a="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(a=y.stringify(this.query));var s=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+i+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+n},i.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(o.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var r=new i,n=Object.keys(this),a=0;a<n.length;a++){var s=n[a];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),u=0;u<c.length;u++){var l=c[u];"protocol"!==l&&(r[l]=e[l])}return m[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!m[e.protocol]){for(var f=Object.keys(e),h=0;h<f.length;h++){var d=f[h];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||g[e.protocol])r.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),r.pathname=p.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var v=r.pathname||"",y=r.search||"";r.path=v+y}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var b=r.pathname&&"/"===r.pathname.charAt(0),w=e.host||e.pathname&&"/"===e.pathname.charAt(0),_=w||b||r.host&&e.pathname,k=_,I=r.pathname&&r.pathname.split("/")||[],E=(p=e.pathname&&e.pathname.split("/")||[],r.protocol&&!m[r.protocol]);if(E&&(r.hostname="",r.port=null,r.host&&(""===I[0]?I[0]=r.host:I.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),_=_&&(""===p[0]||""===I[0])),w)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,I=p;else if(p.length)I||(I=[]),I.pop(),I=I.concat(p),r.search=e.search,r.query=e.query;else if(!o.isNullOrUndefined(e.search)){if(E)r.hostname=r.host=I.shift(),(C=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=C.shift(),r.host=r.hostname=C.shift());return r.search=e.search,r.query=e.query,o.isNull(r.pathname)&&o.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!I.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var T=I.slice(-1)[0],x=(r.host||e.host||I.length>1)&&("."===T||".."===T)||""===T,S=0,O=I.length;O>=0;O--)"."===(T=I[O])?I.splice(O,1):".."===T?(I.splice(O,1),S++):S&&(I.splice(O,1),S--);if(!_&&!k)for(;S--;S)I.unshift("..");!_||""===I[0]||I[0]&&"/"===I[0].charAt(0)||I.unshift(""),x&&"/"!==I.join("/").substr(-1)&&I.push("");var C,R=""===I[0]||I[0]&&"/"===I[0].charAt(0);E&&(r.hostname=r.host=R?"":I.length?I.shift():"",(C=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=C.shift(),r.host=r.hostname=C.shift()));return(_=_||r.host&&I.length)&&!R&&I.unshift(""),I.length?r.pathname=I.join("/"):(r.pathname=null,r.path=null),o.isNull(r.pathname)&&o.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(){if(this.constructor===n)throw new Error("Cannot instantiate abstract class")}async getBookmarksTree(){throw new Error("Not implemented")}async createBookmark(e){throw new Error("Not implemented")}async updateBookmark(e){throw new Error("Not implemented")}async removeBookmark(e){throw new Error("Not implemented")}async createFolder(e,t){throw new Error("Not implemented")}async updateFolder(e,t){throw new Error("Not implemented")}async moveFolder(e,t){throw new Error("Not implemented")}async removeFolder(e){throw new Error("Not implemented")}}},function(e,t,r){(function(e,n){var o;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var i="Expected a function",a="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],c="[object Arguments]",u="[object Array]",l="[object Boolean]",f="[object Date]",h="[object Error]",d="[object Function]",p="[object GeneratorFunction]",v="[object Map]",g="[object Number]",m="[object Object]",y="[object RegExp]",b="[object Set]",w="[object String]",_="[object Symbol]",k="[object WeakMap]",I="[object ArrayBuffer]",E="[object DataView]",T="[object Float32Array]",x="[object Float64Array]",S="[object Int8Array]",O="[object Int16Array]",C="[object Int32Array]",R="[object Uint8Array]",A="[object Uint16Array]",F="[object Uint32Array]",j=/\b__p \+= '';/g,L=/\b(__p \+=) '' \+/g,B=/(__e\(.*?\)|\b__t\)) \+\n'';/g,D=/&(?:amp|lt|gt|quot|#39);/g,P=/[&<>"']/g,M=RegExp(D.source),N=RegExp(P.source),U=/<%-([\s\S]+?)%>/g,z=/<%([\s\S]+?)%>/g,q=/<%=([\s\S]+?)%>/g,$=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,W=/^\w*$/,V=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,H=/[\\^$.*+?()[\]{}|]/g,G=RegExp(H.source),J=/^\s+|\s+$/g,K=/^\s+/,Z=/\s+$/,Q=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,X=/\{\n\/\* \[wrapped with (.+)\] \*/,Y=/,? & /,ee=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,te=/\\(\\)?/g,re=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ne=/\w*$/,oe=/^[-+]0x[0-9a-f]+$/i,ie=/^0b[01]+$/i,ae=/^\[object .+?Constructor\]$/,se=/^0o[0-7]+$/i,ce=/^(?:0|[1-9]\d*)$/,ue=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,le=/($^)/,fe=/['\n\r\u2028\u2029\\]/g,he="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",de="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pe="[\\ud800-\\udfff]",ve="["+de+"]",ge="["+he+"]",me="\\d+",ye="[\\u2700-\\u27bf]",be="[a-z\\xdf-\\xf6\\xf8-\\xff]",we="[^\\ud800-\\udfff"+de+me+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",_e="\\ud83c[\\udffb-\\udfff]",ke="[^\\ud800-\\udfff]",Ie="(?:\\ud83c[\\udde6-\\uddff]){2}",Ee="[\\ud800-\\udbff][\\udc00-\\udfff]",Te="[A-Z\\xc0-\\xd6\\xd8-\\xde]",xe="(?:"+be+"|"+we+")",Se="(?:"+Te+"|"+we+")",Oe="(?:"+ge+"|"+_e+")"+"?",Ce="[\\ufe0e\\ufe0f]?"+Oe+("(?:\\u200d(?:"+[ke,Ie,Ee].join("|")+")[\\ufe0e\\ufe0f]?"+Oe+")*"),Re="(?:"+[ye,Ie,Ee].join("|")+")"+Ce,Ae="(?:"+[ke+ge+"?",ge,Ie,Ee,pe].join("|")+")",Fe=RegExp("['’]","g"),je=RegExp(ge,"g"),Le=RegExp(_e+"(?="+_e+")|"+Ae+Ce,"g"),Be=RegExp([Te+"?"+be+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ve,Te,"$"].join("|")+")",Se+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ve,Te+xe,"$"].join("|")+")",Te+"?"+xe+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Te+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",me,Re].join("|"),"g"),De=RegExp("[\\u200d\\ud800-\\udfff"+he+"\\ufe0e\\ufe0f]"),Pe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Me=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ne=-1,Ue={};Ue[T]=Ue[x]=Ue[S]=Ue[O]=Ue[C]=Ue[R]=Ue["[object Uint8ClampedArray]"]=Ue[A]=Ue[F]=!0,Ue[c]=Ue[u]=Ue[I]=Ue[l]=Ue[E]=Ue[f]=Ue[h]=Ue[d]=Ue[v]=Ue[g]=Ue[m]=Ue[y]=Ue[b]=Ue[w]=Ue[k]=!1;var ze={};ze[c]=ze[u]=ze[I]=ze[E]=ze[l]=ze[f]=ze[T]=ze[x]=ze[S]=ze[O]=ze[C]=ze[v]=ze[g]=ze[m]=ze[y]=ze[b]=ze[w]=ze[_]=ze[R]=ze["[object Uint8ClampedArray]"]=ze[A]=ze[F]=!0,ze[h]=ze[d]=ze[k]=!1;var qe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},$e=parseFloat,We=parseInt,Ve="object"==typeof e&&e&&e.Object===Object&&e,He="object"==typeof self&&self&&self.Object===Object&&self,Ge=Ve||He||Function("return this")(),Je=t&&!t.nodeType&&t,Ke=Je&&"object"==typeof n&&n&&!n.nodeType&&n,Ze=Ke&&Ke.exports===Je,Qe=Ze&&Ve.process,Xe=function(){try{var e=Ke&&Ke.require&&Ke.require("util").types;return e||Qe&&Qe.binding&&Qe.binding("util")}catch(e){}}(),Ye=Xe&&Xe.isArrayBuffer,et=Xe&&Xe.isDate,tt=Xe&&Xe.isMap,rt=Xe&&Xe.isRegExp,nt=Xe&&Xe.isSet,ot=Xe&&Xe.isTypedArray;function it(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function at(e,t,r,n){for(var o=-1,i=null==e?0:e.length;++o<i;){var a=e[o];t(n,a,r(a),e)}return n}function st(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function ct(e,t){for(var r=null==e?0:e.length;r--&&!1!==t(e[r],r,e););return e}function ut(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function lt(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}function ft(e,t){return!!(null==e?0:e.length)&&_t(e,t,0)>-1}function ht(e,t,r){for(var n=-1,o=null==e?0:e.length;++n<o;)if(r(t,e[n]))return!0;return!1}function dt(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}function pt(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}function vt(e,t,r,n){var o=-1,i=null==e?0:e.length;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}function gt(e,t,r,n){var o=null==e?0:e.length;for(n&&o&&(r=e[--o]);o--;)r=t(r,e[o],o,e);return r}function mt(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var yt=Tt("length");function bt(e,t,r){var n;return r(e,(function(e,r,o){if(t(e,r,o))return n=r,!1})),n}function wt(e,t,r,n){for(var o=e.length,i=r+(n?1:-1);n?i--:++i<o;)if(t(e[i],i,e))return i;return-1}function _t(e,t,r){return t==t?function(e,t,r){var n=r-1,o=e.length;for(;++n<o;)if(e[n]===t)return n;return-1}(e,t,r):wt(e,It,r)}function kt(e,t,r,n){for(var o=r-1,i=e.length;++o<i;)if(n(e[o],t))return o;return-1}function It(e){return e!=e}function Et(e,t){var r=null==e?0:e.length;return r?Ot(e,t)/r:NaN}function Tt(e){return function(t){return null==t?void 0:t[e]}}function xt(e){return function(t){return null==e?void 0:e[t]}}function St(e,t,r,n,o){return o(e,(function(e,o,i){r=n?(n=!1,e):t(r,e,o,i)})),r}function Ot(e,t){for(var r,n=-1,o=e.length;++n<o;){var i=t(e[n]);void 0!==i&&(r=void 0===r?i:r+i)}return r}function Ct(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function Rt(e){return function(t){return e(t)}}function At(e,t){return dt(t,(function(t){return e[t]}))}function Ft(e,t){return e.has(t)}function jt(e,t){for(var r=-1,n=e.length;++r<n&&_t(t,e[r],0)>-1;);return r}function Lt(e,t){for(var r=e.length;r--&&_t(t,e[r],0)>-1;);return r}function Bt(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}var Dt=xt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Pt=xt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Mt(e){return"\\"+qe[e]}function Nt(e){return De.test(e)}function Ut(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function zt(e,t){return function(r){return e(t(r))}}function qt(e,t){for(var r=-1,n=e.length,o=0,i=[];++r<n;){var s=e[r];s!==t&&s!==a||(e[r]=a,i[o++]=r)}return i}function $t(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}function Wt(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r}function Vt(e){return Nt(e)?function(e){var t=Le.lastIndex=0;for(;Le.test(e);)++t;return t}(e):yt(e)}function Ht(e){return Nt(e)?function(e){return e.match(Le)||[]}(e):function(e){return e.split("")}(e)}var Gt=xt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Jt=function e(t){var r,n=(t=null==t?Ge:Jt.defaults(Ge.Object(),t,Jt.pick(Ge,Me))).Array,o=t.Date,he=t.Error,de=t.Function,pe=t.Math,ve=t.Object,ge=t.RegExp,me=t.String,ye=t.TypeError,be=n.prototype,we=de.prototype,_e=ve.prototype,ke=t["__core-js_shared__"],Ie=we.toString,Ee=_e.hasOwnProperty,Te=0,xe=(r=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",Se=_e.toString,Oe=Ie.call(ve),Ce=Ge._,Re=ge("^"+Ie.call(Ee).replace(H,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ae=Ze?t.Buffer:void 0,Le=t.Symbol,De=t.Uint8Array,qe=Ae?Ae.allocUnsafe:void 0,Ve=zt(ve.getPrototypeOf,ve),He=ve.create,Je=_e.propertyIsEnumerable,Ke=be.splice,Qe=Le?Le.isConcatSpreadable:void 0,Xe=Le?Le.iterator:void 0,yt=Le?Le.toStringTag:void 0,xt=function(){try{var e=ei(ve,"defineProperty");return e({},"",{}),e}catch(e){}}(),Kt=t.clearTimeout!==Ge.clearTimeout&&t.clearTimeout,Zt=o&&o.now!==Ge.Date.now&&o.now,Qt=t.setTimeout!==Ge.setTimeout&&t.setTimeout,Xt=pe.ceil,Yt=pe.floor,er=ve.getOwnPropertySymbols,tr=Ae?Ae.isBuffer:void 0,rr=t.isFinite,nr=be.join,or=zt(ve.keys,ve),ir=pe.max,ar=pe.min,sr=o.now,cr=t.parseInt,ur=pe.random,lr=be.reverse,fr=ei(t,"DataView"),hr=ei(t,"Map"),dr=ei(t,"Promise"),pr=ei(t,"Set"),vr=ei(t,"WeakMap"),gr=ei(ve,"create"),mr=vr&&new vr,yr={},br=Si(fr),wr=Si(hr),_r=Si(dr),kr=Si(pr),Ir=Si(vr),Er=Le?Le.prototype:void 0,Tr=Er?Er.valueOf:void 0,xr=Er?Er.toString:void 0;function Sr(e){if(Wa(e)&&!ja(e)&&!(e instanceof Ar)){if(e instanceof Rr)return e;if(Ee.call(e,"__wrapped__"))return Oi(e)}return new Rr(e)}var Or=function(){function e(){}return function(t){if(!$a(t))return{};if(He)return He(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function Cr(){}function Rr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function Ar(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Fr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function jr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Lr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Br(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Lr;++t<r;)this.add(e[t])}function Dr(e){var t=this.__data__=new jr(e);this.size=t.size}function Pr(e,t){var r=ja(e),n=!r&&Fa(e),o=!r&&!n&&Pa(e),i=!r&&!n&&!o&&Xa(e),a=r||n||o||i,s=a?Ct(e.length,me):[],c=s.length;for(var u in e)!t&&!Ee.call(e,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||si(u,c))||s.push(u);return s}function Mr(e){var t=e.length;return t?e[Dn(0,t-1)]:void 0}function Nr(e,t){return Ei(yo(e),Jr(t,0,e.length))}function Ur(e){return Ei(yo(e))}function zr(e,t,r){(void 0!==r&&!Ca(e[t],r)||void 0===r&&!(t in e))&&Hr(e,t,r)}function qr(e,t,r){var n=e[t];Ee.call(e,t)&&Ca(n,r)&&(void 0!==r||t in e)||Hr(e,t,r)}function $r(e,t){for(var r=e.length;r--;)if(Ca(e[r][0],t))return r;return-1}function Wr(e,t,r,n){return Yr(e,(function(e,o,i){t(n,e,r(e),i)})),n}function Vr(e,t){return e&&bo(t,ws(t),e)}function Hr(e,t,r){"__proto__"==t&&xt?xt(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Gr(e,t){for(var r=-1,o=t.length,i=n(o),a=null==e;++r<o;)i[r]=a?void 0:vs(e,t[r]);return i}function Jr(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}function Kr(e,t,r,n,o,i){var a,s=1&t,u=2&t,h=4&t;if(r&&(a=o?r(e,n,o,i):r(e)),void 0!==a)return a;if(!$a(e))return e;var k=ja(e);if(k){if(a=function(e){var t=e.length,r=new e.constructor(t);t&&"string"==typeof e[0]&&Ee.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(e),!s)return yo(e,a)}else{var j=ni(e),L=j==d||j==p;if(Pa(e))return fo(e,s);if(j==m||j==c||L&&!o){if(a=u||L?{}:ii(e),!s)return u?function(e,t){return bo(e,ri(e),t)}(e,function(e,t){return e&&bo(t,_s(t),e)}(a,e)):function(e,t){return bo(e,ti(e),t)}(e,Vr(a,e))}else{if(!ze[j])return o?e:{};a=function(e,t,r){var n=e.constructor;switch(t){case I:return ho(e);case l:case f:return new n(+e);case E:return function(e,t){var r=t?ho(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case T:case x:case S:case O:case C:case R:case"[object Uint8ClampedArray]":case A:case F:return po(e,r);case v:return new n;case g:case w:return new n(e);case y:return function(e){var t=new e.constructor(e.source,ne.exec(e));return t.lastIndex=e.lastIndex,t}(e);case b:return new n;case _:return o=e,Tr?ve(Tr.call(o)):{}}var o}(e,j,s)}}i||(i=new Dr);var B=i.get(e);if(B)return B;i.set(e,a),Ka(e)?e.forEach((function(n){a.add(Kr(n,t,r,n,e,i))})):Va(e)&&e.forEach((function(n,o){a.set(o,Kr(n,t,r,o,e,i))}));var D=k?void 0:(h?u?Go:Ho:u?_s:ws)(e);return st(D||e,(function(n,o){D&&(n=e[o=n]),qr(a,o,Kr(n,t,r,o,e,i))})),a}function Zr(e,t,r){var n=r.length;if(null==e)return!n;for(e=ve(e);n--;){var o=r[n],i=t[o],a=e[o];if(void 0===a&&!(o in e)||!i(a))return!1}return!0}function Qr(e,t,r){if("function"!=typeof e)throw new ye(i);return wi((function(){e.apply(void 0,r)}),t)}function Xr(e,t,r,n){var o=-1,i=ft,a=!0,s=e.length,c=[],u=t.length;if(!s)return c;r&&(t=dt(t,Rt(r))),n?(i=ht,a=!1):t.length>=200&&(i=Ft,a=!1,t=new Br(t));e:for(;++o<s;){var l=e[o],f=null==r?l:r(l);if(l=n||0!==l?l:0,a&&f==f){for(var h=u;h--;)if(t[h]===f)continue e;c.push(l)}else i(t,f,n)||c.push(l)}return c}Sr.templateSettings={escape:U,evaluate:z,interpolate:q,variable:"",imports:{_:Sr}},Sr.prototype=Cr.prototype,Sr.prototype.constructor=Sr,Rr.prototype=Or(Cr.prototype),Rr.prototype.constructor=Rr,Ar.prototype=Or(Cr.prototype),Ar.prototype.constructor=Ar,Fr.prototype.clear=function(){this.__data__=gr?gr(null):{},this.size=0},Fr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Fr.prototype.get=function(e){var t=this.__data__;if(gr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Ee.call(t,e)?t[e]:void 0},Fr.prototype.has=function(e){var t=this.__data__;return gr?void 0!==t[e]:Ee.call(t,e)},Fr.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=gr&&void 0===t?"__lodash_hash_undefined__":t,this},jr.prototype.clear=function(){this.__data__=[],this.size=0},jr.prototype.delete=function(e){var t=this.__data__,r=$r(t,e);return!(r<0)&&(r==t.length-1?t.pop():Ke.call(t,r,1),--this.size,!0)},jr.prototype.get=function(e){var t=this.__data__,r=$r(t,e);return r<0?void 0:t[r][1]},jr.prototype.has=function(e){return $r(this.__data__,e)>-1},jr.prototype.set=function(e,t){var r=this.__data__,n=$r(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Lr.prototype.clear=function(){this.size=0,this.__data__={hash:new Fr,map:new(hr||jr),string:new Fr}},Lr.prototype.delete=function(e){var t=Xo(this,e).delete(e);return this.size-=t?1:0,t},Lr.prototype.get=function(e){return Xo(this,e).get(e)},Lr.prototype.has=function(e){return Xo(this,e).has(e)},Lr.prototype.set=function(e,t){var r=Xo(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Br.prototype.add=Br.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Br.prototype.has=function(e){return this.__data__.has(e)},Dr.prototype.clear=function(){this.__data__=new jr,this.size=0},Dr.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Dr.prototype.get=function(e){return this.__data__.get(e)},Dr.prototype.has=function(e){return this.__data__.has(e)},Dr.prototype.set=function(e,t){var r=this.__data__;if(r instanceof jr){var n=r.__data__;if(!hr||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Lr(n)}return r.set(e,t),this.size=r.size,this};var Yr=ko(cn),en=ko(un,!0);function tn(e,t){var r=!0;return Yr(e,(function(e,n,o){return r=!!t(e,n,o)})),r}function rn(e,t,r){for(var n=-1,o=e.length;++n<o;){var i=e[n],a=t(i);if(null!=a&&(void 0===s?a==a&&!Qa(a):r(a,s)))var s=a,c=i}return c}function nn(e,t){var r=[];return Yr(e,(function(e,n,o){t(e,n,o)&&r.push(e)})),r}function on(e,t,r,n,o){var i=-1,a=e.length;for(r||(r=ai),o||(o=[]);++i<a;){var s=e[i];t>0&&r(s)?t>1?on(s,t-1,r,n,o):pt(o,s):n||(o[o.length]=s)}return o}var an=Io(),sn=Io(!0);function cn(e,t){return e&&an(e,t,ws)}function un(e,t){return e&&sn(e,t,ws)}function ln(e,t){return lt(t,(function(t){return Ua(e[t])}))}function fn(e,t){for(var r=0,n=(t=so(t,e)).length;null!=e&&r<n;)e=e[xi(t[r++])];return r&&r==n?e:void 0}function hn(e,t,r){var n=t(e);return ja(e)?n:pt(n,r(e))}function dn(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":yt&&yt in ve(e)?function(e){var t=Ee.call(e,yt),r=e[yt];try{e[yt]=void 0;var n=!0}catch(e){}var o=Se.call(e);n&&(t?e[yt]=r:delete e[yt]);return o}(e):function(e){return Se.call(e)}(e)}function pn(e,t){return e>t}function vn(e,t){return null!=e&&Ee.call(e,t)}function gn(e,t){return null!=e&&t in ve(e)}function mn(e,t,r){for(var o=r?ht:ft,i=e[0].length,a=e.length,s=a,c=n(a),u=1/0,l=[];s--;){var f=e[s];s&&t&&(f=dt(f,Rt(t))),u=ar(f.length,u),c[s]=!r&&(t||i>=120&&f.length>=120)?new Br(s&&f):void 0}f=e[0];var h=-1,d=c[0];e:for(;++h<i&&l.length<u;){var p=f[h],v=t?t(p):p;if(p=r||0!==p?p:0,!(d?Ft(d,v):o(l,v,r))){for(s=a;--s;){var g=c[s];if(!(g?Ft(g,v):o(e[s],v,r)))continue e}d&&d.push(v),l.push(p)}}return l}function yn(e,t,r){var n=null==(e=gi(e,t=so(t,e)))?e:e[xi(Ni(t))];return null==n?void 0:it(n,e,r)}function bn(e){return Wa(e)&&dn(e)==c}function wn(e,t,r,n,o){return e===t||(null==e||null==t||!Wa(e)&&!Wa(t)?e!=e&&t!=t:function(e,t,r,n,o,i){var a=ja(e),s=ja(t),d=a?u:ni(e),p=s?u:ni(t),k=(d=d==c?m:d)==m,T=(p=p==c?m:p)==m,x=d==p;if(x&&Pa(e)){if(!Pa(t))return!1;a=!0,k=!1}if(x&&!k)return i||(i=new Dr),a||Xa(e)?Wo(e,t,r,n,o,i):function(e,t,r,n,o,i,a){switch(r){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case I:return!(e.byteLength!=t.byteLength||!i(new De(e),new De(t)));case l:case f:case g:return Ca(+e,+t);case h:return e.name==t.name&&e.message==t.message;case y:case w:return e==t+"";case v:var s=Ut;case b:var c=1&n;if(s||(s=$t),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;n|=2,a.set(e,t);var d=Wo(s(e),s(t),n,o,i,a);return a.delete(e),d;case _:if(Tr)return Tr.call(e)==Tr.call(t)}return!1}(e,t,d,r,n,o,i);if(!(1&r)){var S=k&&Ee.call(e,"__wrapped__"),O=T&&Ee.call(t,"__wrapped__");if(S||O){var C=S?e.value():e,R=O?t.value():t;return i||(i=new Dr),o(C,R,r,n,i)}}if(!x)return!1;return i||(i=new Dr),function(e,t,r,n,o,i){var a=1&r,s=Ho(e),c=s.length,u=Ho(t).length;if(c!=u&&!a)return!1;var l=c;for(;l--;){var f=s[l];if(!(a?f in t:Ee.call(t,f)))return!1}var h=i.get(e),d=i.get(t);if(h&&d)return h==t&&d==e;var p=!0;i.set(e,t),i.set(t,e);var v=a;for(;++l<c;){f=s[l];var g=e[f],m=t[f];if(n)var y=a?n(m,g,f,t,e,i):n(g,m,f,e,t,i);if(!(void 0===y?g===m||o(g,m,r,n,i):y)){p=!1;break}v||(v="constructor"==f)}if(p&&!v){var b=e.constructor,w=t.constructor;b==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(p=!1)}return i.delete(e),i.delete(t),p}(e,t,r,n,o,i)}(e,t,r,n,wn,o))}function _n(e,t,r,n){var o=r.length,i=o,a=!n;if(null==e)return!i;for(e=ve(e);o--;){var s=r[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<i;){var c=(s=r[o])[0],u=e[c],l=s[1];if(a&&s[2]){if(void 0===u&&!(c in e))return!1}else{var f=new Dr;if(n)var h=n(u,l,c,e,t,f);if(!(void 0===h?wn(l,u,3,n,f):h))return!1}}return!0}function kn(e){return!(!$a(e)||(t=e,xe&&xe in t))&&(Ua(e)?Re:ae).test(Si(e));var t}function In(e){return"function"==typeof e?e:null==e?Hs:"object"==typeof e?ja(e)?Cn(e[0],e[1]):On(e):tc(e)}function En(e){if(!hi(e))return or(e);var t=[];for(var r in ve(e))Ee.call(e,r)&&"constructor"!=r&&t.push(r);return t}function Tn(e){if(!$a(e))return function(e){var t=[];if(null!=e)for(var r in ve(e))t.push(r);return t}(e);var t=hi(e),r=[];for(var n in e)("constructor"!=n||!t&&Ee.call(e,n))&&r.push(n);return r}function xn(e,t){return e<t}function Sn(e,t){var r=-1,o=Ba(e)?n(e.length):[];return Yr(e,(function(e,n,i){o[++r]=t(e,n,i)})),o}function On(e){var t=Yo(e);return 1==t.length&&t[0][2]?pi(t[0][0],t[0][1]):function(r){return r===e||_n(r,e,t)}}function Cn(e,t){return ui(e)&&di(t)?pi(xi(e),t):function(r){var n=vs(r,e);return void 0===n&&n===t?gs(r,e):wn(t,n,3)}}function Rn(e,t,r,n,o){e!==t&&an(t,(function(i,a){if(o||(o=new Dr),$a(i))!function(e,t,r,n,o,i,a){var s=yi(e,r),c=yi(t,r),u=a.get(c);if(u)return void zr(e,r,u);var l=i?i(s,c,r+"",e,t,a):void 0,f=void 0===l;if(f){var h=ja(c),d=!h&&Pa(c),p=!h&&!d&&Xa(c);l=c,h||d||p?ja(s)?l=s:Da(s)?l=yo(s):d?(f=!1,l=fo(c,!0)):p?(f=!1,l=po(c,!0)):l=[]:Ga(c)||Fa(c)?(l=s,Fa(s)?l=as(s):$a(s)&&!Ua(s)||(l=ii(c))):f=!1}f&&(a.set(c,l),o(l,c,n,i,a),a.delete(c));zr(e,r,l)}(e,t,a,r,Rn,n,o);else{var s=n?n(yi(e,a),i,a+"",e,t,o):void 0;void 0===s&&(s=i),zr(e,a,s)}}),_s)}function An(e,t){var r=e.length;if(r)return si(t+=t<0?r:0,r)?e[t]:void 0}function Fn(e,t,r){t=t.length?dt(t,(function(e){return ja(e)?function(t){return fn(t,1===e.length?e[0]:e)}:e})):[Hs];var n=-1;return t=dt(t,Rt(Qo())),function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}(Sn(e,(function(e,r,o){return{criteria:dt(t,(function(t){return t(e)})),index:++n,value:e}})),(function(e,t){return function(e,t,r){var n=-1,o=e.criteria,i=t.criteria,a=o.length,s=r.length;for(;++n<a;){var c=vo(o[n],i[n]);if(c){if(n>=s)return c;var u=r[n];return c*("desc"==u?-1:1)}}return e.index-t.index}(e,t,r)}))}function jn(e,t,r){for(var n=-1,o=t.length,i={};++n<o;){var a=t[n],s=fn(e,a);r(s,a)&&zn(i,so(a,e),s)}return i}function Ln(e,t,r,n){var o=n?kt:_t,i=-1,a=t.length,s=e;for(e===t&&(t=yo(t)),r&&(s=dt(e,Rt(r)));++i<a;)for(var c=0,u=t[i],l=r?r(u):u;(c=o(s,l,c,n))>-1;)s!==e&&Ke.call(s,c,1),Ke.call(e,c,1);return e}function Bn(e,t){for(var r=e?t.length:0,n=r-1;r--;){var o=t[r];if(r==n||o!==i){var i=o;si(o)?Ke.call(e,o,1):Yn(e,o)}}return e}function Dn(e,t){return e+Yt(ur()*(t-e+1))}function Pn(e,t){var r="";if(!e||t<1||t>9007199254740991)return r;do{t%2&&(r+=e),(t=Yt(t/2))&&(e+=e)}while(t);return r}function Mn(e,t){return _i(vi(e,t,Hs),e+"")}function Nn(e){return Mr(Cs(e))}function Un(e,t){var r=Cs(e);return Ei(r,Jr(t,0,r.length))}function zn(e,t,r,n){if(!$a(e))return e;for(var o=-1,i=(t=so(t,e)).length,a=i-1,s=e;null!=s&&++o<i;){var c=xi(t[o]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var l=s[c];void 0===(u=n?n(l,c,s):void 0)&&(u=$a(l)?l:si(t[o+1])?[]:{})}qr(s,c,u),s=s[c]}return e}var qn=mr?function(e,t){return mr.set(e,t),e}:Hs,$n=xt?function(e,t){return xt(e,"toString",{configurable:!0,enumerable:!1,value:$s(t),writable:!0})}:Hs;function Wn(e){return Ei(Cs(e))}function Vn(e,t,r){var o=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var a=n(i);++o<i;)a[o]=e[o+t];return a}function Hn(e,t){var r;return Yr(e,(function(e,n,o){return!(r=t(e,n,o))})),!!r}function Gn(e,t,r){var n=0,o=null==e?n:e.length;if("number"==typeof t&&t==t&&o<=2147483647){for(;n<o;){var i=n+o>>>1,a=e[i];null!==a&&!Qa(a)&&(r?a<=t:a<t)?n=i+1:o=i}return o}return Jn(e,t,Hs,r)}function Jn(e,t,r,n){var o=0,i=null==e?0:e.length;if(0===i)return 0;for(var a=(t=r(t))!=t,s=null===t,c=Qa(t),u=void 0===t;o<i;){var l=Yt((o+i)/2),f=r(e[l]),h=void 0!==f,d=null===f,p=f==f,v=Qa(f);if(a)var g=n||p;else g=u?p&&(n||h):s?p&&h&&(n||!d):c?p&&h&&!d&&(n||!v):!d&&!v&&(n?f<=t:f<t);g?o=l+1:i=l}return ar(i,4294967294)}function Kn(e,t){for(var r=-1,n=e.length,o=0,i=[];++r<n;){var a=e[r],s=t?t(a):a;if(!r||!Ca(s,c)){var c=s;i[o++]=0===a?0:a}}return i}function Zn(e){return"number"==typeof e?e:Qa(e)?NaN:+e}function Qn(e){if("string"==typeof e)return e;if(ja(e))return dt(e,Qn)+"";if(Qa(e))return xr?xr.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Xn(e,t,r){var n=-1,o=ft,i=e.length,a=!0,s=[],c=s;if(r)a=!1,o=ht;else if(i>=200){var u=t?null:Mo(e);if(u)return $t(u);a=!1,o=Ft,c=new Br}else c=t?[]:s;e:for(;++n<i;){var l=e[n],f=t?t(l):l;if(l=r||0!==l?l:0,a&&f==f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),s.push(l)}else o(c,f,r)||(c!==s&&c.push(f),s.push(l))}return s}function Yn(e,t){return null==(e=gi(e,t=so(t,e)))||delete e[xi(Ni(t))]}function eo(e,t,r,n){return zn(e,t,r(fn(e,t)),n)}function to(e,t,r,n){for(var o=e.length,i=n?o:-1;(n?i--:++i<o)&&t(e[i],i,e););return r?Vn(e,n?0:i,n?i+1:o):Vn(e,n?i+1:0,n?o:i)}function ro(e,t){var r=e;return r instanceof Ar&&(r=r.value()),vt(t,(function(e,t){return t.func.apply(t.thisArg,pt([e],t.args))}),r)}function no(e,t,r){var o=e.length;if(o<2)return o?Xn(e[0]):[];for(var i=-1,a=n(o);++i<o;)for(var s=e[i],c=-1;++c<o;)c!=i&&(a[i]=Xr(a[i]||s,e[c],t,r));return Xn(on(a,1),t,r)}function oo(e,t,r){for(var n=-1,o=e.length,i=t.length,a={};++n<o;){var s=n<i?t[n]:void 0;r(a,e[n],s)}return a}function io(e){return Da(e)?e:[]}function ao(e){return"function"==typeof e?e:Hs}function so(e,t){return ja(e)?e:ui(e,t)?[e]:Ti(ss(e))}var co=Mn;function uo(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:Vn(e,t,r)}var lo=Kt||function(e){return Ge.clearTimeout(e)};function fo(e,t){if(t)return e.slice();var r=e.length,n=qe?qe(r):new e.constructor(r);return e.copy(n),n}function ho(e){var t=new e.constructor(e.byteLength);return new De(t).set(new De(e)),t}function po(e,t){var r=t?ho(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function vo(e,t){if(e!==t){var r=void 0!==e,n=null===e,o=e==e,i=Qa(e),a=void 0!==t,s=null===t,c=t==t,u=Qa(t);if(!s&&!u&&!i&&e>t||i&&a&&c&&!s&&!u||n&&a&&c||!r&&c||!o)return 1;if(!n&&!i&&!u&&e<t||u&&r&&o&&!n&&!i||s&&r&&o||!a&&o||!c)return-1}return 0}function go(e,t,r,o){for(var i=-1,a=e.length,s=r.length,c=-1,u=t.length,l=ir(a-s,0),f=n(u+l),h=!o;++c<u;)f[c]=t[c];for(;++i<s;)(h||i<a)&&(f[r[i]]=e[i]);for(;l--;)f[c++]=e[i++];return f}function mo(e,t,r,o){for(var i=-1,a=e.length,s=-1,c=r.length,u=-1,l=t.length,f=ir(a-c,0),h=n(f+l),d=!o;++i<f;)h[i]=e[i];for(var p=i;++u<l;)h[p+u]=t[u];for(;++s<c;)(d||i<a)&&(h[p+r[s]]=e[i++]);return h}function yo(e,t){var r=-1,o=e.length;for(t||(t=n(o));++r<o;)t[r]=e[r];return t}function bo(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],c=n?n(r[s],e[s],s,r,e):void 0;void 0===c&&(c=e[s]),o?Hr(r,s,c):qr(r,s,c)}return r}function wo(e,t){return function(r,n){var o=ja(r)?at:Wr,i=t?t():{};return o(r,e,Qo(n,2),i)}}function _o(e){return Mn((function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&ci(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),t=ve(t);++n<o;){var s=r[n];s&&e(t,s,n,i)}return t}))}function ko(e,t){return function(r,n){if(null==r)return r;if(!Ba(r))return e(r,n);for(var o=r.length,i=t?o:-1,a=ve(r);(t?i--:++i<o)&&!1!==n(a[i],i,a););return r}}function Io(e){return function(t,r,n){for(var o=-1,i=ve(t),a=n(t),s=a.length;s--;){var c=a[e?s:++o];if(!1===r(i[c],c,i))break}return t}}function Eo(e){return function(t){var r=Nt(t=ss(t))?Ht(t):void 0,n=r?r[0]:t.charAt(0),o=r?uo(r,1).join(""):t.slice(1);return n[e]()+o}}function To(e){return function(t){return vt(Us(Fs(t).replace(Fe,"")),e,"")}}function xo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Or(e.prototype),n=e.apply(r,t);return $a(n)?n:r}}function So(e){return function(t,r,n){var o=ve(t);if(!Ba(t)){var i=Qo(r,3);t=ws(t),r=function(e){return i(o[e],e,o)}}var a=e(t,r,n);return a>-1?o[i?t[a]:a]:void 0}}function Oo(e){return Vo((function(t){var r=t.length,n=r,o=Rr.prototype.thru;for(e&&t.reverse();n--;){var a=t[n];if("function"!=typeof a)throw new ye(i);if(o&&!s&&"wrapper"==Ko(a))var s=new Rr([],!0)}for(n=s?n:r;++n<r;){var c=Ko(a=t[n]),u="wrapper"==c?Jo(a):void 0;s=u&&li(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?s[Ko(u[0])].apply(s,u[3]):1==a.length&&li(a)?s[c]():s.thru(a)}return function(){var e=arguments,n=e[0];if(s&&1==e.length&&ja(n))return s.plant(n).value();for(var o=0,i=r?t[o].apply(this,e):n;++o<r;)i=t[o].call(this,i);return i}}))}function Co(e,t,r,o,i,a,s,c,u,l){var f=128&t,h=1&t,d=2&t,p=24&t,v=512&t,g=d?void 0:xo(e);return function m(){for(var y=arguments.length,b=n(y),w=y;w--;)b[w]=arguments[w];if(p)var _=Zo(m),k=Bt(b,_);if(o&&(b=go(b,o,i,p)),a&&(b=mo(b,a,s,p)),y-=k,p&&y<l){var I=qt(b,_);return Do(e,t,Co,m.placeholder,r,b,I,c,u,l-y)}var E=h?r:this,T=d?E[e]:e;return y=b.length,c?b=mi(b,c):v&&y>1&&b.reverse(),f&&u<y&&(b.length=u),this&&this!==Ge&&this instanceof m&&(T=g||xo(T)),T.apply(E,b)}}function Ro(e,t){return function(r,n){return function(e,t,r,n){return cn(e,(function(e,o,i){t(n,r(e),o,i)})),n}(r,e,t(n),{})}}function Ao(e,t){return function(r,n){var o;if(void 0===r&&void 0===n)return t;if(void 0!==r&&(o=r),void 0!==n){if(void 0===o)return n;"string"==typeof r||"string"==typeof n?(r=Qn(r),n=Qn(n)):(r=Zn(r),n=Zn(n)),o=e(r,n)}return o}}function Fo(e){return Vo((function(t){return t=dt(t,Rt(Qo())),Mn((function(r){var n=this;return e(t,(function(e){return it(e,n,r)}))}))}))}function jo(e,t){var r=(t=void 0===t?" ":Qn(t)).length;if(r<2)return r?Pn(t,e):t;var n=Pn(t,Xt(e/Vt(t)));return Nt(t)?uo(Ht(n),0,e).join(""):n.slice(0,e)}function Lo(e){return function(t,r,o){return o&&"number"!=typeof o&&ci(t,r,o)&&(r=o=void 0),t=rs(t),void 0===r?(r=t,t=0):r=rs(r),function(e,t,r,o){for(var i=-1,a=ir(Xt((t-e)/(r||1)),0),s=n(a);a--;)s[o?a:++i]=e,e+=r;return s}(t,r,o=void 0===o?t<r?1:-1:rs(o),e)}}function Bo(e){return function(t,r){return"string"==typeof t&&"string"==typeof r||(t=is(t),r=is(r)),e(t,r)}}function Do(e,t,r,n,o,i,a,s,c,u){var l=8&t;t|=l?32:64,4&(t&=~(l?64:32))||(t&=-4);var f=[e,t,o,l?i:void 0,l?a:void 0,l?void 0:i,l?void 0:a,s,c,u],h=r.apply(void 0,f);return li(e)&&bi(h,f),h.placeholder=n,ki(h,e,t)}function Po(e){var t=pe[e];return function(e,r){if(e=is(e),(r=null==r?0:ar(ns(r),292))&&rr(e)){var n=(ss(e)+"e").split("e");return+((n=(ss(t(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}var Mo=pr&&1/$t(new pr([,-0]))[1]==1/0?function(e){return new pr(e)}:Qs;function No(e){return function(t){var r=ni(t);return r==v?Ut(t):r==b?Wt(t):function(e,t){return dt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Uo(e,t,r,o,s,c,u,l){var f=2&t;if(!f&&"function"!=typeof e)throw new ye(i);var h=o?o.length:0;if(h||(t&=-97,o=s=void 0),u=void 0===u?u:ir(ns(u),0),l=void 0===l?l:ns(l),h-=s?s.length:0,64&t){var d=o,p=s;o=s=void 0}var v=f?void 0:Jo(e),g=[e,t,r,o,s,d,p,c,u,l];if(v&&function(e,t){var r=e[1],n=t[1],o=r|n,i=o<131,s=128==n&&8==r||128==n&&256==r&&e[7].length<=t[8]||384==n&&t[7].length<=t[8]&&8==r;if(!i&&!s)return e;1&n&&(e[2]=t[2],o|=1&r?0:4);var c=t[3];if(c){var u=e[3];e[3]=u?go(u,c,t[4]):c,e[4]=u?qt(e[3],a):t[4]}(c=t[5])&&(u=e[5],e[5]=u?mo(u,c,t[6]):c,e[6]=u?qt(e[5],a):t[6]);(c=t[7])&&(e[7]=c);128&n&&(e[8]=null==e[8]?t[8]:ar(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=o}(g,v),e=g[0],t=g[1],r=g[2],o=g[3],s=g[4],!(l=g[9]=void 0===g[9]?f?0:e.length:ir(g[9]-h,0))&&24&t&&(t&=-25),t&&1!=t)m=8==t||16==t?function(e,t,r){var o=xo(e);return function i(){for(var a=arguments.length,s=n(a),c=a,u=Zo(i);c--;)s[c]=arguments[c];var l=a<3&&s[0]!==u&&s[a-1]!==u?[]:qt(s,u);if((a-=l.length)<r)return Do(e,t,Co,i.placeholder,void 0,s,l,void 0,void 0,r-a);var f=this&&this!==Ge&&this instanceof i?o:e;return it(f,this,s)}}(e,t,l):32!=t&&33!=t||s.length?Co.apply(void 0,g):function(e,t,r,o){var i=1&t,a=xo(e);return function t(){for(var s=-1,c=arguments.length,u=-1,l=o.length,f=n(l+c),h=this&&this!==Ge&&this instanceof t?a:e;++u<l;)f[u]=o[u];for(;c--;)f[u++]=arguments[++s];return it(h,i?r:this,f)}}(e,t,r,o);else var m=function(e,t,r){var n=1&t,o=xo(e);return function t(){var i=this&&this!==Ge&&this instanceof t?o:e;return i.apply(n?r:this,arguments)}}(e,t,r);return ki((v?qn:bi)(m,g),e,t)}function zo(e,t,r,n){return void 0===e||Ca(e,_e[r])&&!Ee.call(n,r)?t:e}function qo(e,t,r,n,o,i){return $a(e)&&$a(t)&&(i.set(t,e),Rn(e,t,void 0,qo,i),i.delete(t)),e}function $o(e){return Ga(e)?void 0:e}function Wo(e,t,r,n,o,i){var a=1&r,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var u=i.get(e),l=i.get(t);if(u&&l)return u==t&&l==e;var f=-1,h=!0,d=2&r?new Br:void 0;for(i.set(e,t),i.set(t,e);++f<s;){var p=e[f],v=t[f];if(n)var g=a?n(v,p,f,t,e,i):n(p,v,f,e,t,i);if(void 0!==g){if(g)continue;h=!1;break}if(d){if(!mt(t,(function(e,t){if(!Ft(d,t)&&(p===e||o(p,e,r,n,i)))return d.push(t)}))){h=!1;break}}else if(p!==v&&!o(p,v,r,n,i)){h=!1;break}}return i.delete(e),i.delete(t),h}function Vo(e){return _i(vi(e,void 0,Li),e+"")}function Ho(e){return hn(e,ws,ti)}function Go(e){return hn(e,_s,ri)}var Jo=mr?function(e){return mr.get(e)}:Qs;function Ko(e){for(var t=e.name+"",r=yr[t],n=Ee.call(yr,t)?r.length:0;n--;){var o=r[n],i=o.func;if(null==i||i==e)return o.name}return t}function Zo(e){return(Ee.call(Sr,"placeholder")?Sr:e).placeholder}function Qo(){var e=Sr.iteratee||Gs;return e=e===Gs?In:e,arguments.length?e(arguments[0],arguments[1]):e}function Xo(e,t){var r,n,o=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof t?"string":"hash"]:o.map}function Yo(e){for(var t=ws(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,di(o)]}return t}function ei(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return kn(r)?r:void 0}var ti=er?function(e){return null==e?[]:(e=ve(e),lt(er(e),(function(t){return Je.call(e,t)})))}:oc,ri=er?function(e){for(var t=[];e;)pt(t,ti(e)),e=Ve(e);return t}:oc,ni=dn;function oi(e,t,r){for(var n=-1,o=(t=so(t,e)).length,i=!1;++n<o;){var a=xi(t[n]);if(!(i=null!=e&&r(e,a)))break;e=e[a]}return i||++n!=o?i:!!(o=null==e?0:e.length)&&qa(o)&&si(a,o)&&(ja(e)||Fa(e))}function ii(e){return"function"!=typeof e.constructor||hi(e)?{}:Or(Ve(e))}function ai(e){return ja(e)||Fa(e)||!!(Qe&&e&&e[Qe])}function si(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&ce.test(e))&&e>-1&&e%1==0&&e<t}function ci(e,t,r){if(!$a(r))return!1;var n=typeof t;return!!("number"==n?Ba(r)&&si(t,r.length):"string"==n&&t in r)&&Ca(r[t],e)}function ui(e,t){if(ja(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Qa(e))||(W.test(e)||!$.test(e)||null!=t&&e in ve(t))}function li(e){var t=Ko(e),r=Sr[t];if("function"!=typeof r||!(t in Ar.prototype))return!1;if(e===r)return!0;var n=Jo(r);return!!n&&e===n[0]}(fr&&ni(new fr(new ArrayBuffer(1)))!=E||hr&&ni(new hr)!=v||dr&&"[object Promise]"!=ni(dr.resolve())||pr&&ni(new pr)!=b||vr&&ni(new vr)!=k)&&(ni=function(e){var t=dn(e),r=t==m?e.constructor:void 0,n=r?Si(r):"";if(n)switch(n){case br:return E;case wr:return v;case _r:return"[object Promise]";case kr:return b;case Ir:return k}return t});var fi=ke?Ua:ic;function hi(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||_e)}function di(e){return e==e&&!$a(e)}function pi(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in ve(r)))}}function vi(e,t,r){return t=ir(void 0===t?e.length-1:t,0),function(){for(var o=arguments,i=-1,a=ir(o.length-t,0),s=n(a);++i<a;)s[i]=o[t+i];i=-1;for(var c=n(t+1);++i<t;)c[i]=o[i];return c[t]=r(s),it(e,this,c)}}function gi(e,t){return t.length<2?e:fn(e,Vn(t,0,-1))}function mi(e,t){for(var r=e.length,n=ar(t.length,r),o=yo(e);n--;){var i=t[n];e[n]=si(i,r)?o[i]:void 0}return e}function yi(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var bi=Ii(qn),wi=Qt||function(e,t){return Ge.setTimeout(e,t)},_i=Ii($n);function ki(e,t,r){var n=t+"";return _i(e,function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(Q,"{\n/* [wrapped with "+t+"] */\n")}(n,function(e,t){return st(s,(function(r){var n="_."+r[0];t&r[1]&&!ft(e,n)&&e.push(n)})),e.sort()}(function(e){var t=e.match(X);return t?t[1].split(Y):[]}(n),r)))}function Ii(e){var t=0,r=0;return function(){var n=sr(),o=16-(n-r);if(r=n,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Ei(e,t){var r=-1,n=e.length,o=n-1;for(t=void 0===t?n:t;++r<t;){var i=Dn(r,o),a=e[i];e[i]=e[r],e[r]=a}return e.length=t,e}var Ti=function(e){var t=Ia(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(V,(function(e,r,n,o){t.push(n?o.replace(te,"$1"):r||e)})),t}));function xi(e){if("string"==typeof e||Qa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Si(e){if(null!=e){try{return Ie.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Oi(e){if(e instanceof Ar)return e.clone();var t=new Rr(e.__wrapped__,e.__chain__);return t.__actions__=yo(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ci=Mn((function(e,t){return Da(e)?Xr(e,on(t,1,Da,!0)):[]})),Ri=Mn((function(e,t){var r=Ni(t);return Da(r)&&(r=void 0),Da(e)?Xr(e,on(t,1,Da,!0),Qo(r,2)):[]})),Ai=Mn((function(e,t){var r=Ni(t);return Da(r)&&(r=void 0),Da(e)?Xr(e,on(t,1,Da,!0),void 0,r):[]}));function Fi(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var o=null==r?0:ns(r);return o<0&&(o=ir(n+o,0)),wt(e,Qo(t,3),o)}function ji(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var o=n-1;return void 0!==r&&(o=ns(r),o=r<0?ir(n+o,0):ar(o,n-1)),wt(e,Qo(t,3),o,!0)}function Li(e){return(null==e?0:e.length)?on(e,1):[]}function Bi(e){return e&&e.length?e[0]:void 0}var Di=Mn((function(e){var t=dt(e,io);return t.length&&t[0]===e[0]?mn(t):[]})),Pi=Mn((function(e){var t=Ni(e),r=dt(e,io);return t===Ni(r)?t=void 0:r.pop(),r.length&&r[0]===e[0]?mn(r,Qo(t,2)):[]})),Mi=Mn((function(e){var t=Ni(e),r=dt(e,io);return(t="function"==typeof t?t:void 0)&&r.pop(),r.length&&r[0]===e[0]?mn(r,void 0,t):[]}));function Ni(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Ui=Mn(zi);function zi(e,t){return e&&e.length&&t&&t.length?Ln(e,t):e}var qi=Vo((function(e,t){var r=null==e?0:e.length,n=Gr(e,t);return Bn(e,dt(t,(function(e){return si(e,r)?+e:e})).sort(vo)),n}));function $i(e){return null==e?e:lr.call(e)}var Wi=Mn((function(e){return Xn(on(e,1,Da,!0))})),Vi=Mn((function(e){var t=Ni(e);return Da(t)&&(t=void 0),Xn(on(e,1,Da,!0),Qo(t,2))})),Hi=Mn((function(e){var t=Ni(e);return t="function"==typeof t?t:void 0,Xn(on(e,1,Da,!0),void 0,t)}));function Gi(e){if(!e||!e.length)return[];var t=0;return e=lt(e,(function(e){if(Da(e))return t=ir(e.length,t),!0})),Ct(t,(function(t){return dt(e,Tt(t))}))}function Ji(e,t){if(!e||!e.length)return[];var r=Gi(e);return null==t?r:dt(r,(function(e){return it(t,void 0,e)}))}var Ki=Mn((function(e,t){return Da(e)?Xr(e,t):[]})),Zi=Mn((function(e){return no(lt(e,Da))})),Qi=Mn((function(e){var t=Ni(e);return Da(t)&&(t=void 0),no(lt(e,Da),Qo(t,2))})),Xi=Mn((function(e){var t=Ni(e);return t="function"==typeof t?t:void 0,no(lt(e,Da),void 0,t)})),Yi=Mn(Gi);var ea=Mn((function(e){var t=e.length,r=t>1?e[t-1]:void 0;return r="function"==typeof r?(e.pop(),r):void 0,Ji(e,r)}));function ta(e){var t=Sr(e);return t.__chain__=!0,t}function ra(e,t){return t(e)}var na=Vo((function(e){var t=e.length,r=t?e[0]:0,n=this.__wrapped__,o=function(t){return Gr(t,e)};return!(t>1||this.__actions__.length)&&n instanceof Ar&&si(r)?((n=n.slice(r,+r+(t?1:0))).__actions__.push({func:ra,args:[o],thisArg:void 0}),new Rr(n,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(o)}));var oa=wo((function(e,t,r){Ee.call(e,r)?++e[r]:Hr(e,r,1)}));var ia=So(Fi),aa=So(ji);function sa(e,t){return(ja(e)?st:Yr)(e,Qo(t,3))}function ca(e,t){return(ja(e)?ct:en)(e,Qo(t,3))}var ua=wo((function(e,t,r){Ee.call(e,r)?e[r].push(t):Hr(e,r,[t])}));var la=Mn((function(e,t,r){var o=-1,i="function"==typeof t,a=Ba(e)?n(e.length):[];return Yr(e,(function(e){a[++o]=i?it(t,e,r):yn(e,t,r)})),a})),fa=wo((function(e,t,r){Hr(e,r,t)}));function ha(e,t){return(ja(e)?dt:Sn)(e,Qo(t,3))}var da=wo((function(e,t,r){e[r?0:1].push(t)}),(function(){return[[],[]]}));var pa=Mn((function(e,t){if(null==e)return[];var r=t.length;return r>1&&ci(e,t[0],t[1])?t=[]:r>2&&ci(t[0],t[1],t[2])&&(t=[t[0]]),Fn(e,on(t,1),[])})),va=Zt||function(){return Ge.Date.now()};function ga(e,t,r){return t=r?void 0:t,Uo(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function ma(e,t){var r;if("function"!=typeof t)throw new ye(i);return e=ns(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}var ya=Mn((function(e,t,r){var n=1;if(r.length){var o=qt(r,Zo(ya));n|=32}return Uo(e,n,t,r,o)})),ba=Mn((function(e,t,r){var n=3;if(r.length){var o=qt(r,Zo(ba));n|=32}return Uo(t,n,e,r,o)}));function wa(e,t,r){var n,o,a,s,c,u,l=0,f=!1,h=!1,d=!0;if("function"!=typeof e)throw new ye(i);function p(t){var r=n,i=o;return n=o=void 0,l=t,s=e.apply(i,r)}function v(e){return l=e,c=wi(m,t),f?p(e):s}function g(e){var r=e-u;return void 0===u||r>=t||r<0||h&&e-l>=a}function m(){var e=va();if(g(e))return y(e);c=wi(m,function(e){var r=t-(e-u);return h?ar(r,a-(e-l)):r}(e))}function y(e){return c=void 0,d&&n?p(e):(n=o=void 0,s)}function b(){var e=va(),r=g(e);if(n=arguments,o=this,u=e,r){if(void 0===c)return v(u);if(h)return lo(c),c=wi(m,t),p(u)}return void 0===c&&(c=wi(m,t)),s}return t=is(t)||0,$a(r)&&(f=!!r.leading,a=(h="maxWait"in r)?ir(is(r.maxWait)||0,t):a,d="trailing"in r?!!r.trailing:d),b.cancel=function(){void 0!==c&&lo(c),l=0,n=u=o=c=void 0},b.flush=function(){return void 0===c?s:y(va())},b}var _a=Mn((function(e,t){return Qr(e,1,t)})),ka=Mn((function(e,t,r){return Qr(e,is(t)||0,r)}));function Ia(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ye(i);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Ia.Cache||Lr),r}function Ea(e){if("function"!=typeof e)throw new ye(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ia.Cache=Lr;var Ta=co((function(e,t){var r=(t=1==t.length&&ja(t[0])?dt(t[0],Rt(Qo())):dt(on(t,1),Rt(Qo()))).length;return Mn((function(n){for(var o=-1,i=ar(n.length,r);++o<i;)n[o]=t[o].call(this,n[o]);return it(e,this,n)}))})),xa=Mn((function(e,t){return Uo(e,32,void 0,t,qt(t,Zo(xa)))})),Sa=Mn((function(e,t){return Uo(e,64,void 0,t,qt(t,Zo(Sa)))})),Oa=Vo((function(e,t){return Uo(e,256,void 0,void 0,void 0,t)}));function Ca(e,t){return e===t||e!=e&&t!=t}var Ra=Bo(pn),Aa=Bo((function(e,t){return e>=t})),Fa=bn(function(){return arguments}())?bn:function(e){return Wa(e)&&Ee.call(e,"callee")&&!Je.call(e,"callee")},ja=n.isArray,La=Ye?Rt(Ye):function(e){return Wa(e)&&dn(e)==I};function Ba(e){return null!=e&&qa(e.length)&&!Ua(e)}function Da(e){return Wa(e)&&Ba(e)}var Pa=tr||ic,Ma=et?Rt(et):function(e){return Wa(e)&&dn(e)==f};function Na(e){if(!Wa(e))return!1;var t=dn(e);return t==h||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Ga(e)}function Ua(e){if(!$a(e))return!1;var t=dn(e);return t==d||t==p||"[object AsyncFunction]"==t||"[object Proxy]"==t}function za(e){return"number"==typeof e&&e==ns(e)}function qa(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function $a(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Wa(e){return null!=e&&"object"==typeof e}var Va=tt?Rt(tt):function(e){return Wa(e)&&ni(e)==v};function Ha(e){return"number"==typeof e||Wa(e)&&dn(e)==g}function Ga(e){if(!Wa(e)||dn(e)!=m)return!1;var t=Ve(e);if(null===t)return!0;var r=Ee.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Ie.call(r)==Oe}var Ja=rt?Rt(rt):function(e){return Wa(e)&&dn(e)==y};var Ka=nt?Rt(nt):function(e){return Wa(e)&&ni(e)==b};function Za(e){return"string"==typeof e||!ja(e)&&Wa(e)&&dn(e)==w}function Qa(e){return"symbol"==typeof e||Wa(e)&&dn(e)==_}var Xa=ot?Rt(ot):function(e){return Wa(e)&&qa(e.length)&&!!Ue[dn(e)]};var Ya=Bo(xn),es=Bo((function(e,t){return e<=t}));function ts(e){if(!e)return[];if(Ba(e))return Za(e)?Ht(e):yo(e);if(Xe&&e[Xe])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[Xe]());var t=ni(e);return(t==v?Ut:t==b?$t:Cs)(e)}function rs(e){return e?(e=is(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ns(e){var t=rs(e),r=t%1;return t==t?r?t-r:t:0}function os(e){return e?Jr(ns(e),0,4294967295):0}function is(e){if("number"==typeof e)return e;if(Qa(e))return NaN;if($a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=$a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(J,"");var r=ie.test(e);return r||se.test(e)?We(e.slice(2),r?2:8):oe.test(e)?NaN:+e}function as(e){return bo(e,_s(e))}function ss(e){return null==e?"":Qn(e)}var cs=_o((function(e,t){if(hi(t)||Ba(t))bo(t,ws(t),e);else for(var r in t)Ee.call(t,r)&&qr(e,r,t[r])})),us=_o((function(e,t){bo(t,_s(t),e)})),ls=_o((function(e,t,r,n){bo(t,_s(t),e,n)})),fs=_o((function(e,t,r,n){bo(t,ws(t),e,n)})),hs=Vo(Gr);var ds=Mn((function(e,t){e=ve(e);var r=-1,n=t.length,o=n>2?t[2]:void 0;for(o&&ci(t[0],t[1],o)&&(n=1);++r<n;)for(var i=t[r],a=_s(i),s=-1,c=a.length;++s<c;){var u=a[s],l=e[u];(void 0===l||Ca(l,_e[u])&&!Ee.call(e,u))&&(e[u]=i[u])}return e})),ps=Mn((function(e){return e.push(void 0,qo),it(Is,void 0,e)}));function vs(e,t,r){var n=null==e?void 0:fn(e,t);return void 0===n?r:n}function gs(e,t){return null!=e&&oi(e,t,gn)}var ms=Ro((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=Se.call(t)),e[t]=r}),$s(Hs)),ys=Ro((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=Se.call(t)),Ee.call(e,t)?e[t].push(r):e[t]=[r]}),Qo),bs=Mn(yn);function ws(e){return Ba(e)?Pr(e):En(e)}function _s(e){return Ba(e)?Pr(e,!0):Tn(e)}var ks=_o((function(e,t,r){Rn(e,t,r)})),Is=_o((function(e,t,r,n){Rn(e,t,r,n)})),Es=Vo((function(e,t){var r={};if(null==e)return r;var n=!1;t=dt(t,(function(t){return t=so(t,e),n||(n=t.length>1),t})),bo(e,Go(e),r),n&&(r=Kr(r,7,$o));for(var o=t.length;o--;)Yn(r,t[o]);return r}));var Ts=Vo((function(e,t){return null==e?{}:function(e,t){return jn(e,t,(function(t,r){return gs(e,r)}))}(e,t)}));function xs(e,t){if(null==e)return{};var r=dt(Go(e),(function(e){return[e]}));return t=Qo(t),jn(e,r,(function(e,r){return t(e,r[0])}))}var Ss=No(ws),Os=No(_s);function Cs(e){return null==e?[]:At(e,ws(e))}var Rs=To((function(e,t,r){return t=t.toLowerCase(),e+(r?As(t):t)}));function As(e){return Ns(ss(e).toLowerCase())}function Fs(e){return(e=ss(e))&&e.replace(ue,Dt).replace(je,"")}var js=To((function(e,t,r){return e+(r?"-":"")+t.toLowerCase()})),Ls=To((function(e,t,r){return e+(r?" ":"")+t.toLowerCase()})),Bs=Eo("toLowerCase");var Ds=To((function(e,t,r){return e+(r?"_":"")+t.toLowerCase()}));var Ps=To((function(e,t,r){return e+(r?" ":"")+Ns(t)}));var Ms=To((function(e,t,r){return e+(r?" ":"")+t.toUpperCase()})),Ns=Eo("toUpperCase");function Us(e,t,r){return e=ss(e),void 0===(t=r?void 0:t)?function(e){return Pe.test(e)}(e)?function(e){return e.match(Be)||[]}(e):function(e){return e.match(ee)||[]}(e):e.match(t)||[]}var zs=Mn((function(e,t){try{return it(e,void 0,t)}catch(e){return Na(e)?e:new he(e)}})),qs=Vo((function(e,t){return st(t,(function(t){t=xi(t),Hr(e,t,ya(e[t],e))})),e}));function $s(e){return function(){return e}}var Ws=Oo(),Vs=Oo(!0);function Hs(e){return e}function Gs(e){return In("function"==typeof e?e:Kr(e,1))}var Js=Mn((function(e,t){return function(r){return yn(r,e,t)}})),Ks=Mn((function(e,t){return function(r){return yn(e,r,t)}}));function Zs(e,t,r){var n=ws(t),o=ln(t,n);null!=r||$a(t)&&(o.length||!n.length)||(r=t,t=e,e=this,o=ln(t,ws(t)));var i=!($a(r)&&"chain"in r&&!r.chain),a=Ua(e);return st(o,(function(r){var n=t[r];e[r]=n,a&&(e.prototype[r]=function(){var t=this.__chain__;if(i||t){var r=e(this.__wrapped__),o=r.__actions__=yo(this.__actions__);return o.push({func:n,args:arguments,thisArg:e}),r.__chain__=t,r}return n.apply(e,pt([this.value()],arguments))})})),e}function Qs(){}var Xs=Fo(dt),Ys=Fo(ut),ec=Fo(mt);function tc(e){return ui(e)?Tt(xi(e)):function(e){return function(t){return fn(t,e)}}(e)}var rc=Lo(),nc=Lo(!0);function oc(){return[]}function ic(){return!1}var ac=Ao((function(e,t){return e+t}),0),sc=Po("ceil"),cc=Ao((function(e,t){return e/t}),1),uc=Po("floor");var lc,fc=Ao((function(e,t){return e*t}),1),hc=Po("round"),dc=Ao((function(e,t){return e-t}),0);return Sr.after=function(e,t){if("function"!=typeof t)throw new ye(i);return e=ns(e),function(){if(--e<1)return t.apply(this,arguments)}},Sr.ary=ga,Sr.assign=cs,Sr.assignIn=us,Sr.assignInWith=ls,Sr.assignWith=fs,Sr.at=hs,Sr.before=ma,Sr.bind=ya,Sr.bindAll=qs,Sr.bindKey=ba,Sr.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return ja(e)?e:[e]},Sr.chain=ta,Sr.chunk=function(e,t,r){t=(r?ci(e,t,r):void 0===t)?1:ir(ns(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var i=0,a=0,s=n(Xt(o/t));i<o;)s[a++]=Vn(e,i,i+=t);return s},Sr.compact=function(e){for(var t=-1,r=null==e?0:e.length,n=0,o=[];++t<r;){var i=e[t];i&&(o[n++]=i)}return o},Sr.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],o=e;o--;)t[o-1]=arguments[o];return pt(ja(r)?yo(r):[r],on(t,1))},Sr.cond=function(e){var t=null==e?0:e.length,r=Qo();return e=t?dt(e,(function(e){if("function"!=typeof e[1])throw new ye(i);return[r(e[0]),e[1]]})):[],Mn((function(r){for(var n=-1;++n<t;){var o=e[n];if(it(o[0],this,r))return it(o[1],this,r)}}))},Sr.conforms=function(e){return function(e){var t=ws(e);return function(r){return Zr(r,e,t)}}(Kr(e,1))},Sr.constant=$s,Sr.countBy=oa,Sr.create=function(e,t){var r=Or(e);return null==t?r:Vr(r,t)},Sr.curry=function e(t,r,n){var o=Uo(t,8,void 0,void 0,void 0,void 0,void 0,r=n?void 0:r);return o.placeholder=e.placeholder,o},Sr.curryRight=function e(t,r,n){var o=Uo(t,16,void 0,void 0,void 0,void 0,void 0,r=n?void 0:r);return o.placeholder=e.placeholder,o},Sr.debounce=wa,Sr.defaults=ds,Sr.defaultsDeep=ps,Sr.defer=_a,Sr.delay=ka,Sr.difference=Ci,Sr.differenceBy=Ri,Sr.differenceWith=Ai,Sr.drop=function(e,t,r){var n=null==e?0:e.length;return n?Vn(e,(t=r||void 0===t?1:ns(t))<0?0:t,n):[]},Sr.dropRight=function(e,t,r){var n=null==e?0:e.length;return n?Vn(e,0,(t=n-(t=r||void 0===t?1:ns(t)))<0?0:t):[]},Sr.dropRightWhile=function(e,t){return e&&e.length?to(e,Qo(t,3),!0,!0):[]},Sr.dropWhile=function(e,t){return e&&e.length?to(e,Qo(t,3),!0):[]},Sr.fill=function(e,t,r,n){var o=null==e?0:e.length;return o?(r&&"number"!=typeof r&&ci(e,t,r)&&(r=0,n=o),function(e,t,r,n){var o=e.length;for((r=ns(r))<0&&(r=-r>o?0:o+r),(n=void 0===n||n>o?o:ns(n))<0&&(n+=o),n=r>n?0:os(n);r<n;)e[r++]=t;return e}(e,t,r,n)):[]},Sr.filter=function(e,t){return(ja(e)?lt:nn)(e,Qo(t,3))},Sr.flatMap=function(e,t){return on(ha(e,t),1)},Sr.flatMapDeep=function(e,t){return on(ha(e,t),1/0)},Sr.flatMapDepth=function(e,t,r){return r=void 0===r?1:ns(r),on(ha(e,t),r)},Sr.flatten=Li,Sr.flattenDeep=function(e){return(null==e?0:e.length)?on(e,1/0):[]},Sr.flattenDepth=function(e,t){return(null==e?0:e.length)?on(e,t=void 0===t?1:ns(t)):[]},Sr.flip=function(e){return Uo(e,512)},Sr.flow=Ws,Sr.flowRight=Vs,Sr.fromPairs=function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var o=e[t];n[o[0]]=o[1]}return n},Sr.functions=function(e){return null==e?[]:ln(e,ws(e))},Sr.functionsIn=function(e){return null==e?[]:ln(e,_s(e))},Sr.groupBy=ua,Sr.initial=function(e){return(null==e?0:e.length)?Vn(e,0,-1):[]},Sr.intersection=Di,Sr.intersectionBy=Pi,Sr.intersectionWith=Mi,Sr.invert=ms,Sr.invertBy=ys,Sr.invokeMap=la,Sr.iteratee=Gs,Sr.keyBy=fa,Sr.keys=ws,Sr.keysIn=_s,Sr.map=ha,Sr.mapKeys=function(e,t){var r={};return t=Qo(t,3),cn(e,(function(e,n,o){Hr(r,t(e,n,o),e)})),r},Sr.mapValues=function(e,t){var r={};return t=Qo(t,3),cn(e,(function(e,n,o){Hr(r,n,t(e,n,o))})),r},Sr.matches=function(e){return On(Kr(e,1))},Sr.matchesProperty=function(e,t){return Cn(e,Kr(t,1))},Sr.memoize=Ia,Sr.merge=ks,Sr.mergeWith=Is,Sr.method=Js,Sr.methodOf=Ks,Sr.mixin=Zs,Sr.negate=Ea,Sr.nthArg=function(e){return e=ns(e),Mn((function(t){return An(t,e)}))},Sr.omit=Es,Sr.omitBy=function(e,t){return xs(e,Ea(Qo(t)))},Sr.once=function(e){return ma(2,e)},Sr.orderBy=function(e,t,r,n){return null==e?[]:(ja(t)||(t=null==t?[]:[t]),ja(r=n?void 0:r)||(r=null==r?[]:[r]),Fn(e,t,r))},Sr.over=Xs,Sr.overArgs=Ta,Sr.overEvery=Ys,Sr.overSome=ec,Sr.partial=xa,Sr.partialRight=Sa,Sr.partition=da,Sr.pick=Ts,Sr.pickBy=xs,Sr.property=tc,Sr.propertyOf=function(e){return function(t){return null==e?void 0:fn(e,t)}},Sr.pull=Ui,Sr.pullAll=zi,Sr.pullAllBy=function(e,t,r){return e&&e.length&&t&&t.length?Ln(e,t,Qo(r,2)):e},Sr.pullAllWith=function(e,t,r){return e&&e.length&&t&&t.length?Ln(e,t,void 0,r):e},Sr.pullAt=qi,Sr.range=rc,Sr.rangeRight=nc,Sr.rearg=Oa,Sr.reject=function(e,t){return(ja(e)?lt:nn)(e,Ea(Qo(t,3)))},Sr.remove=function(e,t){var r=[];if(!e||!e.length)return r;var n=-1,o=[],i=e.length;for(t=Qo(t,3);++n<i;){var a=e[n];t(a,n,e)&&(r.push(a),o.push(n))}return Bn(e,o),r},Sr.rest=function(e,t){if("function"!=typeof e)throw new ye(i);return Mn(e,t=void 0===t?t:ns(t))},Sr.reverse=$i,Sr.sampleSize=function(e,t,r){return t=(r?ci(e,t,r):void 0===t)?1:ns(t),(ja(e)?Nr:Un)(e,t)},Sr.set=function(e,t,r){return null==e?e:zn(e,t,r)},Sr.setWith=function(e,t,r,n){return n="function"==typeof n?n:void 0,null==e?e:zn(e,t,r,n)},Sr.shuffle=function(e){return(ja(e)?Ur:Wn)(e)},Sr.slice=function(e,t,r){var n=null==e?0:e.length;return n?(r&&"number"!=typeof r&&ci(e,t,r)?(t=0,r=n):(t=null==t?0:ns(t),r=void 0===r?n:ns(r)),Vn(e,t,r)):[]},Sr.sortBy=pa,Sr.sortedUniq=function(e){return e&&e.length?Kn(e):[]},Sr.sortedUniqBy=function(e,t){return e&&e.length?Kn(e,Qo(t,2)):[]},Sr.split=function(e,t,r){return r&&"number"!=typeof r&&ci(e,t,r)&&(t=r=void 0),(r=void 0===r?4294967295:r>>>0)?(e=ss(e))&&("string"==typeof t||null!=t&&!Ja(t))&&!(t=Qn(t))&&Nt(e)?uo(Ht(e),0,r):e.split(t,r):[]},Sr.spread=function(e,t){if("function"!=typeof e)throw new ye(i);return t=null==t?0:ir(ns(t),0),Mn((function(r){var n=r[t],o=uo(r,0,t);return n&&pt(o,n),it(e,this,o)}))},Sr.tail=function(e){var t=null==e?0:e.length;return t?Vn(e,1,t):[]},Sr.take=function(e,t,r){return e&&e.length?Vn(e,0,(t=r||void 0===t?1:ns(t))<0?0:t):[]},Sr.takeRight=function(e,t,r){var n=null==e?0:e.length;return n?Vn(e,(t=n-(t=r||void 0===t?1:ns(t)))<0?0:t,n):[]},Sr.takeRightWhile=function(e,t){return e&&e.length?to(e,Qo(t,3),!1,!0):[]},Sr.takeWhile=function(e,t){return e&&e.length?to(e,Qo(t,3)):[]},Sr.tap=function(e,t){return t(e),e},Sr.throttle=function(e,t,r){var n=!0,o=!0;if("function"!=typeof e)throw new ye(i);return $a(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),wa(e,t,{leading:n,maxWait:t,trailing:o})},Sr.thru=ra,Sr.toArray=ts,Sr.toPairs=Ss,Sr.toPairsIn=Os,Sr.toPath=function(e){return ja(e)?dt(e,xi):Qa(e)?[e]:yo(Ti(ss(e)))},Sr.toPlainObject=as,Sr.transform=function(e,t,r){var n=ja(e),o=n||Pa(e)||Xa(e);if(t=Qo(t,4),null==r){var i=e&&e.constructor;r=o?n?new i:[]:$a(e)&&Ua(i)?Or(Ve(e)):{}}return(o?st:cn)(e,(function(e,n,o){return t(r,e,n,o)})),r},Sr.unary=function(e){return ga(e,1)},Sr.union=Wi,Sr.unionBy=Vi,Sr.unionWith=Hi,Sr.uniq=function(e){return e&&e.length?Xn(e):[]},Sr.uniqBy=function(e,t){return e&&e.length?Xn(e,Qo(t,2)):[]},Sr.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Xn(e,void 0,t):[]},Sr.unset=function(e,t){return null==e||Yn(e,t)},Sr.unzip=Gi,Sr.unzipWith=Ji,Sr.update=function(e,t,r){return null==e?e:eo(e,t,ao(r))},Sr.updateWith=function(e,t,r,n){return n="function"==typeof n?n:void 0,null==e?e:eo(e,t,ao(r),n)},Sr.values=Cs,Sr.valuesIn=function(e){return null==e?[]:At(e,_s(e))},Sr.without=Ki,Sr.words=Us,Sr.wrap=function(e,t){return xa(ao(t),e)},Sr.xor=Zi,Sr.xorBy=Qi,Sr.xorWith=Xi,Sr.zip=Yi,Sr.zipObject=function(e,t){return oo(e||[],t||[],qr)},Sr.zipObjectDeep=function(e,t){return oo(e||[],t||[],zn)},Sr.zipWith=ea,Sr.entries=Ss,Sr.entriesIn=Os,Sr.extend=us,Sr.extendWith=ls,Zs(Sr,Sr),Sr.add=ac,Sr.attempt=zs,Sr.camelCase=Rs,Sr.capitalize=As,Sr.ceil=sc,Sr.clamp=function(e,t,r){return void 0===r&&(r=t,t=void 0),void 0!==r&&(r=(r=is(r))==r?r:0),void 0!==t&&(t=(t=is(t))==t?t:0),Jr(is(e),t,r)},Sr.clone=function(e){return Kr(e,4)},Sr.cloneDeep=function(e){return Kr(e,5)},Sr.cloneDeepWith=function(e,t){return Kr(e,5,t="function"==typeof t?t:void 0)},Sr.cloneWith=function(e,t){return Kr(e,4,t="function"==typeof t?t:void 0)},Sr.conformsTo=function(e,t){return null==t||Zr(e,t,ws(t))},Sr.deburr=Fs,Sr.defaultTo=function(e,t){return null==e||e!=e?t:e},Sr.divide=cc,Sr.endsWith=function(e,t,r){e=ss(e),t=Qn(t);var n=e.length,o=r=void 0===r?n:Jr(ns(r),0,n);return(r-=t.length)>=0&&e.slice(r,o)==t},Sr.eq=Ca,Sr.escape=function(e){return(e=ss(e))&&N.test(e)?e.replace(P,Pt):e},Sr.escapeRegExp=function(e){return(e=ss(e))&&G.test(e)?e.replace(H,"\\$&"):e},Sr.every=function(e,t,r){var n=ja(e)?ut:tn;return r&&ci(e,t,r)&&(t=void 0),n(e,Qo(t,3))},Sr.find=ia,Sr.findIndex=Fi,Sr.findKey=function(e,t){return bt(e,Qo(t,3),cn)},Sr.findLast=aa,Sr.findLastIndex=ji,Sr.findLastKey=function(e,t){return bt(e,Qo(t,3),un)},Sr.floor=uc,Sr.forEach=sa,Sr.forEachRight=ca,Sr.forIn=function(e,t){return null==e?e:an(e,Qo(t,3),_s)},Sr.forInRight=function(e,t){return null==e?e:sn(e,Qo(t,3),_s)},Sr.forOwn=function(e,t){return e&&cn(e,Qo(t,3))},Sr.forOwnRight=function(e,t){return e&&un(e,Qo(t,3))},Sr.get=vs,Sr.gt=Ra,Sr.gte=Aa,Sr.has=function(e,t){return null!=e&&oi(e,t,vn)},Sr.hasIn=gs,Sr.head=Bi,Sr.identity=Hs,Sr.includes=function(e,t,r,n){e=Ba(e)?e:Cs(e),r=r&&!n?ns(r):0;var o=e.length;return r<0&&(r=ir(o+r,0)),Za(e)?r<=o&&e.indexOf(t,r)>-1:!!o&&_t(e,t,r)>-1},Sr.indexOf=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var o=null==r?0:ns(r);return o<0&&(o=ir(n+o,0)),_t(e,t,o)},Sr.inRange=function(e,t,r){return t=rs(t),void 0===r?(r=t,t=0):r=rs(r),function(e,t,r){return e>=ar(t,r)&&e<ir(t,r)}(e=is(e),t,r)},Sr.invoke=bs,Sr.isArguments=Fa,Sr.isArray=ja,Sr.isArrayBuffer=La,Sr.isArrayLike=Ba,Sr.isArrayLikeObject=Da,Sr.isBoolean=function(e){return!0===e||!1===e||Wa(e)&&dn(e)==l},Sr.isBuffer=Pa,Sr.isDate=Ma,Sr.isElement=function(e){return Wa(e)&&1===e.nodeType&&!Ga(e)},Sr.isEmpty=function(e){if(null==e)return!0;if(Ba(e)&&(ja(e)||"string"==typeof e||"function"==typeof e.splice||Pa(e)||Xa(e)||Fa(e)))return!e.length;var t=ni(e);if(t==v||t==b)return!e.size;if(hi(e))return!En(e).length;for(var r in e)if(Ee.call(e,r))return!1;return!0},Sr.isEqual=function(e,t){return wn(e,t)},Sr.isEqualWith=function(e,t,r){var n=(r="function"==typeof r?r:void 0)?r(e,t):void 0;return void 0===n?wn(e,t,void 0,r):!!n},Sr.isError=Na,Sr.isFinite=function(e){return"number"==typeof e&&rr(e)},Sr.isFunction=Ua,Sr.isInteger=za,Sr.isLength=qa,Sr.isMap=Va,Sr.isMatch=function(e,t){return e===t||_n(e,t,Yo(t))},Sr.isMatchWith=function(e,t,r){return r="function"==typeof r?r:void 0,_n(e,t,Yo(t),r)},Sr.isNaN=function(e){return Ha(e)&&e!=+e},Sr.isNative=function(e){if(fi(e))throw new he("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return kn(e)},Sr.isNil=function(e){return null==e},Sr.isNull=function(e){return null===e},Sr.isNumber=Ha,Sr.isObject=$a,Sr.isObjectLike=Wa,Sr.isPlainObject=Ga,Sr.isRegExp=Ja,Sr.isSafeInteger=function(e){return za(e)&&e>=-9007199254740991&&e<=9007199254740991},Sr.isSet=Ka,Sr.isString=Za,Sr.isSymbol=Qa,Sr.isTypedArray=Xa,Sr.isUndefined=function(e){return void 0===e},Sr.isWeakMap=function(e){return Wa(e)&&ni(e)==k},Sr.isWeakSet=function(e){return Wa(e)&&"[object WeakSet]"==dn(e)},Sr.join=function(e,t){return null==e?"":nr.call(e,t)},Sr.kebabCase=js,Sr.last=Ni,Sr.lastIndexOf=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var o=n;return void 0!==r&&(o=(o=ns(r))<0?ir(n+o,0):ar(o,n-1)),t==t?function(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n}(e,t,o):wt(e,It,o,!0)},Sr.lowerCase=Ls,Sr.lowerFirst=Bs,Sr.lt=Ya,Sr.lte=es,Sr.max=function(e){return e&&e.length?rn(e,Hs,pn):void 0},Sr.maxBy=function(e,t){return e&&e.length?rn(e,Qo(t,2),pn):void 0},Sr.mean=function(e){return Et(e,Hs)},Sr.meanBy=function(e,t){return Et(e,Qo(t,2))},Sr.min=function(e){return e&&e.length?rn(e,Hs,xn):void 0},Sr.minBy=function(e,t){return e&&e.length?rn(e,Qo(t,2),xn):void 0},Sr.stubArray=oc,Sr.stubFalse=ic,Sr.stubObject=function(){return{}},Sr.stubString=function(){return""},Sr.stubTrue=function(){return!0},Sr.multiply=fc,Sr.nth=function(e,t){return e&&e.length?An(e,ns(t)):void 0},Sr.noConflict=function(){return Ge._===this&&(Ge._=Ce),this},Sr.noop=Qs,Sr.now=va,Sr.pad=function(e,t,r){e=ss(e);var n=(t=ns(t))?Vt(e):0;if(!t||n>=t)return e;var o=(t-n)/2;return jo(Yt(o),r)+e+jo(Xt(o),r)},Sr.padEnd=function(e,t,r){e=ss(e);var n=(t=ns(t))?Vt(e):0;return t&&n<t?e+jo(t-n,r):e},Sr.padStart=function(e,t,r){e=ss(e);var n=(t=ns(t))?Vt(e):0;return t&&n<t?jo(t-n,r)+e:e},Sr.parseInt=function(e,t,r){return r||null==t?t=0:t&&(t=+t),cr(ss(e).replace(K,""),t||0)},Sr.random=function(e,t,r){if(r&&"boolean"!=typeof r&&ci(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=rs(e),void 0===t?(t=e,e=0):t=rs(t)),e>t){var n=e;e=t,t=n}if(r||e%1||t%1){var o=ur();return ar(e+o*(t-e+$e("1e-"+((o+"").length-1))),t)}return Dn(e,t)},Sr.reduce=function(e,t,r){var n=ja(e)?vt:St,o=arguments.length<3;return n(e,Qo(t,4),r,o,Yr)},Sr.reduceRight=function(e,t,r){var n=ja(e)?gt:St,o=arguments.length<3;return n(e,Qo(t,4),r,o,en)},Sr.repeat=function(e,t,r){return t=(r?ci(e,t,r):void 0===t)?1:ns(t),Pn(ss(e),t)},Sr.replace=function(){var e=arguments,t=ss(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Sr.result=function(e,t,r){var n=-1,o=(t=so(t,e)).length;for(o||(o=1,e=void 0);++n<o;){var i=null==e?void 0:e[xi(t[n])];void 0===i&&(n=o,i=r),e=Ua(i)?i.call(e):i}return e},Sr.round=hc,Sr.runInContext=e,Sr.sample=function(e){return(ja(e)?Mr:Nn)(e)},Sr.size=function(e){if(null==e)return 0;if(Ba(e))return Za(e)?Vt(e):e.length;var t=ni(e);return t==v||t==b?e.size:En(e).length},Sr.snakeCase=Ds,Sr.some=function(e,t,r){var n=ja(e)?mt:Hn;return r&&ci(e,t,r)&&(t=void 0),n(e,Qo(t,3))},Sr.sortedIndex=function(e,t){return Gn(e,t)},Sr.sortedIndexBy=function(e,t,r){return Jn(e,t,Qo(r,2))},Sr.sortedIndexOf=function(e,t){var r=null==e?0:e.length;if(r){var n=Gn(e,t);if(n<r&&Ca(e[n],t))return n}return-1},Sr.sortedLastIndex=function(e,t){return Gn(e,t,!0)},Sr.sortedLastIndexBy=function(e,t,r){return Jn(e,t,Qo(r,2),!0)},Sr.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var r=Gn(e,t,!0)-1;if(Ca(e[r],t))return r}return-1},Sr.startCase=Ps,Sr.startsWith=function(e,t,r){return e=ss(e),r=null==r?0:Jr(ns(r),0,e.length),t=Qn(t),e.slice(r,r+t.length)==t},Sr.subtract=dc,Sr.sum=function(e){return e&&e.length?Ot(e,Hs):0},Sr.sumBy=function(e,t){return e&&e.length?Ot(e,Qo(t,2)):0},Sr.template=function(e,t,r){var n=Sr.templateSettings;r&&ci(e,t,r)&&(t=void 0),e=ss(e),t=ls({},t,n,zo);var o,i,a=ls({},t.imports,n.imports,zo),s=ws(a),c=At(a,s),u=0,l=t.interpolate||le,f="__p += '",h=ge((t.escape||le).source+"|"+l.source+"|"+(l===q?re:le).source+"|"+(t.evaluate||le).source+"|$","g"),d="//# sourceURL="+(Ee.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ne+"]")+"\n";e.replace(h,(function(t,r,n,a,s,c){return n||(n=a),f+=e.slice(u,c).replace(fe,Mt),r&&(o=!0,f+="' +\n__e("+r+") +\n'"),s&&(i=!0,f+="';\n"+s+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),f+="';\n";var p=Ee.call(t,"variable")&&t.variable;p||(f="with (obj) {\n"+f+"\n}\n"),f=(i?f.replace(j,""):f).replace(L,"$1").replace(B,"$1;"),f="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v=zs((function(){return de(s,d+"return "+f).apply(void 0,c)}));if(v.source=f,Na(v))throw v;return v},Sr.times=function(e,t){if((e=ns(e))<1||e>9007199254740991)return[];var r=4294967295,n=ar(e,4294967295);e-=4294967295;for(var o=Ct(n,t=Qo(t));++r<e;)t(r);return o},Sr.toFinite=rs,Sr.toInteger=ns,Sr.toLength=os,Sr.toLower=function(e){return ss(e).toLowerCase()},Sr.toNumber=is,Sr.toSafeInteger=function(e){return e?Jr(ns(e),-9007199254740991,9007199254740991):0===e?e:0},Sr.toString=ss,Sr.toUpper=function(e){return ss(e).toUpperCase()},Sr.trim=function(e,t,r){if((e=ss(e))&&(r||void 0===t))return e.replace(J,"");if(!e||!(t=Qn(t)))return e;var n=Ht(e),o=Ht(t);return uo(n,jt(n,o),Lt(n,o)+1).join("")},Sr.trimEnd=function(e,t,r){if((e=ss(e))&&(r||void 0===t))return e.replace(Z,"");if(!e||!(t=Qn(t)))return e;var n=Ht(e);return uo(n,0,Lt(n,Ht(t))+1).join("")},Sr.trimStart=function(e,t,r){if((e=ss(e))&&(r||void 0===t))return e.replace(K,"");if(!e||!(t=Qn(t)))return e;var n=Ht(e);return uo(n,jt(n,Ht(t))).join("")},Sr.truncate=function(e,t){var r=30,n="...";if($a(t)){var o="separator"in t?t.separator:o;r="length"in t?ns(t.length):r,n="omission"in t?Qn(t.omission):n}var i=(e=ss(e)).length;if(Nt(e)){var a=Ht(e);i=a.length}if(r>=i)return e;var s=r-Vt(n);if(s<1)return n;var c=a?uo(a,0,s).join(""):e.slice(0,s);if(void 0===o)return c+n;if(a&&(s+=c.length-s),Ja(o)){if(e.slice(s).search(o)){var u,l=c;for(o.global||(o=ge(o.source,ss(ne.exec(o))+"g")),o.lastIndex=0;u=o.exec(l);)var f=u.index;c=c.slice(0,void 0===f?s:f)}}else if(e.indexOf(Qn(o),s)!=s){var h=c.lastIndexOf(o);h>-1&&(c=c.slice(0,h))}return c+n},Sr.unescape=function(e){return(e=ss(e))&&M.test(e)?e.replace(D,Gt):e},Sr.uniqueId=function(e){var t=++Te;return ss(e)+t},Sr.upperCase=Ms,Sr.upperFirst=Ns,Sr.each=sa,Sr.eachRight=ca,Sr.first=Bi,Zs(Sr,(lc={},cn(Sr,(function(e,t){Ee.call(Sr.prototype,t)||(lc[t]=e)})),lc),{chain:!1}),Sr.VERSION="4.17.19",st(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Sr[e].placeholder=Sr})),st(["drop","take"],(function(e,t){Ar.prototype[e]=function(r){r=void 0===r?1:ir(ns(r),0);var n=this.__filtered__&&!t?new Ar(this):this.clone();return n.__filtered__?n.__takeCount__=ar(r,n.__takeCount__):n.__views__.push({size:ar(r,4294967295),type:e+(n.__dir__<0?"Right":"")}),n},Ar.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),st(["filter","map","takeWhile"],(function(e,t){var r=t+1,n=1==r||3==r;Ar.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Qo(e,3),type:r}),t.__filtered__=t.__filtered__||n,t}})),st(["head","last"],(function(e,t){var r="take"+(t?"Right":"");Ar.prototype[e]=function(){return this[r](1).value()[0]}})),st(["initial","tail"],(function(e,t){var r="drop"+(t?"":"Right");Ar.prototype[e]=function(){return this.__filtered__?new Ar(this):this[r](1)}})),Ar.prototype.compact=function(){return this.filter(Hs)},Ar.prototype.find=function(e){return this.filter(e).head()},Ar.prototype.findLast=function(e){return this.reverse().find(e)},Ar.prototype.invokeMap=Mn((function(e,t){return"function"==typeof e?new Ar(this):this.map((function(r){return yn(r,e,t)}))})),Ar.prototype.reject=function(e){return this.filter(Ea(Qo(e)))},Ar.prototype.slice=function(e,t){e=ns(e);var r=this;return r.__filtered__&&(e>0||t<0)?new Ar(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),void 0!==t&&(r=(t=ns(t))<0?r.dropRight(-t):r.take(t-e)),r)},Ar.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ar.prototype.toArray=function(){return this.take(4294967295)},cn(Ar.prototype,(function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),n=/^(?:head|last)$/.test(t),o=Sr[n?"take"+("last"==t?"Right":""):t],i=n||/^find/.test(t);o&&(Sr.prototype[t]=function(){var t=this.__wrapped__,a=n?[1]:arguments,s=t instanceof Ar,c=a[0],u=s||ja(t),l=function(e){var t=o.apply(Sr,pt([e],a));return n&&f?t[0]:t};u&&r&&"function"==typeof c&&1!=c.length&&(s=u=!1);var f=this.__chain__,h=!!this.__actions__.length,d=i&&!f,p=s&&!h;if(!i&&u){t=p?t:new Ar(this);var v=e.apply(t,a);return v.__actions__.push({func:ra,args:[l],thisArg:void 0}),new Rr(v,f)}return d&&p?e.apply(this,a):(v=this.thru(l),d?n?v.value()[0]:v.value():v)})})),st(["pop","push","shift","sort","splice","unshift"],(function(e){var t=be[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);Sr.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var o=this.value();return t.apply(ja(o)?o:[],e)}return this[r]((function(r){return t.apply(ja(r)?r:[],e)}))}})),cn(Ar.prototype,(function(e,t){var r=Sr[t];if(r){var n=r.name+"";Ee.call(yr,n)||(yr[n]=[]),yr[n].push({name:t,func:r})}})),yr[Co(void 0,2).name]=[{name:"wrapper",func:void 0}],Ar.prototype.clone=function(){var e=new Ar(this.__wrapped__);return e.__actions__=yo(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=yo(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=yo(this.__views__),e},Ar.prototype.reverse=function(){if(this.__filtered__){var e=new Ar(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Ar.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,r=ja(e),n=t<0,o=r?e.length:0,i=function(e,t,r){var n=-1,o=r.length;for(;++n<o;){var i=r[n],a=i.size;switch(i.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=ar(t,e+a);break;case"takeRight":e=ir(e,t-a)}}return{start:e,end:t}}(0,o,this.__views__),a=i.start,s=i.end,c=s-a,u=n?s:a-1,l=this.__iteratees__,f=l.length,h=0,d=ar(c,this.__takeCount__);if(!r||!n&&o==c&&d==c)return ro(e,this.__actions__);var p=[];e:for(;c--&&h<d;){for(var v=-1,g=e[u+=t];++v<f;){var m=l[v],y=m.iteratee,b=m.type,w=y(g);if(2==b)g=w;else if(!w){if(1==b)continue e;break e}}p[h++]=g}return p},Sr.prototype.at=na,Sr.prototype.chain=function(){return ta(this)},Sr.prototype.commit=function(){return new Rr(this.value(),this.__chain__)},Sr.prototype.next=function(){void 0===this.__values__&&(this.__values__=ts(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},Sr.prototype.plant=function(e){for(var t,r=this;r instanceof Cr;){var n=Oi(r);n.__index__=0,n.__values__=void 0,t?o.__wrapped__=n:t=n;var o=n;r=r.__wrapped__}return o.__wrapped__=e,t},Sr.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Ar){var t=e;return this.__actions__.length&&(t=new Ar(this)),(t=t.reverse()).__actions__.push({func:ra,args:[$i],thisArg:void 0}),new Rr(t,this.__chain__)}return this.thru($i)},Sr.prototype.toJSON=Sr.prototype.valueOf=Sr.prototype.value=function(){return ro(this.__wrapped__,this.__actions__)},Sr.prototype.first=Sr.prototype.head,Xe&&(Sr.prototype[Xe]=function(){return this}),Sr}();Ge._=Jt,void 0===(o=function(){return Jt}.call(t,r,t,n))||(n.exports=o)}).call(this)}).call(this,r(25),r(73)(e))},,function(e){e.exports=JSON.parse('{"name":"floccus","version":"4.2.6","description":"Sync your bookmarks across browsers via Nextcloud, WebDAV or a local file (and thus any file sync solution)","main":"index.js","scripts":{"build":"gulp","build-release":"gulp release","test":"node test/selenium-runner.js"},"repository":{"type":"git","url":"git+https://github.com/marcelklehr/floccus.git"},"author":"","license":"MPL-2.0","bugs":{"url":"https://github.com/marcelklehr/floccus/issues"},"homepage":"https://github.com/marcelklehr/floccus#readme","devDependencies":{"@babel/core":"^7.9.0","@babel/preset-env":"^7.10.4","@babel/preset-react":"^7.9.4","all-contributors-cli":"^6.14.2","babel-eslint":"^10.1.0","babel-loader":"^8.1.0","chai":"^4.2.0","chai-as-promised":"^7.1.1","chrome-webstore-upload":"^0.2.2","crx3":"^1.1.2","deepmerge":"^4.2.2","eslint-plugin-mocha":"^6.3.0","fibers":"^5.0.0","gist-client":"^1.1.1","gulp":"^4","gulp-tap":"^1.0.1","gulp-zip":"^5","mocha":"^7.1.2","prettier":"^2.0.5","sass":"^1.26.5","sass-loader":"^8.0.2","selenium-webdriver":"^4.0.0-alpha.7","typescript":"^3.9.7","vuetify-loader":"^1.4.3","webpack":"^4.43.0","webpack-cli":"^3.3.11","webpack-merge":"^4.2.2"},"dependencies":{"async-lock":"^1.2.4","async-parallel":"^1.2.3","babel-polyfill":"^6.20.0","css-loader":"^3.5.3","dom-delegator":"^13.1.0","eslint":"^6.8.0","eslint-config-standard":"^12.0.0","eslint-import-resolver-webpack":"^0.12.1","eslint-loader":"^3.0.4","eslint-plugin-import":"^2.20.2","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^4.1.1","eslint-plugin-standard":"^4.0.1","eslint-plugin-vue":"^6.2.2","humanize-duration":"^3.22.0","hyperapp":"^1.2.10","js-base64":"^2.5.2","localforage":"^1.7.3","lodash":"^4.17.19","murmur2js":"^1.0.0","normalize-url":"^5.0.0","p-queue":"^5.0.0","picostyle":"^1.0.2","punycode":"^2.1.1","throttle-debounce":"^2.1.0","virtual-dom":"^2.1.1","vue":"^2.6.11","vue-loader":"^15.9.3","vue-router":"^3.1.6","vue-template-compiler":"^2.6.11","vuelidate":"^0.7.5","vuetify":"^2.3.4","vuex":"^3.5.1","vuex-router-sync":"^5.0.0"}}')},,function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,u=[],l=!1,f=-1;function h(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&d())}function d(){if(!l){var e=s(h);l=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),1!==u.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),c=n[r];r<i;c=n[++r])v(c)||!w(c)?a+=" "+c:a+=" "+s(c);return a},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var i,a={};function s(e,r){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(r)?n.showHidden=r:r&&t._extend(n,r),y(n.showHidden)&&(n.showHidden=!1),y(n.depth)&&(n.depth=2),y(n.colors)&&(n.colors=!1),y(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),l(n,e,n.depth)}function c(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function u(e,t){return e}function l(e,r,n){if(e.customInspect&&r&&I(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return m(o)||(o=l(e,o,n)),o}var i=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(m(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(g(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(v(t))return e.stylize("null","null")}(e,r);if(i)return i;var a=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),k(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(r);if(0===a.length){if(I(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(b(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(_(r))return e.stylize(Date.prototype.toString.call(r),"date");if(k(r))return f(r)}var u,w="",E=!1,T=["{","}"];(d(r)&&(E=!0,T=["[","]"]),I(r))&&(w=" [Function"+(r.name?": "+r.name:"")+"]");return b(r)&&(w=" "+RegExp.prototype.toString.call(r)),_(r)&&(w=" "+Date.prototype.toUTCString.call(r)),k(r)&&(w=" "+f(r)),0!==a.length||E&&0!=r.length?n<0?b(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=E?function(e,t,r,n,o){for(var i=[],a=0,s=t.length;a<s;++a)O(t,String(a))?i.push(h(e,t,r,n,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(h(e,t,r,n,o,!0))})),i}(e,r,n,s,a):a.map((function(t){return h(e,r,n,s,t,E)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,w,T)):T[0]+w+T[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,r,n,o,i){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),O(n,o)||(a="["+o+"]"),s||(e.seen.indexOf(c.value)<0?(s=v(r)?l(e,c.value,null):l(e,c.value,r-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),y(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function d(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function v(e){return null===e}function g(e){return"number"==typeof e}function m(e){return"string"==typeof e}function y(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===E(e)}function w(e){return"object"==typeof e&&null!==e}function _(e){return w(e)&&"[object Date]"===E(e)}function k(e){return w(e)&&("[object Error]"===E(e)||e instanceof Error)}function I(e){return"function"==typeof e}function E(e){return Object.prototype.toString.call(e)}function T(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(y(i)&&(i=e.env.NODE_DEBUG||""),r=r.toUpperCase(),!a[r])if(new RegExp("\\b"+r+"\\b","i").test(i)){var n=e.pid;a[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else a[r]=function(){};return a[r]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=p,t.isNull=v,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=m,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=b,t.isObject=w,t.isDate=_,t.isError=k,t.isFunction=I,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(111);var x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var e=new Date,t=[T(e.getHours()),T(e.getMinutes()),T(e.getSeconds())].join(":");return[e.getDate(),x[e.getMonth()],t].join(" ")}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",S(),t.format.apply(t,arguments))},t.inherits=r(112),t._extend=function(e,t){if(!t||!w(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var C="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function R(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(C&&e[C]){var t;if("function"!=typeof(t=e[C]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),C&&Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=C,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};t.apply(this,r).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(R,t,a)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(44))},,,function(e,t){var r=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=r)},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t,r){var n=r(51),o=r(92),i=r(93),a=Object.defineProperty;t.f=r(36)?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(52);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports={}},function(e,t,r){var n=r(95),o=r(68);e.exports=function(e){return n(o(e))}},function(e,t,r){var n=r(24),o=r(27),i=r(37),a=r(49)("src"),s=Function.toString,c=(""+s).split("toString");r(48).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,r,s){var u="function"==typeof r;u&&(i(r,"name")||o(r,"name",t)),e[t]!==r&&(u&&(i(r,a)||o(r,a,e[t]?""+e[t]:c.join(String(t)))),e===n?e[t]=r:s?e[t]?e[t]=r:o(e,t,r):(delete e[t],o(e,t,r)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,r){var n=r(63)("keys"),o=r(49);e.exports=function(e){return n[e]||(n[e]=o(e))}},function(e,t,r){"use strict";function n(e,t,r,n){var o,i=!1,a=0;function s(){o&&clearTimeout(o)}function c(){var c=this,u=Date.now()-a,l=arguments;function f(){a=Date.now(),r.apply(c,l)}function h(){o=void 0}i||(n&&!o&&f(),s(),void 0===n&&u>e?f():!0!==t&&(o=setTimeout(n?h:f,void 0===n?e-u:e)))}return"boolean"!=typeof t&&(n=r,r=t,t=void 0),c.cancel=function(){s(),i=!0},c}function o(e,t,r){return void 0===r?n(e,t,!1):n(e,r,!1!==t)}r.r(t),r.d(t,"throttle",(function(){return n})),r.d(t,"debounce",(function(){return o}))},,,,,,function(e,t,r){var n=r(48),o=r(24),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(64)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=!1},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){var n=r(52),o=r(24).document,i=n(o)&&n(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(104),o=r(71);e.exports=Object.keys||function(e){return n(e,o)}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(50).f,o=r(37),i=r(32)("toStringTag");e.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},,,,,,,,,,function(e,t,r){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(120),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(25))},,,,,,,function(e,t,r){"use strict";var n=r(91),o=r(94),i=r(53),a=r(54);e.exports=r(97)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])}),"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},function(e,t,r){var n=r(32)("unscopables"),o=Array.prototype;null==o[n]&&r(27)(o,n,{}),e.exports=function(e){o[n][e]=!0}},function(e,t,r){e.exports=!r(36)&&!r(65)((function(){return 7!=Object.defineProperty(r(66)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){var n=r(52);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){var n=r(96);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){"use strict";var n=r(64),o=r(98),i=r(55),a=r(27),s=r(53),c=r(101),u=r(72),l=r(109),f=r(32)("iterator"),h=!([].keys&&"next"in[].keys()),d=function(){return this};e.exports=function(e,t,r,p,v,g,m){c(r,t,p);var y,b,w,_=function(e){if(!h&&e in T)return T[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},k=t+" Iterator",I="values"==v,E=!1,T=e.prototype,x=T[f]||T["@@iterator"]||v&&T[v],S=x||_(v),O=v?I?_("entries"):S:void 0,C="Array"==t&&T.entries||x;if(C&&(w=l(C.call(new e)))!==Object.prototype&&w.next&&(u(w,k,!0),n||"function"==typeof w[f]||a(w,f,d)),I&&x&&"values"!==x.name&&(E=!0,S=function(){return x.call(this)}),n&&!m||!h&&!E&&T[f]||a(T,f,S),s[t]=S,s[k]=d,v)if(y={values:I?S:_("values"),keys:g?S:_("keys"),entries:O},m)for(b in y)b in T||i(T,b,y[b]);else o(o.P+o.F*(h||E),t,y);return y}},function(e,t,r){var n=r(24),o=r(48),i=r(27),a=r(55),s=r(99),c=function(e,t,r){var u,l,f,h,d=e&c.F,p=e&c.G,v=e&c.S,g=e&c.P,m=e&c.B,y=p?n:v?n[t]||(n[t]={}):(n[t]||{}).prototype,b=p?o:o[t]||(o[t]={}),w=b.prototype||(b.prototype={});for(u in p&&(r=t),r)f=((l=!d&&y&&void 0!==y[u])?y:r)[u],h=m&&l?s(f,n):g&&"function"==typeof f?s(Function.call,f):f,y&&a(y,u,f,e&c.U),b[u]!=f&&i(b,u,h),g&&w[u]!=f&&(w[u]=f)};n.core=o,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,r){var n=r(100);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){"use strict";var n=r(102),o=r(67),i=r(72),a={};r(27)(a,r(32)("iterator"),(function(){return this})),e.exports=function(e,t,r){e.prototype=n(a,{next:o(1,r)}),i(e,t+" Iterator")}},function(e,t,r){var n=r(51),o=r(103),i=r(71),a=r(56)("IE_PROTO"),s=function(){},c=function(){var e,t=r(66)("iframe"),n=i.length;for(t.style.display="none",r(108).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;n--;)delete c.prototype[i[n]];return c()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=c(),void 0===t?r:o(r,t)}},function(e,t,r){var n=r(50),o=r(51),i=r(69);e.exports=r(36)?Object.defineProperties:function(e,t){o(e);for(var r,a=i(t),s=a.length,c=0;s>c;)n.f(e,r=a[c++],t[r]);return e}},function(e,t,r){var n=r(37),o=r(54),i=r(105)(!1),a=r(56)("IE_PROTO");e.exports=function(e,t){var r,s=o(e),c=0,u=[];for(r in s)r!=a&&n(s,r)&&u.push(r);for(;t.length>c;)n(s,r=t[c++])&&(~i(u,r)||u.push(r));return u}},function(e,t,r){var n=r(54),o=r(106),i=r(107);e.exports=function(e){return function(t,r,a){var s,c=n(t),u=o(c.length),l=i(a,u);if(e&&r!=r){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}}},function(e,t,r){var n=r(70),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},function(e,t,r){var n=r(70),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=n(e))<0?o(e+t,0):i(e,t)}},function(e,t,r){var n=r(24).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(37),o=r(110),i=r(56)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),n(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,r){var n=r(68);e.exports=function(e){return Object(n(e))}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";(function(t){var r=function(e){e=e||{},this.Promise=e.Promise||Promise,this.queues=Object.create(null),this.domains=Object.create(null),this.domainReentrant=e.domainReentrant||!1,this.timeout=e.timeout||r.DEFAULT_TIMEOUT,this.maxPending=e.maxPending||r.DEFAULT_MAX_PENDING};r.DEFAULT_TIMEOUT=0,r.DEFAULT_MAX_PENDING=1e3,r.prototype.acquire=function(e,r,n,o){if(Array.isArray(e))return this._acquireBatch(e,r,n,o);if("function"!=typeof r)throw new Error("You must pass a function to execute");var i=null,a=null,s=null;"function"!=typeof n&&(o=n,n=null,s=new this.Promise((function(e,t){i=e,a=t}))),o=o||{};var c=!1,u=null,l=this,f=function(t,r,o){t&&(0===l.queues[e].length&&delete l.queues[e],delete l.domains[e]),c||(s?r?a(r):i(o):"function"==typeof n&&n(r,o),c=!0),t&&l.queues[e]&&l.queues[e].length>0&&l.queues[e].shift()()},h=function(n){if(c)return f(n);if(u&&(clearTimeout(u),u=null),n&&(l.domains[e]=t.domain),1===r.length){var o=!1;r((function(e,t){o||(o=!0,f(n,e,t))}))}else l._promiseTry((function(){return r()})).then((function(e){f(n,void 0,e)}),(function(e){f(n,e)}))};if(t.domain&&(h=t.domain.bind(h)),l.queues[e])if(l.domainReentrant&&t.domain&&t.domain===l.domains[e])h(!1);else if(l.queues[e].length>=l.maxPending)f(!1,new Error("Too much pending tasks"));else{var d=function(){h(!0)};o.skipQueue?l.queues[e].unshift(d):l.queues[e].push(d);var p=o.timeout||l.timeout;p&&(u=setTimeout((function(){u=null,f(!1,new Error("async-lock timed out"))}),p))}else l.queues[e]=[],h(!0);return s||void 0},r.prototype._acquireBatch=function(e,t,r,n){"function"!=typeof r&&(n=r,r=null);var o=this,i=t;if(e.reverse().forEach((function(e){i=function(e,t){return function(r){o.acquire(e,t,r,n)}}(e,i)})),"function"!=typeof r)return new this.Promise((function(e,t){1===i.length?i((function(r,n){r?t(r):e(n)})):e(i())}));i(r)},r.prototype.isBusy=function(e){return e?!!this.queues[e]:Object.keys(this.queues).length>0},r.prototype._promiseTry=function(e){try{return this.Promise.resolve(e())}catch(e){return this.Promise.reject(e)}},e.exports=r}).call(this,r(44))},function(e,t,r){(function(e,n){var o;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(i){t&&t.nodeType,e&&e.nodeType;var a="object"==typeof n&&n;a.global!==a&&a.window!==a&&a.self;var s,c=2147483647,u=/^xn--/,l=/[^\x20-\x7E]/,f=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,p=String.fromCharCode;function v(e){throw new RangeError(h[e])}function g(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function m(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+g((e=e.replace(f,".")).split("."),t).join(".")}function y(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function b(e){return g(e,(function(e){var t="";return e>65535&&(t+=p((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=p(e)})).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function _(e,t,r){var n=0;for(e=r?d(e/700):e>>1,e+=d(e/t);e>455;n+=36)e=d(e/35);return d(n+36*e/(e+38))}function k(e){var t,r,n,o,i,a,s,u,l,f,h,p=[],g=e.length,m=0,y=128,w=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&v("not-basic"),p.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<g;){for(i=m,a=1,s=36;o>=g&&v("invalid-input"),((u=(h=e.charCodeAt(o++))-48<10?h-22:h-65<26?h-65:h-97<26?h-97:36)>=36||u>d((c-m)/a))&&v("overflow"),m+=u*a,!(u<(l=s<=w?1:s>=w+26?26:s-w));s+=36)a>d(c/(f=36-l))&&v("overflow"),a*=f;w=_(m-i,t=p.length+1,0==i),d(m/t)>c-y&&v("overflow"),y+=d(m/t),m%=t,p.splice(m++,0,y)}return b(p)}function I(e){var t,r,n,o,i,a,s,u,l,f,h,g,m,b,k,I=[];for(g=(e=y(e)).length,t=128,r=0,i=72,a=0;a<g;++a)(h=e[a])<128&&I.push(p(h));for(n=o=I.length,o&&I.push("-");n<g;){for(s=c,a=0;a<g;++a)(h=e[a])>=t&&h<s&&(s=h);for(s-t>d((c-r)/(m=n+1))&&v("overflow"),r+=(s-t)*m,t=s,a=0;a<g;++a)if((h=e[a])<t&&++r>c&&v("overflow"),h==t){for(u=r,l=36;!(u<(f=l<=i?1:l>=i+26?26:l-i));l+=36)k=u-f,b=36-f,I.push(p(w(f+k%b,0))),u=d(k/b);I.push(p(w(u,0))),i=_(r,m,n==o),r=0,++n}++r,++t}return I.join("")}s={version:"1.4.1",ucs2:{decode:y,encode:b},decode:k,encode:I,toASCII:function(e){return m(e,(function(e){return l.test(e)?"xn--"+I(e):e}))},toUnicode:function(e){return m(e,(function(e){return u.test(e)?k(e.slice(4).toLowerCase()):e}))}},void 0===(o=function(){return s}.call(t,r,t,e))||(e.exports=o)}()}).call(this,r(73)(e),r(25))},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){"use strict";t.decode=t.parse=r(117),t.encode=t.stringify=r(118)},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,i){t=t||"&",r=r||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var l=0;l<u;++l){var f,h,d,p,v=e[l].replace(s,"%20"),g=v.indexOf(r);g>=0?(f=v.substr(0,g),h=v.substr(g+1)):(f=v,h=""),d=decodeURIComponent(f),p=decodeURIComponent(h),n(a,d)?o(a[d])?a[d].push(p):a[d]=[a[d],p]:a[d]=p}return a};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,s){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?i(a(e),(function(a){var s=encodeURIComponent(n(a))+r;return o(e[a])?i(e[a],(function(e){return s+encodeURIComponent(n(e))})).join(t):s+encodeURIComponent(n(e[a]))})).join(t):s?encodeURIComponent(n(s))+r+encodeURIComponent(n(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var a=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,o="~";function i(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,r,n,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new a(r,n||e,i),c=o?o+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=o?o+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,a=new Array(i);n<i;n++)a[n]=r[n].fn;return a},u.prototype.listenerCount=function(e){var t=o?o+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,n,i,a){var s=o?o+e:e;if(!this._events[s])return!1;var c,u,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,i),!0;case 6:return l.fn.call(l.context,t,r,n,i,a),!0}for(u=1,c=new Array(f-1);u<f;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,d=l.length;for(u=0;u<d;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,n);break;default:if(!c)for(h=1,c=new Array(f-1);h<f;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,n){var i=o?o+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||n&&!a.once||r&&a.context!==r||c(this,i);else{for(var s=0,u=[],l=a.length;s<l;s++)(a[s].fn!==t||n&&!a[s].once||r&&a[s].context!==r)&&u.push(a[s]);u.length?this._events[i]=1===u.length?u[0]:u:c(this,i)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&c(this,t)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=o,u.EventEmitter=u,e.exports=u},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var n,o,i,a,s,c=1,u={},l=!1,f=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},n=function(e){i.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(o=f.documentElement,n=function(e){var t=f.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):n=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(t){e.postMessage(a+t,"*")}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var o={callback:e,args:t};return u[c]=o,n(c),c++},h.clearImmediate=d}function d(e){delete u[e]}function p(e){if(l)setTimeout(p,0,e);else{var t=u[e];if(t){l=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{d(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(25),r(44))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){(function(t){e.exports=function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[a]={exports:{}};t[a][0].call(u.exports,(function(e){var r=t[a][1][e];return o(r||e)}),u,u.exports,e,t,r,n)}return r[a].exports}for(var i=!1,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,r,n){(function(e){"use strict";var t,n,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var i=0,a=new o(l),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),t=function(){s.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){l(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(l,0)};else{var c=new e.MessageChannel;c.port1.onmessage=l,t=function(){c.port2.postMessage(0)}}var u=[];function l(){var e,t;n=!0;for(var r=u.length;r;){for(t=u,u=[],e=-1;++e<r;)t[e]();r=u.length}n=!1}r.exports=function(e){1!==u.push(e)||n||t()}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";var n=e(1);function o(){}var i={},a=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==o&&d(this,e)}function l(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function f(e,t,r){n((function(){var n;try{n=t(r)}catch(t){return i.reject(e,t)}n===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,n)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function d(e,t){var r=!1;function n(t){r||(r=!0,i.reject(e,t))}function o(t){r||(r=!0,i.resolve(e,t))}var a=p((function(){t(o,n)}));"error"===a.status&&n(a.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}t.exports=u,u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var r=new this.constructor(o);return this.state!==c?f(r,this.state===s?e:t,this.outcome):this.queue.push(new l(r,e,t)),r},l.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){i.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},i.resolve=function(e,t){var r=p(h,t);if("error"===r.status)return i.reject(e,r.value);var n=r.value;if(n)d(e,n);else{e.state=s,e.outcome=t;for(var o=-1,a=e.queue.length;++o<a;)e.queue[o].callFulfilled(t)}return e},i.reject=function(e,t){e.state=a,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:i.resolve(new this(o),e)},u.reject=function(e){var t=new this(o);return i.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var a=new Array(r),s=0,c=-1,u=new this(o);++c<r;)l(e[c],c);return u;function l(e,o){t.resolve(e).then((function(e){a[o]=e,++s!==r||n||(n=!0,i.resolve(u,a))}),(function(e){n||(n=!0,i.reject(u,e))}))}},u.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var a,s=-1,c=new this(o);++s<r;)a=e[s],t.resolve(a).then((function(e){n||(n=!0,i.resolve(c,e))}),(function(e){n||(n=!0,i.reject(c,e))}));return c}},{1:1}],3:[function(e,r,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function i(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var a=Promise;function s(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function c(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function u(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function l(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var f=void 0,h={},d=Object.prototype.toString;function p(e){return"boolean"==typeof f?a.resolve(f):function(e){return new a((function(t){var r=e.transaction("local-forage-detect-blob-support","readwrite"),n=i([""]);r.objectStore("local-forage-detect-blob-support").put(n,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return f=e}))}function v(e){var t=h[e.name],r={};r.promise=new a((function(e,t){r.resolve=e,r.reject=t})),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then((function(){return r.promise})):t.dbReady=r.promise}function g(e){var t=h[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function m(e,t){var r=h[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function y(e,t){return new a((function(r,n){if(h[e.name]=h[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return r(e.db);v(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var a=o.open.apply(o,i);t&&(a.onupgradeneeded=function(t){var r=a.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore("local-forage-detect-blob-support")}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),a.onerror=function(e){e.preventDefault(),n(a.error)},a.onsuccess=function(){r(a.result),g(e)}}))}function b(e){return y(e,!1)}function w(e){return y(e,!0)}function _(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,o=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||r){if(r){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function k(e){return i([function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;o<t;o++)n[o]=e.charCodeAt(o);return r}(atob(e.data))],{type:e.type})}function I(e){return e&&e.__local_forage_encoded_blob}function E(e){var t=this,r=t._initReady().then((function(){var e=h[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return c(r,e,e),r}function T(e,t,r,n){void 0===n&&(n=1);try{var o=e.db.transaction(e.storeName,t);r(null,o)}catch(o){if(n>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return a.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),w(e)})).then((function(){return function(e){v(e);for(var t=h[e.name],r=t.forages,n=0;n<r.length;n++){var o=r[n];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,b(e).then((function(t){return e.db=t,_(e)?w(e):t})).then((function(n){e.db=t.db=n;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=n})).catch((function(t){throw m(e,t),t}))}(e).then((function(){T(e,t,r,n-1)}))})).catch(r);r(o)}}var x={_driver:"asyncStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]=e[n];var o=h[r.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},h[r.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=E);var i=[];function s(){return a.resolve()}for(var c=0;c<o.forages.length;c++){var u=o.forages[c];u!==t&&i.push(u._initReady().catch(s))}var l=o.forages.slice(0);return a.all(i).then((function(){return r.db=o.db,b(r)})).then((function(e){return r.db=e,_(r,t._defaultConfig.version)?w(r):e})).then((function(e){r.db=o.db=e,t._dbInfo=r;for(var n=0;n<l.length;n++){var i=l[n];i!==t&&(i._dbInfo.db=r.db,i._dbInfo.version=r.version)}}))},_support:function(){try{if(!o)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=new a((function(t,n){r.ready().then((function(){T(r._dbInfo,"readonly",(function(o,i){if(o)return n(o);try{var a=i.objectStore(r._dbInfo.storeName).openCursor(),s=1;a.onsuccess=function(){var r=a.result;if(r){var n=r.value;I(n)&&(n=k(n));var o=e(n,r.key,s++);void 0!==o?t(o):r.continue()}else t()},a.onerror=function(){n(a.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},getItem:function(e,t){var r=this;e=u(e);var n=new a((function(t,n){r.ready().then((function(){T(r._dbInfo,"readonly",(function(o,i){if(o)return n(o);try{var a=i.objectStore(r._dbInfo.storeName).get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),I(e)&&(e=k(e)),t(e)},a.onerror=function(){n(a.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},setItem:function(e,t,r){var n=this;e=u(e);var o=new a((function(r,o){var i;n.ready().then((function(){return i=n._dbInfo,"[object Blob]"===d.call(t)?p(i.db).then((function(e){return e?t:(r=t,new a((function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){var n=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:n,type:r.type})},n.readAsBinaryString(r)})));var r})):t})).then((function(t){T(n._dbInfo,"readwrite",(function(i,a){if(i)return o(i);try{var s=a.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var c=s.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),r(t)},a.onabort=a.onerror=function(){var e=c.error?c.error:c.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return s(o,r),o},removeItem:function(e,t){var r=this;e=u(e);var n=new a((function(t,n){r.ready().then((function(){T(r._dbInfo,"readwrite",(function(o,i){if(o)return n(o);try{var a=i.objectStore(r._dbInfo.storeName).delete(e);i.oncomplete=function(){t()},i.onerror=function(){n(a.error)},i.onabort=function(){var e=a.error?a.error:a.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},clear:function(e){var t=this,r=new a((function(e,r){t.ready().then((function(){T(t._dbInfo,"readwrite",(function(n,o){if(n)return r(n);try{var i=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=i.error?i.error:i.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return s(r,e),r},length:function(e){var t=this,r=new a((function(e,r){t.ready().then((function(){T(t._dbInfo,"readonly",(function(n,o){if(n)return r(n);try{var i=o.objectStore(t._dbInfo.storeName).count();i.onsuccess=function(){e(i.result)},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,e),r},key:function(e,t){var r=this,n=new a((function(t,n){e<0?t(null):r.ready().then((function(){T(r._dbInfo,"readonly",(function(o,i){if(o)return n(o);try{var a=i.objectStore(r._dbInfo.storeName),s=!1,c=a.openCursor();c.onsuccess=function(){var r=c.result;r?0===e||s?t(r.key):(s=!0,r.advance(e)):t(null)},c.onerror=function(){n(c.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},keys:function(e){var t=this,r=new a((function(e,r){t.ready().then((function(){T(t._dbInfo,"readonly",(function(n,o){if(n)return r(n);try{var i=o.objectStore(t._dbInfo.storeName).openCursor(),a=[];i.onsuccess=function(){var t=i.result;t?(a.push(t.key),t.continue()):e(a)},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,e),r},dropInstance:function(e,t){t=l.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,i=this;if(e.name){var c=e.name===r.name&&i._dbInfo.db,u=c?a.resolve(i._dbInfo.db):b(e).then((function(t){var r=h[e.name],n=r.forages;r.db=t;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=t;return t}));n=e.storeName?u.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var r=t.version+1;v(e);var n=h[e.name],i=n.forages;t.close();for(var s=0;s<i.length;s++){var c=i[s];c._dbInfo.db=null,c._dbInfo.version=r}return new a((function(t,n){var i=o.open(e.name,r);i.onerror=function(e){i.result.close(),n(e)},i.onupgradeneeded=function(){i.result.deleteObjectStore(e.storeName)},i.onsuccess=function(){var e=i.result;e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<i.length;t++){var r=i[t];r._dbInfo.db=e,g(r._dbInfo)}})).catch((function(t){throw(m(e,t)||a.resolve()).catch((function(){})),t}))}})):u.then((function(t){v(e);var r=h[e.name],n=r.forages;t.close();for(var i=0;i<n.length;i++)n[i]._dbInfo.db=null;return new a((function(t,r){var n=o.deleteDatabase(e.name);n.onerror=n.onblocked=function(e){var t=n.result;t&&t.close(),r(e)},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<n.length;t++)g(n[t]._dbInfo)})).catch((function(t){throw(m(e,t)||a.resolve()).catch((function(){})),t}))}))}else n=a.reject("Invalid arguments");return s(n,t),n}},S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O=/^~~local_forage_type~([^~]+)~/,C="__lfsc__:".length,R=C+"arbf".length,A=Object.prototype.toString;function F(e){var t,r,n,o,i,a=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),l=new Uint8Array(u);for(t=0;t<s;t+=4)r=S.indexOf(e[t]),n=S.indexOf(e[t+1]),o=S.indexOf(e[t+2]),i=S.indexOf(e[t+3]),l[c++]=r<<2|n>>4,l[c++]=(15&n)<<4|o>>2,l[c++]=(3&o)<<6|63&i;return u}function j(e){var t,r=new Uint8Array(e),n="";for(t=0;t<r.length;t+=3)n+=S[r[t]>>2],n+=S[(3&r[t])<<4|r[t+1]>>4],n+=S[(15&r[t+1])<<2|r[t+2]>>6],n+=S[63&r[t+2]];return r.length%3==2?n=n.substring(0,n.length-1)+"=":r.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var L={serialize:function(e,t){var r="";if(e&&(r=A.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===A.call(e.buffer))){var n,o="__lfsc__:";e instanceof ArrayBuffer?(n=e,o+="arbf"):(n=e.buffer,"[object Int8Array]"===r?o+="si08":"[object Uint8Array]"===r?o+="ui08":"[object Uint8ClampedArray]"===r?o+="uic8":"[object Int16Array]"===r?o+="si16":"[object Uint16Array]"===r?o+="ur16":"[object Int32Array]"===r?o+="si32":"[object Uint32Array]"===r?o+="ui32":"[object Float32Array]"===r?o+="fl32":"[object Float64Array]"===r?o+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(o+j(n))}else if("[object Blob]"===r){var i=new FileReader;i.onload=function(){var r="~~local_forage_type~"+e.type+"~"+j(this.result);t("__lfsc__:blob"+r)},i.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(r){console.error("Couldn't convert value into a JSON string: ",e),t(null,r)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,C))return JSON.parse(e);var t,r=e.substring(R),n=e.substring(C,R);if("blob"===n&&O.test(r)){var o=r.match(O);t=o[1],r=r.substring(o[0].length)}var a=F(r);switch(n){case"arbf":return a;case"blob":return i([a],{type:t});case"si08":return new Int8Array(a);case"ui08":return new Uint8Array(a);case"uic8":return new Uint8ClampedArray(a);case"si16":return new Int16Array(a);case"ur16":return new Uint16Array(a);case"si32":return new Int32Array(a);case"ui32":return new Uint32Array(a);case"fl32":return new Float32Array(a);case"fl64":return new Float64Array(a);default:throw new Error("Unkown type: "+n)}},stringToBuffer:F,bufferToString:j};function B(e,t,r,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function D(e,t,r,n,o,i){e.executeSql(r,n,o,(function(e,a){a.code===a.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,s){s.rows.length?i(e,a):B(e,t,(function(){e.executeSql(r,n,o,i)}),i)}),i):i(e,a)}),i)}function P(e,t,r,n){var o=this;e=u(e);var i=new a((function(i,a){o.ready().then((function(){void 0===t&&(t=null);var s=t,c=o._dbInfo;c.serializer.serialize(t,(function(t,u){u?a(u):c.db.transaction((function(r){D(r,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){i(s)}),(function(e,t){a(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void i(P.apply(o,[e,s,r,n-1]));a(t)}}))}))})).catch(a)}));return s(i,r),i}function M(e){return new a((function(t,r){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(r,n){for(var o=[],i=0;i<n.rows.length;i++)o.push(n.rows.item(i).name);t({db:e,storeNames:o})}),(function(e,t){r(t)}))}),(function(e){r(e)}))}))}var N={_driver:"webSQLStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]="string"!=typeof e[n]?e[n].toString():e[n];var o=new a((function(e,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(e){return n(e)}r.db.transaction((function(o){B(o,r,(function(){t._dbInfo=r,e()}),(function(e,t){n(t)}))}),n)}));return r.serializer=L,o},_support:"function"==typeof openDatabase,iterate:function(e,t){var r=this,n=new a((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){D(r,o,"SELECT * FROM "+o.storeName,[],(function(r,n){for(var i=n.rows,a=i.length,s=0;s<a;s++){var c=i.item(s),u=c.value;if(u&&(u=o.serializer.deserialize(u)),void 0!==(u=e(u,c.key,s+1)))return void t(u)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},getItem:function(e,t){var r=this;e=u(e);var n=new a((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){D(r,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=o.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},setItem:function(e,t,r){return P.apply(this,[e,t,r,1])},removeItem:function(e,t){var r=this;e=u(e);var n=new a((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){D(r,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},clear:function(e){var t=this,r=new a((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){D(t,n,"DELETE FROM "+n.storeName,[],(function(){e()}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,e),r},length:function(e){var t=this,r=new a((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){D(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(t,r){var n=r.rows.item(0).c;e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,e),r},key:function(e,t){var r=this,n=new a((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){D(r,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,r){var n=r.rows.length?r.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},keys:function(e){var t=this,r=new a((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){D(t,n,"SELECT key FROM "+n.storeName,[],(function(t,r){for(var n=[],o=0;o<r.rows.length;o++)n.push(r.rows.item(o).key);e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,e),r},dropInstance:function(e,t){t=l.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,o=this;return s(n=e.name?new a((function(t){var n;n=e.name===r.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(M(n))})).then((function(e){return new a((function(t,r){e.db.transaction((function(n){function o(e){return new a((function(t,r){n.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){r(t)}))}))}for(var i=[],s=0,c=e.storeNames.length;s<c;s++)i.push(o(e.storeNames[s]));a.all(i).then((function(){t()})).catch((function(e){r(e)}))}),(function(e){r(e)}))}))})):a.reject("Invalid arguments"),t),n}};function U(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function z(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var q={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var r in e)t[r]=e[r];return t.keyPrefix=U(e,this._defaultConfig),z()?(this._dbInfo=t,t.serializer=L,a.resolve()):a.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=r.ready().then((function(){for(var t=r._dbInfo,n=t.keyPrefix,o=n.length,i=localStorage.length,a=1,s=0;s<i;s++){var c=localStorage.key(s);if(0===c.indexOf(n)){var u=localStorage.getItem(c);if(u&&(u=t.serializer.deserialize(u)),void 0!==(u=e(u,c.substring(o),a++)))return u}}}));return s(n,t),n},getItem:function(e,t){var r=this;e=u(e);var n=r.ready().then((function(){var t=r._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return s(n,t),n},setItem:function(e,t,r){var n=this;e=u(e);var o=n.ready().then((function(){void 0===t&&(t=null);var r=t;return new a((function(o,i){var a=n._dbInfo;a.serializer.serialize(t,(function(t,n){if(n)i(n);else try{localStorage.setItem(a.keyPrefix+e,t),o(r)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||i(e),i(e)}}))}))}));return s(o,r),o},removeItem:function(e,t){var r=this;e=u(e);var n=r.ready().then((function(){var t=r._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return s(n,t),n},clear:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return s(r,e),r},length:function(e){var t=this.keys().then((function(e){return e.length}));return s(t,e),t},key:function(e,t){var r=this,n=r.ready().then((function(){var t,n=r._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return s(n,t),n},keys:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo,r=localStorage.length,n=[],o=0;o<r;o++){var i=localStorage.key(o);0===i.indexOf(e.keyPrefix)&&n.push(i.substring(e.keyPrefix.length))}return n}));return s(r,e),r},dropInstance:function(e,t){if(t=l.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var n,o=this;return s(n=e.name?new a((function(t){e.storeName?t(U(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}})):a.reject("Invalid arguments"),t),n}},$=function(e,t){for(var r,n,o=e.length,i=0;i<o;){if((r=e[i])===(n=t)||"number"==typeof r&&"number"==typeof n&&isNaN(r)&&isNaN(n))return!0;i++}return!1},W=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},V={},H={},G={INDEXEDDB:x,WEBSQL:N,LOCALSTORAGE:q},J=[G.INDEXEDDB._driver,G.WEBSQL._driver,G.LOCALSTORAGE._driver],K=["dropInstance"],Z=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(K),Q={description:"",driver:J.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function X(e,t){e[t]=function(){var r=arguments;return e.ready().then((function(){return e[t].apply(e,r)}))}}function Y(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(W(t[r])?arguments[0][r]=t[r].slice():arguments[0][r]=t[r])}return arguments[0]}var ee=new(function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),G)if(G.hasOwnProperty(r)){var n=G[r],o=n._driver;this[r]=o,V[o]||this.defineDriver(n)}this._defaultConfig=Y({},Q),this._config=Y({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,r){var n=new a((function(t,r){try{var n=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void r(o);for(var i=Z.concat("_initStorage"),c=0,u=i.length;c<u;c++){var l=i[c];if((!$(K,l)||e[l])&&"function"!=typeof e[l])return void r(o)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),r=a.reject(t);return s(r,arguments[arguments.length-1]),r}},r=0,n=K.length;r<n;r++){var o=K[r];e[o]||(e[o]=t(o))}}();var f=function(r){V[n]&&console.info("Redefining LocalForage driver: "+n),V[n]=e,H[n]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(f,r):f(!!e._support):f(!0)}catch(e){r(e)}}));return c(n,t,r),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var n=V[e]?a.resolve(V[e]):a.reject(new Error("Driver not found."));return c(n,t,r),n},e.prototype.getSerializer=function(e){var t=a.resolve(L);return c(t,e),t},e.prototype.ready=function(e){var t=this,r=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return c(r,e,e),r},e.prototype.setDriver=function(e,t,r){var n=this;W(e)||(e=[e]);var o=this._getSupportedDrivers(e);function i(){n._config.driver=n.driver()}function s(e){return n._extend(e),i(),n._ready=n._initStorage(n._config),n._ready}var u=null!==this._driverSet?this._driverSet.catch((function(){return a.resolve()})):a.resolve();return this._driverSet=u.then((function(){var e=o[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((function(e){n._driver=e._driver,i(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(e){return function(){var t=0;return function r(){for(;t<e.length;){var o=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(o).then(s).catch(r)}i();var c=new Error("No available storage method found.");return n._driverSet=a.reject(c),n._driverSet}()}}(o)}))})).catch((function(){i();var e=new Error("No available storage method found.");return n._driverSet=a.reject(e),n._driverSet})),c(this._driverSet,t,r),this._driverSet},e.prototype.supports=function(e){return!!H[e]},e.prototype._extend=function(e){Y(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var o=e[r];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=Z.length;e<t;e++)X(this,Z[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=ee},{3:3}]},{},[4])(4)}).call(this,r(25))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.r(t);r(16);var n=r(0),o=r(7),i=r(15),a=r(14),s=r(42),c=r(20),u=r(152),l=r(40),f=r.n(l);const h=r(31),d=Symbol("error"),p=Symbol("syncing"),v=Symbol("allgood");class g{constructor(e){this.ctl=e}async checkSync(){const e=await c.a.getAllAccounts();for(let t of e){const e=(await o.a.get(t)).getData();Date.now()>1e3*(e.syncInterval||15)*60+e.lastSync&&this.ctl.scheduleSync(t)}}}window.controller=new class{constructor(){this.jobs=new h({concurrency:1}),this.waiting={},this.schedule={},this.listeners=[],this.alarms=new g(this),n.a.bookmarks.onChanged.addListener((e,t)=>this.onchange(e,t)),n.a.bookmarks.onMoved.addListener((e,t)=>this.onchange(e,t)),n.a.bookmarks.onRemoved.addListener((e,t)=>this.onchange(e,t)),n.a.bookmarks.onCreated.addListener((e,t)=>this.onchange(e,t)),n.a.alarms.create("checkSync",{periodInMinutes:1}),n.a.alarms.onAlarm.addListener(e=>{this.alarms[e.name]()}),n.a.storage.local.get("accountsLocked").then(async e=>{this.setEnabled(!e.accountsLocked),this.unlocked=!e.accountsLocked,e.accountsLocked&&(this.key=null)}),n.a.storage.local.get("currentVersion").then(async e=>{if(s.version===e.currentVersion)return;const t=await o.a.getAllAccounts();await Promise.all(t.map(e=>e.init())),await Promise.all(t.map(e=>e.setData({...e.getData()}))),await n.a.storage.local.set({currentVersion:s.version});const r=s.version.split("."),i=e.currentVersion?e.currentVersion.split("."):[];r[0]===i[0]&&r[1]===i[1]||n.a.tabs.create({url:"./options.html#/update",active:!1})}),u.getItem("accounts").then(async e=>{if(e)return c.a.changeEntry("accounts",()=>e)}).then(()=>u.removeItem("accounts")),setInterval(()=>this.updateStatus(),1e4)}setEnabled(e){this.enabled=e}async setKey(e){let t=await o.a.getAllAccounts();this.key=e;let r=await a.a.sha256(e),i=await a.a.encryptAES(e,a.a.iv,r);await n.a.storage.local.set({accountsLocked:i}),t.length&&await Promise.all(t.map(e=>e.setData(e.getData()))),this.key=e,this.unlocked=!0,this.setEnabled(!0)}async unlock(e){let t=await n.a.storage.local.get({accountsLocked:null});if(t.accountsLocked){let r=await a.a.sha256(e);if(await a.a.decryptAES(e,a.a.iv,t.accountsLocked)!==r)throw new Error("The provided key was wrong");this.key=e}this.unlocked=!0,this.setEnabled(!0)}async unsetKey(){if(!this.unlocked)throw new Error("Cannot disable encryption without unlocking first");let e=await o.a.getAllAccounts();this.key=null,await n.a.storage.local.set({accountsLocked:null}),await Promise.all(e.map(e=>e.setData(e.getData())))}async onchange(e,t){if(!this.enabled)return;this.setEnabled(!1);const r=await o.a.getAllAccounts(),n=await Promise.all(r.map(async t=>t.tracksBookmark(e)));let a,s=r.filter((e,t)=>n[t]);try{a=await i.a.getIdPathFromLocalId(e)}catch(e){return void this.setEnabled(!0)}const c=await o.a.getAccountsContainingLocalId(e,a,r);s=f.a.uniqBy(s.concat(c),e=>e.id).filter(e=>!e.getData().syncing).filter(e=>e.getData().enabled),s.forEach(e=>{this.cancelSync(e.id,!0),this.scheduleSync(e.id,!0)}),this.setEnabled(!0)}async scheduleSync(e,t){if(t)return this.schedule[e]&&clearTimeout(this.schedule[e]),void(this.schedule[e]=setTimeout(()=>this.scheduleSync(e),6e4));let r=await o.a.get(e);return r.getData().syncing||!r.getData().enabled||this.waiting[e]?void 0:(this.waiting[e]=!0,this.jobs.add(()=>this.syncAccount(e)))}async cancelSync(e,t){let r=await o.a.get(e);t||await r.setData({...r.getData(),enabled:!1}),await r.cancelSync()}async syncAccount(e){if(this.waiting[e]=!1,!this.enabled)return;let t=await o.a.get(e);if(!t.getData().syncing&&t.getData().enabled){setTimeout(()=>this.updateStatus(),500);try{await t.sync()}catch(e){console.error(e)}this.updateStatus()}}async updateStatus(){await this.updateBadge(),this.listeners.forEach(e=>e())}onStatusChange(e){this.listeners.push(e);let t=!1;return()=>{t||(this.listeners.splice(this.listeners.indexOf(e),1),t=!0)}}async updateBadge(){if(!this.unlocked)return this.setStatusBadge(d);const e=(await o.a.getAllAccounts()).reduce((e,t)=>{const r=t.getData();return e===d||r.error&&!r.syncing?d:e===p||r.syncing?p:v},v);this.setStatusBadge(e)}async setStatusBadge(e){const t={[v]:{text:""},[p]:{text:"<->",color:"#0088dd"},[d]:{text:"!",color:"#dd4d00"}};await n.a.browserAction.setBadgeText({text:t[e].text}),t[e].color&&await n.a.browserAction.setBadgeBackgroundColor({color:t[e].color})}async onLoad(){const e=await o.a.getAllAccounts();await Promise.all(e.map(async e=>{e.getData().syncing&&await e.setData({...e.getData(),syncing:!1,error:n.a.i18n.getMessage("Error027")})}))}},window.syncAccount=e=>window.controller.syncAccount(e);window.addEventListener("load",()=>{window.controller.onLoad()})}]);